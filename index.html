<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ù…Ù„ÙŠØ© Ù„Ù„ØªØ±Ø¨Ø© â€” Soil Laboratory Testing Platform | ASTM D6913, D1557, D4318 & D2487</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
        * { font-family: 'Cairo', sans-serif; }
        .tab-active { background: linear-gradient(135deg, #3b82f6, #1d4ed8); color: white; }
        .tab-inactive { background: #e5e7eb; color: #6b7280; }
        .tab-clickable { cursor: pointer; transition: all 0.2s; }
        .tab-clickable:hover { background: linear-gradient(135deg, #60a5fa, #3b82f6); color: white; }
        .input-field { 
            transition: all 0.2s;
            text-align: center;
        }
        .input-field:focus { 
            border-color: #3b82f6; 
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        .input-error { border-color: #ef4444 !important; background-color: #fef2f2; }
        .input-warning { border-color: #f59e0b !important; background-color: #fffbeb; }
        .table-header { background: linear-gradient(135deg, #1e3a5f, #2d5a87); }
        .table-header-orange { background: linear-gradient(135deg, #c2410c, #ea580c); }
        .result-positive { color: #059669; font-weight: bold; }
        .result-cell { background-color: #f0fdf4; }
        .chart-container { 
            background: linear-gradient(to bottom, #f8fafc, #e2e8f0);
            border-radius: 12px;
            padding: 20px;
        }
        .glossary-term { 
            background: #dbeafe; 
            padding: 2px 8px; 
            border-radius: 4px; 
            font-family: monospace;
            font-size: 0.9em;
        }
        .section-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e5e7eb;
        }
        .btn-primary {
            background: linear-gradient(135deg, #10b981, #059669);
            transition: all 0.3s;
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }
        .btn-secondary {
            background: linear-gradient(135deg, #6b7280, #4b5563);
            transition: all 0.3s;
        }
        .btn-secondary:hover {
            background: linear-gradient(135deg, #4b5563, #374151);
        }
        .btn-orange {
            background: linear-gradient(135deg, #f97316, #ea580c);
            transition: all 0.3s;
        }
        .btn-orange:hover {
            background: linear-gradient(135deg, #ea580c, #c2410c);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(249, 115, 22, 0.4);
        }
        .validation-msg {
            font-size: 0.85em;
            padding: 8px 12px;
            border-radius: 6px;
            margin-top: 8px;
        }
        .validation-error { background: #fef2f2; color: #dc2626; border: 1px solid #fecaca; }
        .validation-warning { background: #fffbeb; color: #d97706; border: 1px solid #fde68a; }
        .validation-success { background: #f0fdf4; color: #16a34a; border: 1px solid #bbf7d0; }
        .separator-highlight { 
            background: linear-gradient(135deg, #fef3c7, #fde68a) !important; 
            border: 2px solid #f59e0b !important;
        }
        .separator-badge {
            display: inline-block;
            background: #f59e0b;
            color: white;
            font-size: 0.7em;
            padding: 2px 6px;
            border-radius: 4px;
            margin-right: 4px;
        }
        .point-number {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #f97316, #ea580c);
        }
        .result-card {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border: 2px solid #f59e0b;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        .result-card-value {
            font-size: 2rem;
            font-weight: bold;
            color: #c2410c;
        }
        

    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-900 to-blue-700 text-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold">ğŸ”¬ Ù…Ù†ØµØ© Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ù…Ù„ÙŠØ© Ù„ØªØ±Ø¨Ø© ğŸ—ï¸ </h1>
                    <p class="text-blue-200 text-sm">Soil Testing Calculator Platform</p>
                </div>
                <div class="text-left">
                    <p class="text-sm text-blue-200">Ø§Ù„Ø¥ØµØ¯Ø§Ø± 2.0</p>
                    <p class="text-base text-blue-500 mt-1">ØªÙ… ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù†ØµØ©: Ù…. Ù…Ø­Ù…Ø¯ Ø§Ù„Ù‚ØµØ¨ÙŠ</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="bg-white shadow-md">
        <div class="container mx-auto px-4">
            <div class="flex gap-2 py-3 overflow-x-auto">
                <button id="tabD6913" onclick="switchTab('D6913')" class="tab-active tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap">
                    ğŸ“Š ØªØ¯Ø±Ø¬ Ø§Ù„ØªØ±Ø¨Ø© (D6913)
                </button>
                <button id="tabD4318" onclick="switchTab('D4318')" class="tab-inactive tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap">
                    ğŸ‹ï¸ Ø­Ø¯ÙˆØ¯ Ø£ØªØ±Ø¨Ø±Ø¬ (D4318)
                </button>
                <button id="tabSoilClass" onclick="switchTab('SoilClass')" class="tab-inactive tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap">
                    ğŸ—ï¸ ØªØµÙ†ÙŠÙ Ø§Ù„ØªØ±Ø¨Ø© (Classification)
                </button>
                <button id="tabD1557" onclick="switchTab('D1557')" class="tab-inactive tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap">
                    ğŸ”¨ Ø§Ù„Ø¯Ù…Ùƒ Ø§Ù„Ù…Ø¹Ø¯Ù„ (D1557)
                </button>
                <button class="tab-inactive px-4 py-2 rounded-lg whitespace-nowrap cursor-not-allowed opacity-60">
                    ğŸ’§ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ (D2216)
                </button>
                <button class="tab-inactive px-4 py-2 rounded-lg whitespace-nowrap cursor-not-allowed opacity-60">
                    âš–ï¸ Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ù†ÙˆØ¹ÙŠØ© (D854)
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6">
        
        <!-- ============================================= -->
        <!-- D6913 SECTION -->
        <!-- ============================================= -->
        <div id="sectionD6913">
            <!-- Page Title -->
            <div class="section-card p-6 mb-6">
                <div class="flex items-center gap-4">
                    <div class="bg-blue-100 p-4 rounded-full">
                        <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ø­Ø¨ÙŠØ¨ÙŠ â€” Particle-Size Distribution</h2>
                        <p class="text-gray-600">ASTM D6913/D6913M-17 | Method A | Ø§Ù„Ù…Ù†Ø§Ø®Ù„ Ù…Ù† 3 in (75 mm) Ø¥Ù„Ù‰ No.200 (75 Î¼m)</p>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">1</span>
                    Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± â€” Test Settings
                </h3>
                
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">Ø±Ù‚Ù… Ø§Ù„Ø¹ÙŠÙ†Ø© (Sample ID)</label>
                        <input type="text" id="sampleId" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="Ù…Ø«Ø§Ù„: S-001">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</label>
                        <input type="date" id="testDate" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ÙˆØ­Ø¯Ø© Ø§Ù„ÙˆØ²Ù†</label>
                        <select id="massUnit" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" onchange="updateUnitLabels()">
                            <option value="g">Ø¬Ø±Ø§Ù… (g)</option>
                            <option value="kg">ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù… (kg)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                        <input type="text" id="notes" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©...">
                    </div>
                </div>

                <!-- Method Selection -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg mb-4">
                    <label class="block text-sm font-bold text-gray-800 mb-3">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù†Ø®Ù„ â€” Sieving Method:</label>
                    <div class="flex flex-wrap gap-4">
                        <label class="flex items-center gap-3 bg-white px-4 py-3 rounded-lg border-2 border-gray-200 cursor-pointer hover:border-blue-400 transition-all">
                            <input type="radio" name="method" value="single" checked onchange="toggleMethod()" class="w-5 h-5 text-blue-600">
                            <div>
                                <span class="font-semibold text-gray-800">Single-Set Sieving</span>
                                <p class="text-xs text-gray-500">ØºØ±Ø¨Ù„Ø© Ù…Ø¬Ù…ÙˆØ¹Ø© ÙˆØ§Ø­Ø¯Ø© â€” Ø§Ù„Ø£Ø¨Ø³Ø·</p>
                            </div>
                        </label>
                        <label class="flex items-center gap-3 bg-white px-4 py-3 rounded-lg border-2 border-gray-200 cursor-pointer hover:border-blue-400 transition-all">
                            <input type="radio" name="method" value="composite" onchange="toggleMethod()" class="w-5 h-5 text-blue-600">
                            <div>
                                <span class="font-semibold text-gray-800">Composite (Single Separation)</span>
                                <p class="text-xs text-gray-500" id="compositeMethodDesc">Ù…Ù†Ø®Ù„ Ø§Ù„ÙØµÙ„ Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Separator Sieve Selection -->
                <div id="separatorSelection" class="hidden bg-gradient-to-r from-amber-50 to-orange-50 p-4 rounded-lg border-2 border-amber-300">
                    <div class="flex flex-wrap items-center gap-4">
                        <div class="flex items-center gap-2">
                            <span class="text-2xl">ğŸ”€</span>
                            <div>
                                <label class="block text-sm font-bold text-gray-800">Ù…Ù†Ø®Ù„ Ø§Ù„ÙØµÙ„ (Designated Separating Sieve)</label>
                                <p class="text-xs text-gray-600">ÙŠÙØ³ØªØ®Ø¯Ù… Ù„Ù„ÙØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø®Ø´Ù† ÙˆØ§Ù„Ù†Ø§Ø¹Ù… â€” ASTM range: 19.0 mm to 2.00 mm</p>
                            </div>
                        </div>
                        <select id="separatorSieve" class="input-field border-2 border-amber-400 rounded-lg px-4 py-2 bg-white font-semibold text-amber-800" onchange="onSeparatorChange()">
                            <option value="19">3/4 in (19.0 mm)</option>
                            <option value="9.5">3/8 in (9.5 mm)</option>
                            <option value="4.75" selected>No.4 (4.75 mm) â€” Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ</option>
                            <option value="2">No.10 (2.00 mm)</option>
                        </select>
                        <div class="bg-amber-100 px-3 py-2 rounded-lg">
                            <span class="text-sm text-amber-800">Ø§Ù„Ù…Ù†Ø®Ù„ Ø§Ù„Ù…Ø®ØªØ§Ø±: <strong id="selectedSeparatorDisplay">No.4 (4.75 mm)</strong></span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Variables Glossary -->
            <details class="section-card p-6 mb-6">
                <summary class="text-lg font-bold text-gray-800 cursor-pointer flex items-center gap-2">
                    <span class="bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ“–</span>
                    Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„Ù…ØµØ·Ù„Ø­Ø§Øª â€” Variables Glossary
                </summary>
                <div class="mt-4 grid md:grid-cols-2 gap-4 text-sm">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-700 mb-2">Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ÙƒØªÙ„Ø© â€” Mass Variables:</h4>
                        <ul class="space-y-2">
                            <li><span class="glossary-term">S,Md</span> â€” Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø¬Ø§Ù Ù„Ù„Ø¹ÙŠÙ†Ø© Ø§Ù„ÙƒÙ„ÙŠØ© (Specimen Dry Mass)</li>
                            <li><span class="glossary-term">CP,Md</span> â€” Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø¬Ø§Ù Ù„Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø®Ø´Ù† (Coarser Portion Dry Mass)</li>
                            <li><span class="glossary-term">FP,Mm</span> â€” Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø±Ø·Ø¨ Ù„Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù†Ø§Ø¹Ù… (Finer Portion Moist Mass)</li>
                            <li><span class="glossary-term">FP,Md</span> â€” Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø¬Ø§Ù Ù„Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù†Ø§Ø¹Ù… Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© (Finer Portion Dry Mass)</li>
                            <li><span class="glossary-term">SubS,Md</span> â€” Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø¬Ø§Ù Ù„Ù„Ø¹ÙŠÙ†Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ© Ø§Ù„Ù†Ø§Ø¹Ù…Ø© (Subspecimen Dry Mass)</li>
                            <li><span class="glossary-term">wfp</span> â€” Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ Ù„Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù†Ø§Ø¹Ù… % (Water Content of FP)</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-700 mb-2">Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ â€” Result Variables:</h4>
                        <ul class="space-y-2">
                            <li><span class="glossary-term">CMRN</span> â€” Ø§Ù„ÙˆØ²Ù† Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠ Ø§Ù„Ù…Ø­ØªØ¬Ø² (Cumulative Mass Retained)</li>
                            <li><span class="glossary-term">PPN</span> â€” Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ø§Ù„Ù…Ø§Ø±Ø© (Percent Passing)</li>
                            <li><span class="glossary-term">CSCF</span> â€” Ù…Ø¹Ø§Ù…Ù„ ØªØµØ­ÙŠØ­ Ø§Ù„ÙØµÙ„ Ø§Ù„Ù…Ø±ÙƒØ¨ (Composite Separation Correction Factor)</li>
                            <li><span class="glossary-term">D10, D30, D60</span> â€” Ø£Ù‚Ø·Ø§Ø± Ø­Ø¨ÙŠØ¨Ø§Øª Ø¹Ù†Ø¯ Ù†Ø³Ø¨ Ù…Ø±ÙˆØ± Ù…Ø¹ÙŠÙ†Ø©</li>
                            <li><span class="glossary-term">Cu</span> â€” Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù… (Coefficient of Uniformity)</li>
                            <li><span class="glossary-term">Cc</span> â€” Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØ¯Ø±Ø¬ (Coefficient of Curvature)</li>
                        </ul>
                    </div>
                </div>
            </details>

            <!-- Single-Set Section -->
            <div id="singleSetSection" class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">2</span>
                    Single-Set Sieving â€” ØºØ±Ø¨Ù„Ø© Ù…Ø¬Ù…ÙˆØ¹Ø© ÙˆØ§Ø­Ø¯Ø©
                </h3>
                
                <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg mb-4">
                    <label class="block text-sm font-bold text-gray-700 mb-2">
                        <span class="glossary-term">S,Md</span> â€” Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø¬Ø§Ù Ù„Ù„Ø¹ÙŠÙ†Ø© Ø§Ù„Ù…ØºØ±Ø¨Ù„Ø©:
                    </label>
                    <div class="flex items-center gap-2">
                        <input type="number" id="single_SMd" step="0.01" min="0" class="input-field w-48 border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="0.00">
                        <span class="unit-label text-gray-600 font-semibold">g</span>
                    </div>
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full border-collapse" id="singleSetTable">
                        <thead>
                            <tr class="table-header text-white">
                                <th class="p-3 text-center border border-blue-800 w-24">Ø§Ù„Ù…Ù†Ø®Ù„<br>Sieve</th>
                                <th class="p-3 text-center border border-blue-800 w-28">Ø§Ù„ÙØªØ­Ø© (mm)<br>Opening</th>
                                <th class="p-3 text-center border border-blue-800 w-40">
                                    <span class="glossary-term bg-blue-200 text-blue-900">CMRN</span><br>
                                    Ø§Ù„ÙˆØ²Ù† Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠ Ø§Ù„Ù…Ø­ØªØ¬Ø²
                                </th>
                                <th class="p-3 text-center border border-blue-800 w-32">
                                    <span class="glossary-term bg-green-200 text-green-900">PPN</span><br>
                                    % Ø§Ù„Ù…Ø§Ø±
                                </th>
                            </tr>
                        </thead>
                        <tbody id="singleSetTableBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- Composite Section -->
            <div id="compositeSection" class="hidden">
                <div class="section-card p-6 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="bg-orange-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">2</span>
                        Composite â€” Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
                    </h3>
                    
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg">
                            <label class="block text-sm font-bold text-gray-700 mb-2">
                                <span class="glossary-term">CP,Md</span><br>
                                <span class="text-xs" id="cpMdLabel">Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø¬Ø§Ù Ù„Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø®Ø´Ù† (Ø§Ù„Ù…Ø­ØªØ¬Ø² Ø¹Ù„Ù‰ Ù…Ù†Ø®Ù„ Ø§Ù„ÙØµÙ„)</span>
                            </label>
                            <div class="flex items-center gap-2">
                                <input type="number" id="comp_CPMd" step="0.01" min="0" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="0.00">
                                <span class="unit-label text-gray-600 font-semibold">g</span>
                            </div>
                        </div>
                        
                        <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                            <label class="block text-sm font-bold text-gray-700 mb-2">
                                <span class="glossary-term">FP,Mm</span><br>
                                <span class="text-xs" id="fpMmLabel">Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø±Ø·Ø¨ Ù„Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù†Ø§Ø¹Ù… (Ø§Ù„Ù…Ø§Ø± Ù…Ù† Ù…Ù†Ø®Ù„ Ø§Ù„ÙØµÙ„)</span>
                            </label>
                            <div class="flex items-center gap-2">
                                <input type="number" id="comp_FPMm" step="0.01" min="0" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="0.00">
                                <span class="unit-label text-gray-600 font-semibold">g</span>
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <label class="block text-sm font-bold text-gray-700 mb-2">
                                <span class="glossary-term">wfp</span><br>
                                <span class="text-xs">Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ Ù„Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù†Ø§Ø¹Ù… % (Ù…Ù† D2216)</span>
                            </label>
                            <div class="flex items-center gap-2">
                                <input type="number" id="comp_wfp" step="0.01" min="0" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="0.00">
                                <span class="text-gray-600 font-semibold">%</span>
                            </div>
                        </div>
                        
                        <div class="bg-purple-50 border border-purple-200 p-4 rounded-lg">
                            <label class="block text-sm font-bold text-gray-700 mb-2">
                                <span class="glossary-term">SubS,Md</span><br>
                                <span class="text-xs">Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø¬Ø§Ù Ù„Ù„Ø¹ÙŠÙ†Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ© Ø§Ù„Ù†Ø§Ø¹Ù…Ø© Ø§Ù„Ù…ØºØ±Ø¨Ù„Ø©</span>
                            </label>
                            <div class="flex items-center gap-2">
                                <input type="number" id="comp_SubSMd" step="0.01" min="0" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="0.00">
                                <span class="unit-label text-gray-600 font-semibold">g</span>
                            </div>
                        </div>
                        
                        <div class="bg-gray-100 border border-gray-300 p-4 rounded-lg">
                            <label class="block text-sm font-bold text-gray-700 mb-2">
                                <span class="glossary-term">FP,Md</span> (Ù…Ø­Ø³ÙˆØ¨)<br>
                                <span class="text-xs">= FP,Mm Ã· (1 + wfp/100)</span>
                            </label>
                            <div class="flex items-center gap-2">
                                <input type="text" id="comp_FPMd" readonly class="input-field w-full bg-gray-200 border-2 border-gray-300 rounded-lg px-3 py-2 font-bold text-green-700" placeholder="â€”">
                                <span class="unit-label text-gray-600 font-semibold">g</span>
                            </div>
                        </div>
                        
                        <div class="bg-gray-100 border border-gray-300 p-4 rounded-lg">
                            <label class="block text-sm font-bold text-gray-700 mb-2">
                                <span class="glossary-term">S,Md</span> (Ù…Ø­Ø³ÙˆØ¨)<br>
                                <span class="text-xs">= CP,Md + FP,Md</span>
                            </label>
                            <div class="flex items-center gap-2">
                                <input type="text" id="comp_SMd" readonly class="input-field w-full bg-gray-200 border-2 border-gray-300 rounded-lg px-3 py-2 font-bold text-blue-700" placeholder="â€”">
                                <span class="unit-label text-gray-600 font-semibold">g</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4 bg-gradient-to-r from-indigo-100 to-purple-100 p-4 rounded-lg border border-indigo-300">
                        <div class="flex items-center justify-between flex-wrap gap-4">
                            <div>
                                <span class="font-bold text-gray-800">Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØµØ­ÙŠØ­ <span class="glossary-term">CSCF</span></span>
                                <p class="text-xs text-gray-600" id="cscfDescription">= % Passing Ø¹Ù†Ø¯ Ù…Ù†Ø®Ù„ Ø§Ù„ÙØµÙ„ Ù…Ù† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø®Ø´Ù† (Ø¨Ø¯Ù‚Ø© 0.1%)</p>
                            </div>
                            <div class="text-2xl font-bold text-indigo-700" id="cscfDisplay">â€”</div>
                        </div>
                    </div>
                </div>

                <!-- Coarser Portion Table -->
                <div class="section-card p-6 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2" id="coarserTableTitle">
                        <span class="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">3</span>
                        Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø®Ø´Ù† (CP) â€” Coarser Portion (3 in â†’ No.4)
                    </h3>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse" id="coarserTable">
                            <thead>
                                <tr class="table-header text-white">
                                    <th class="p-3 text-center border border-blue-800 w-24">Ø§Ù„Ù…Ù†Ø®Ù„<br>Sieve</th>
                                    <th class="p-3 text-center border border-blue-800 w-28">Ø§Ù„ÙØªØ­Ø© (mm)<br>Opening</th>
                                    <th class="p-3 text-center border border-blue-800 w-40">
                                        <span class="glossary-term bg-blue-200 text-blue-900">CP,CMRN</span><br>
                                        Ø§Ù„ÙˆØ²Ù† Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠ Ø§Ù„Ù…Ø­Ø¬ÙˆØ²
                                    </th>
                                    <th class="p-3 text-center border border-blue-800 w-32">
                                        <span class="glossary-term bg-green-200 text-green-900">CP,PPN</span><br>
                                        % Ø§Ù„Ù…Ø§Ø±
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="coarserTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Finer Portion Table -->
                <div class="section-card p-6 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2" id="finerTableTitle">
                        <span class="bg-teal-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">4</span>
                        Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù†Ø§Ø¹Ù… (SubS) â€” Finer Subspecimen (No.4 â†’ No.200)
                    </h3>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse" id="finerTable">
                            <thead>
                                <tr class="table-header text-white">
                                    <th class="p-3 text-center border border-blue-800 w-20">Ø§Ù„Ù…Ù†Ø®Ù„<br>Sieve</th>
                                    <th class="p-3 text-center border border-blue-800 w-24">Ø§Ù„ÙØªØ­Ø© (mm)<br>Opening</th>
                                    <th class="p-3 text-center border border-blue-800 w-36">
                                        <span class="glossary-term bg-blue-200 text-blue-900">SubS,FCMRN</span><br>
                                        Ø§Ù„ÙˆØ²Ù† Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠ
                                    </th>
                                    <th class="p-3 text-center border border-blue-800 w-28">
                                        <span class="glossary-term bg-yellow-200 text-yellow-900">SubS,FPPN</span><br>
                                        % Ù…Ø§Ø± Ø¬Ø²Ø¦ÙŠ
                                    </th>
                                    <th class="p-3 text-center border border-blue-800 w-28">
                                        <span class="glossary-term bg-green-200 text-green-900">SubS,PPN</span><br>
                                        % Ù…Ø§Ø± Ù†Ù‡Ø§Ø¦ÙŠ
                                    </th>
                                </tr>
                            </thead>
                            <tbody id="finerTableBody"></tbody>
                        </table>
                    </div>
                    
                    <div id="separatorWarning" class="hidden validation-msg validation-warning mt-4">
                        âš ï¸ ØªØ­Ø°ÙŠØ±: ÙŠÙˆØ¬Ø¯ Ù…Ø­Ø¬ÙˆØ² Ø¹Ù„Ù‰ Ù…Ù†Ø®Ù„ Ø§Ù„ÙØµÙ„ ÙÙŠ Ø§Ù„Ø¹ÙŠÙ†Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ© Ø§Ù„Ù†Ø§Ø¹Ù…Ø©.
                    </div>
                </div>
            </div>

            <!-- Final Results Table -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-emerald-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ“‹</span>
                    Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© â€” Final Specimen Gradation
                </h3>
                
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse" id="finalTable">
                        <thead>
                            <tr class="bg-gradient-to-r from-emerald-700 to-teal-600 text-white">
                                <th class="p-3 text-center border border-emerald-800 w-24">Ø§Ù„Ù…Ù†Ø®Ù„<br>Sieve</th>
                                <th class="p-3 text-center border border-emerald-800 w-28">Ø§Ù„ÙØªØ­Ø© (mm)<br>Opening</th>
                                <th class="p-3 text-center border border-emerald-800 w-32">% Ø§Ù„Ù…Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ<br>Final PPN</th>
                                <th class="p-3 text-center border border-emerald-800 w-32">% Ø§Ù„Ù…Ø­Ø¬ÙˆØ² Ø§Ù„ØªØ±Ø§ÙƒÙ…ÙŠ<br>Cum. % Retained</th>
                                <th class="p-3 text-center border border-emerald-800 w-32">% Ø§Ù„Ù…Ø­Ø¬ÙˆØ² Ø§Ù„ÙØ±Ø¯ÙŠ<br>% Retained</th>
                            </tr>
                        </thead>
                        <tbody id="finalTableBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-wrap gap-4 justify-center mb-6">
                <button onclick="calculate()" class="btn-primary text-white px-8 py-3 rounded-lg font-bold text-lg shadow-lg flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    </svg>
                    Ø§Ø­Ø³Ø¨ â€” Calculate
                </button>
                <button onclick="resetAll()" class="btn-secondary text-white px-8 py-3 rounded-lg font-bold text-lg shadow-lg flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† â€” Reset
                </button>
                <button onclick="loadDemoData()" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-3 rounded-lg font-bold text-lg shadow-lg flex items-center gap-2 hover:from-purple-600 hover:to-pink-600 transition-all">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                    </svg>
                    Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© â€” Demo Data
                </button>

            </div>

            <div id="validationMessages" class="mb-6"></div>

            <!-- Chart Section -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ“ˆ</span>
                    Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ø­Ø¨ÙŠØ¨ÙŠ â€” Gradation Curve
                </h3>
                
                <div class="chart-container">
                    <canvas id="gradationChart" height="400"></canvas>
                </div>
                
                <div class="grid md:grid-cols-5 gap-4 mt-6">
                    <div class="bg-blue-50 p-4 rounded-lg text-center border border-blue-200">
                        <div class="text-sm text-gray-600 mb-1">Dâ‚â‚€ (mm)</div>
                        <div class="text-xl font-bold text-blue-700" id="d10Value">â€”</div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg text-center border border-blue-200">
                        <div class="text-sm text-gray-600 mb-1">Dâ‚ƒâ‚€ (mm)</div>
                        <div class="text-xl font-bold text-blue-700" id="d30Value">â€”</div>
                    </div>
                    <div class="bg-blue-50 p-4 rounded-lg text-center border border-blue-200">
                        <div class="text-sm text-gray-600 mb-1">Dâ‚†â‚€ (mm)</div>
                        <div class="text-xl font-bold text-blue-700" id="d60Value">â€”</div>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg text-center border border-green-200">
                        <div class="text-sm text-gray-600 mb-1">Cu (Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù…)</div>
                        <div class="text-xl font-bold text-green-700" id="cuValue">â€”</div>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg text-center border border-green-200">
                        <div class="text-sm text-gray-600 mb-1">Cc (Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØ¯Ø±Ø¬)</div>
                        <div class="text-xl font-bold text-green-700" id="ccValue">â€”</div>
                    </div>
                </div>
            </div>

        </div>

        <!-- ============================================= -->
        <!-- D1557 SECTION - Modified Proctor -->
        <!-- ============================================= -->
        <div id="sectionD1557" class="hidden">
            <!-- Page Title -->
            <div class="section-card p-6 mb-6">
                <div class="flex items-center gap-4">
                    <div class="bg-orange-100 p-4 rounded-full">
                        <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¯Ù…Ùƒ Ø§Ù„Ù…Ø¹Ø¯Ù„ â€” Modified Proctor Compaction</h2>
                        <p class="text-gray-600">ASTM D1557-12(2021) | Ø·Ø§Ù‚Ø© Ø§Ù„Ø¯Ù…Ùƒ: 2700 kNÂ·m/mÂ³ </p>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-orange-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">1</span>
                    Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± â€” Test Settings
                </h3>
                
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">Ø±Ù‚Ù… Ø§Ù„Ø¹ÙŠÙ†Ø© (Sample ID)</label>
                        <input type="text" id="proctor_sampleId" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="Ù…Ø«Ø§Ù„: P-001">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</label>
                        <input type="date" id="proctor_testDate" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">
                            Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© (Method)
                            <span class="text-xs text-gray-500 block">Ø­Ø³Ø¨ Ø­Ø¬Ù… Ø§Ù„Ù‚Ø§Ù„Ø¨ ÙˆØ§Ù„Ù…Ø§Ø¯Ø©</span>
                        </label>
                        <select id="proctor_method" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2">
                            <option value="A">Method A â€” Ù‚Ø§Ù„Ø¨ 4 in (101.6 mm)</option>
                            <option value="B">Method B â€” Ù‚Ø§Ù„Ø¨ 4 in (101.6 mm)</option>
                            <option value="C">Method C â€” Ù‚Ø§Ù„Ø¨ 6 in (152.4 mm)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                        <input type="text" id="proctor_notes" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©...">
                    </div>
                </div>

                <!-- Unit Selection -->
                <div class="bg-gradient-to-r from-orange-50 to-amber-50 p-4 rounded-lg mb-4">
                    <label class="block text-sm font-bold text-gray-800 mb-3">
                        ÙˆØ­Ø¯Ø© Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬ (Output Unit) â€” <span class="glossary-term">unitSystem</span>
                        <span class="text-xs text-gray-600 block mt-1">Ø§Ø®ØªØ± ÙˆØ­Ø¯Ø© Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© Ø£Ùˆ ÙˆØ²Ù† Ø§Ù„ÙˆØ­Ø¯Ø©</span>
                    </label>
                    <div class="flex flex-wrap gap-4">
                        <label class="flex items-center gap-3 bg-white px-4 py-3 rounded-lg border-2 border-gray-200 cursor-pointer hover:border-orange-400 transition-all">
                            <input type="radio" name="unitSystem" value="g_cm3" checked onchange="onProctorUnitChange()" class="w-5 h-5 text-orange-600">
                            <div>
                                <span class="font-semibold text-gray-800">g/cmÂ³</span>
                                <p class="text-xs text-gray-500">Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© (Ïd)</p>
                            </div>
                        </label>
                        <label class="flex items-center gap-3 bg-white px-4 py-3 rounded-lg border-2 border-gray-200 cursor-pointer hover:border-orange-400 transition-all">
                            <input type="radio" name="unitSystem" value="kg_m3" onchange="onProctorUnitChange()" class="w-5 h-5 text-orange-600">
                            <div>
                                <span class="font-semibold text-gray-800">kg/mÂ³</span>
                                <p class="text-xs text-gray-500">Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© (Ïd)</p>
                            </div>
                        </label>
                        <label class="flex items-center gap-3 bg-white px-4 py-3 rounded-lg border-2 border-gray-200 cursor-pointer hover:border-orange-400 transition-all">
                            <input type="radio" name="unitSystem" value="kN_m3" onchange="onProctorUnitChange()" class="w-5 h-5 text-orange-600">
                            <div>
                                <span class="font-semibold text-gray-800">kN/mÂ³</span>
                                <p class="text-xs text-gray-500">ÙˆØ²Ù† Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¬Ø§Ù (Î³d)</p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Mold Data -->
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg">
                        <label class="block text-sm font-bold text-gray-700 mb-2">
                            <span class="glossary-term">Mmd</span> â€” ÙƒØªÙ„Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨ (Mold Mass)
                        </label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="moldMass_g" step="0.1" min="0" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="Ù…Ø«Ø§Ù„: 4250">
                            <span class="text-gray-600 font-semibold">g</span>
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg">
                        <label class="block text-sm font-bold text-gray-700 mb-2">
                            <span class="glossary-term">V</span> â€” Ø­Ø¬Ù… Ø§Ù„Ù‚Ø§Ù„Ø¨ (Mold Volume)
                        </label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="moldVol_value" step="0.01" min="0" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="Ù…Ø«Ø§Ù„: 943.3">
                            <select id="moldVol_unit" class="input-field border-2 border-gray-300 rounded-lg px-2 py-2">
                                <option value="cm3">cmÂ³</option>
                                <option value="m3">mÂ³</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                        <label class="block text-sm font-bold text-gray-700 mb-2">
                            <span class="glossary-term">Gs</span> â€” Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ù†ÙˆØ¹ÙŠØ© (Specific Gravity)
                            <span class="text-xs text-gray-500 block">Ù„Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„ØªØ´Ø¨Ø¹ 100%</span>
                        </label>
                        <div class="flex items-center gap-2">
                            <input type="number" id="Gs_input" step="0.01" min="2" max="3" value="2.65" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Variables Glossary for D1557 -->
            <details class="section-card p-6 mb-6">
                <summary class="text-lg font-bold text-gray-800 cursor-pointer flex items-center gap-2">
                    <span class="bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ“–</span>
                    Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„Ù…ØµØ·Ù„Ø­Ø§Øª â€” D1557 Variables Glossary
                </summary>
                <div class="mt-4 grid md:grid-cols-2 gap-4 text-sm">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-700 mb-2">Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ â€” Water Content Variables:</h4>
                        <ul class="space-y-2">
                            <li><span class="glossary-term">Wet+Tare</span> â€” ÙˆØ²Ù† Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø±Ø·Ø¨Ø© + Ø§Ù„Ø¹Ù„Ø¨Ø© (Wet Soil + Container)</li>
                            <li><span class="glossary-term">Dry+Tare</span> â€” ÙˆØ²Ù† Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø¬Ø§ÙØ© + Ø§Ù„Ø¹Ù„Ø¨Ø© (Dry Soil + Container)</li>
                            <li><span class="glossary-term">Tare</span> â€” ÙˆØ²Ù† Ø§Ù„Ø¹Ù„Ø¨Ø© Ø§Ù„ÙØ§Ø±ØºØ© (Container Mass)</li>
                            <li><span class="glossary-term">w%</span> â€” Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ (Water Content)</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-700 mb-2">Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ÙƒØ«Ø§ÙØ© â€” Density Variables:</h4>
                        <ul class="space-y-2">
                            <li><span class="glossary-term">Mt</span> â€” ÙˆØ²Ù† Ø§Ù„Ù‚Ø§Ù„Ø¨ + Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø±Ø·Ø¨Ø© (Mold + Moist Soil)</li>
                            <li><span class="glossary-term">Ïm</span> â€” Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø±Ø·Ø¨Ø© (Moist Density) â€” Eq 4</li>
                            <li><span class="glossary-term">Ïd</span> â€” Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© (Dry Density) â€” Eq 5</li>
                            <li><span class="glossary-term">Î³d</span> â€” ÙˆØ²Ù† Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¬Ø§Ù (Dry Unit Weight) â€” Eq 7</li>
                            <li><span class="glossary-term">OMC</span> â€” Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ Ø§Ù„Ø£Ù…Ø«Ù„ (Optimum Moisture Content)</li>
                            <li><span class="glossary-term">MDD</span> â€” Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© Ø§Ù„Ù‚ØµÙˆÙ‰ (Maximum Dry Density)</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-700 mb-2">Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© â€” Key Equations (D1557 Section 11):</h4>
                        <ul class="space-y-2">
                            <li><span class="glossary-term">Eq 4</span>: Ïm = K Ã— (Mt - Mmd) / V â€” Ø­Ø³Ø§Ø¨ Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø±Ø·Ø¨Ø©</li>
                            <li><span class="glossary-term">Eq 5</span>: Ïd = Ïm / (1 + w/100) â€” Ø­Ø³Ø§Ø¨ Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ©</li>
                            <li><span class="glossary-term">Eq 7</span>: Î³d = 9.8066 Ã— Ïd â€” ØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙƒØ«Ø§ÙØ© Ø¥Ù„Ù‰ ÙˆØ²Ù† Ø§Ù„ÙˆØ­Ø¯Ø© (g/cmÂ³ â†’ kN/mÂ³)</li>
                            <li><span class="glossary-term">Eq 8</span>: wsat = (Î³wÃ—Gs/Î³d - 1) Ã— 100 â€” Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„ØªØ´Ø¨Ø¹ 100%</li>
                        </ul>
                    </div>
                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-700 mb-2">Ù…ØªØºÙŠØ±Ø§Øª ØªØµØ­ÙŠØ­ D4718 â€” Oversize Correction Variables:</h4>
                        <ul class="space-y-2">
                            <li><span class="glossary-term">Pc</span> â€” Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© % (Oversize Fraction)</li>
                            <li><span class="glossary-term">Gm</span> â€” Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ù†ÙˆØ¹ÙŠØ© Ø§Ù„Ø¸Ø§Ù‡Ø±ÙŠØ© Ù„Ù„Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© (Bulk SG - SSD)</li>
                            <li><span class="glossary-term">Ac</span> â€” Ø§Ù…ØªØµØ§Øµ Ø§Ù„Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© % (Absorption of Oversize)</li>
                            <li><span class="glossary-term">Ïc</span> â€” ÙƒØ«Ø§ÙØ© Ø§Ù„Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© = Gm Ã— Ïw (Density of Oversize)</li>
                            <li><span class="glossary-term">Ïd,corr</span> â€” Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© Ø§Ù„Ù…ØµØ­Ø­Ø© (Corrected Dry Density)</li>
                            <li><span class="glossary-term">w,corr</span> â€” Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ Ø§Ù„Ù…ØµØ­Ø­ (Corrected Water Content)</li>
                        </ul>
                    </div>
                </div>
            </details>

            <!-- Point Numbers Row -->
            <div class="section-card p-6 mb-6">
                <div class="flex items-center justify-center gap-4 mb-4">
                    <span class="text-lg font-bold text-gray-700">Ù†Ù‚Ø§Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± â€” Test Points:</span>
                    <div class="flex gap-3">
                        <div class="point-number">1</div>
                        <div class="point-number">2</div>
                        <div class="point-number">3</div>
                        <div class="point-number">4</div>
                        <div class="point-number">5</div>
                    </div>
                </div>
            </div>

            <!-- Water Content Table -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">2</span>
                    Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ â€” Water Content Table
                    <span class="text-sm font-normal text-gray-500">(ASTM D2216)</span>
                </h3>
                
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="table-header-orange text-white">
                                <th class="p-3 text-center border border-orange-800 w-48">Ø§Ù„Ø¨ÙŠØ§Ù† / Parameter</th>
                                <th class="p-3 text-center border border-orange-800">Ø§Ù„Ù†Ù‚Ø·Ø© 1<br>Point 1</th>
                                <th class="p-3 text-center border border-orange-800">Ø§Ù„Ù†Ù‚Ø·Ø© 2<br>Point 2</th>
                                <th class="p-3 text-center border border-orange-800">Ø§Ù„Ù†Ù‚Ø·Ø© 3<br>Point 3</th>
                                <th class="p-3 text-center border border-orange-800">Ø§Ù„Ù†Ù‚Ø·Ø© 4<br>Point 4</th>
                                <th class="p-3 text-center border border-orange-800">Ø§Ù„Ù†Ù‚Ø·Ø© 5<br>Point 5</th>
                            </tr>
                        </thead>
                        <tbody id="wcTableBody">
                            <tr class="bg-gray-50">
                                <td class="p-2 border border-gray-300 font-semibold text-right">
                                    <span class="glossary-term">Wet+Tare</span><br>
                                    <span class="text-xs text-gray-500">Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø±Ø·Ø¨Ø© + Ø§Ù„Ø¹Ù„Ø¨Ø© (g)</span>
                                </td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcWetTare_1" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcWetTare_2" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcWetTare_3" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcWetTare_4" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcWetTare_5" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                            </tr>
                            <tr class="bg-white">
                                <td class="p-2 border border-gray-300 font-semibold text-right">
                                    <span class="glossary-term">Dry+Tare</span><br>
                                    <span class="text-xs text-gray-500">Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø¬Ø§ÙØ© + Ø§Ù„Ø¹Ù„Ø¨Ø© (g)</span>
                                </td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcDryTare_1" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcDryTare_2" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcDryTare_3" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcDryTare_4" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcDryTare_5" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                            </tr>
                            <tr class="bg-gray-50">
                                <td class="p-2 border border-gray-300 font-semibold text-right">
                                    <span class="glossary-term">Tare</span><br>
                                    <span class="text-xs text-gray-500">ÙƒØªÙ„Ø© Ø§Ù„Ø¹Ù„Ø¨Ø© (g)</span>
                                </td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcTare_1" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcTare_2" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcTare_3" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcTare_4" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.01" id="wcTare_5" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                            </tr>
                            <tr class="bg-blue-50">
                                <td class="p-2 border border-gray-300 font-semibold text-right">
                                    <span class="glossary-term">Water</span> (Ù…Ø­Ø³ÙˆØ¨)<br>
                                    <span class="text-xs text-gray-500">ÙƒØªÙ„Ø© Ø§Ù„Ù…Ø§Ø¡ (g)</span>
                                </td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="wcWater_1">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="wcWater_2">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="wcWater_3">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="wcWater_4">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="wcWater_5">â€”</td>
                            </tr>
                            <tr class="bg-blue-50">
                                <td class="p-2 border border-gray-300 font-semibold text-right">
                                    <span class="glossary-term">DrySoil</span> (Ù…Ø­Ø³ÙˆØ¨)<br>
                                    <span class="text-xs text-gray-500">ÙƒØªÙ„Ø© Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø¬Ø§ÙØ© (g)</span>
                                </td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="wcDrySoil_1">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="wcDrySoil_2">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="wcDrySoil_3">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="wcDrySoil_4">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="wcDrySoil_5">â€”</td>
                            </tr>
                            <tr class="bg-green-100">
                                <td class="p-2 border border-gray-300 font-semibold text-right">
                                    <span class="glossary-term">w%</span> (Ù…Ø­Ø³ÙˆØ¨)<br>
                                    <span class="text-xs text-gray-500">Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ %</span>
                                </td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-green-700" id="w_1">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-green-700" id="w_2">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-green-700" id="w_3">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-green-700" id="w_4">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-green-700" id="w_5">â€”</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Density/Compaction Table -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-orange-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">3</span>
                    Ø¬Ø¯ÙˆÙ„ Ø§Ù„ÙƒØ«Ø§ÙØ©/Ø§Ù„Ø¯Ù…Ùƒ â€” Density/Compaction Table
                </h3>
                
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="table-header-orange text-white">
                                <th class="p-3 text-center border border-orange-800 w-48">Ø§Ù„Ø¨ÙŠØ§Ù† / Parameter</th>
                                <th class="p-3 text-center border border-orange-800">Ø§Ù„Ù†Ù‚Ø·Ø© 1<br>Point 1</th>
                                <th class="p-3 text-center border border-orange-800">Ø§Ù„Ù†Ù‚Ø·Ø© 2<br>Point 2</th>
                                <th class="p-3 text-center border border-orange-800">Ø§Ù„Ù†Ù‚Ø·Ø© 3<br>Point 3</th>
                                <th class="p-3 text-center border border-orange-800">Ø§Ù„Ù†Ù‚Ø·Ø© 4<br>Point 4</th>
                                <th class="p-3 text-center border border-orange-800">Ø§Ù„Ù†Ù‚Ø·Ø© 5<br>Point 5</th>
                            </tr>
                        </thead>
                        <tbody id="densityTableBody">
                            <tr class="bg-gray-50">
                                <td class="p-2 border border-gray-300 font-semibold text-right">
                                    <span class="glossary-term">Mt</span><br>
                                    <span class="text-xs text-gray-500">Ø§Ù„Ù‚Ø§Ù„Ø¨ + Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø±Ø·Ø¨Ø© (g)</span>
                                </td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.1" id="moldWet_1_g" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.1" id="moldWet_2_g" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.1" id="moldWet_3_g" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.1" id="moldWet_4_g" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                                <td class="p-2 border border-gray-300"><input type="number" step="0.1" id="moldWet_5_g" class="input-field w-full border border-gray-300 rounded px-2 py-1"></td>
                            </tr>
                            <tr class="bg-blue-50">
                                <td class="p-2 border border-gray-300 font-semibold text-right">
                                    <span class="glossary-term" id="moistDensityLabel">Ïm</span> (Ù…Ø­Ø³ÙˆØ¨)<br>
                                    <span class="text-xs text-gray-500" id="moistDensityUnit">Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø±Ø·Ø¨Ø© (g/cmÂ³)</span>
                                </td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="out_moist_1">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="out_moist_2">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="out_moist_3">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="out_moist_4">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-blue-700" id="out_moist_5">â€”</td>
                            </tr>
                            <tr class="bg-green-100">
                                <td class="p-2 border border-gray-300 font-semibold text-right">
                                    <span class="glossary-term" id="dryDensityLabel">Ïd</span> (Ù…Ø­Ø³ÙˆØ¨)<br>
                                    <span class="text-xs text-gray-500" id="dryDensityUnit">Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© (g/cmÂ³)</span>
                                </td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-green-700" id="out_dry_1">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-green-700" id="out_dry_2">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-green-700" id="out_dry_3">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-green-700" id="out_dry_4">â€”</td>
                                <td class="p-2 border border-gray-300 text-center font-bold text-green-700" id="out_dry_5">â€”</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Oversize Correction Section -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-yellow-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">âš ï¸</span>
                    ØªØµØ­ÙŠØ­ Ø§Ù„Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© â€” Oversize Correction (ASTM D4718)
                </h3>
                
                <!-- Enable/Disable Toggle -->
                <div class="bg-gradient-to-r from-yellow-50 to-amber-50 p-4 rounded-lg mb-4 border-2 border-yellow-300">
                    <label class="flex items-center gap-3 cursor-pointer">
                        <input type="checkbox" id="enableOversizeCorrection" onchange="toggleOversizeCorrection()" class="w-5 h-5 text-yellow-600 rounded">
                        <div>
                            <span class="font-bold text-gray-800">ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØµØ­ÙŠØ­ â€” Enable Oversize Correction</span>
                            <p class="text-xs text-gray-600">ÙŠÙØ·Ø¨Ù‚ Ø¹Ù†Ø¯Ù…Ø§ ØªØ­ØªÙˆÙŠ Ø§Ù„Ø¹ÙŠÙ†Ø© Ø¹Ù„Ù‰ Ø­Ø¨ÙŠØ¨Ø§Øª Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ù…Ù†Ø®Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</p>
                        </div>
                    </label>
                </div>

                <!-- Oversize Inputs (Initially Hidden) -->
                <div id="oversizeCorrectionInputs" class="hidden">
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                        <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
                            <label class="block text-sm font-bold text-gray-700 mb-2">
                                <span class="glossary-term">Pc</span> â€” Ù†Ø³Ø¨Ø© Ø§Ù„Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
                                <span class="text-xs text-gray-500 block">Oversize Fraction (%)</span>
                            </label>
                            <div class="flex items-center gap-2">
                                <input type="number" id="PCpercent" step="0.1" min="0" max="40" value="0" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" onchange="checkOversizeLimit()">
                                <span class="text-gray-600 font-semibold">%</span>
                            </div>
                            <p class="text-xs text-red-600 mt-1" id="pcLimitWarning"></p>
                        </div>
                        
                        <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg">
                            <label class="block text-sm font-bold text-gray-700 mb-2">
                                <span class="glossary-term">Gm</span> â€” Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ù†ÙˆØ¹ÙŠØ© Ø§Ù„Ø¸Ø§Ù‡Ø±ÙŠØ©
                                <span class="text-xs text-gray-500 block">Bulk SG of Oversize (SSD)</span>
                            </label>
                            <div class="flex items-center gap-2">
                                <input type="number" id="Gm_input" step="0.01" min="2.0" max="3.5" value="2.65" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2">
                            </div>
                        </div>
                        
                        <div class="bg-green-50 border border-green-200 p-4 rounded-lg">
                            <label class="block text-sm font-bold text-gray-700 mb-2">
                                <span class="glossary-term">Ac</span> â€” Ø§Ù…ØªØµØ§Øµ Ø§Ù„Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©
                                <span class="text-xs text-gray-500 block">Absorption of Oversize (%)</span>
                            </label>
                            <div class="flex items-center gap-2">
                                <input type="number" id="Ac_input" step="0.1" min="0" max="10" value="1.5" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2">
                                <span class="text-gray-600 font-semibold">%</span>
                            </div>
                        </div>
                        
                        <div class="bg-purple-50 border border-purple-200 p-4 rounded-lg">
                            <label class="block text-sm font-bold text-gray-700 mb-2">
                                <span class="glossary-term">Ïw</span> â€” ÙƒØ«Ø§ÙØ© Ø§Ù„Ù…Ø§Ø¡
                                <span class="text-xs text-gray-500 block">Density of Water (g/cmÂ³)</span>
                            </label>
                            <div class="flex items-center gap-2">
                                <input type="number" id="rhoW_input" step="0.001" min="0.99" max="1.01" value="1.000" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2">
                                <span class="text-gray-600 font-semibold">g/cmÂ³</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- D4718 Equations Reference -->
                    <details class="bg-gray-50 border border-gray-200 p-4 rounded-lg mb-4">
                        <summary class="font-bold text-gray-700 cursor-pointer">ğŸ“ Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­ â€” D4718 Correction Equations</summary>
                        <div class="mt-3 grid md:grid-cols-2 gap-4 text-sm">
                            <div class="bg-white p-3 rounded border">
                                <p class="font-bold text-blue-700 mb-2">ØªØµØ­ÙŠØ­ Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© Ø§Ù„Ù‚ØµÙˆÙ‰ â€” Corrected MDD:</p>
                                <code class="block bg-gray-100 p-2 rounded text-xs" dir="ltr">
                                    Ïd,corr = 1 / [(Pc/100)/Ïc + (1 - Pc/100)/Ïd,test]
                                </code>
                                <p class="text-gray-600 mt-2">Ø­ÙŠØ«: <span class="glossary-term">Ïc</span> = Gm Ã— Ïw (ÙƒØ«Ø§ÙØ© Ø§Ù„Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø©)</p>
                            </div>
                            <div class="bg-white p-3 rounded border">
                                <p class="font-bold text-green-700 mb-2">ØªØµØ­ÙŠØ­ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ Ø§Ù„Ø£Ù…Ø«Ù„ â€” Corrected OMC:</p>
                                <code class="block bg-gray-100 p-2 rounded text-xs" dir="ltr">
                                    w_corr = w_test Ã— (1 - Pc/100) + Ac Ã— (Pc/100)
                                </code>
                                <p class="text-gray-600 mt-2">Ø­ÙŠØ«: <span class="glossary-term">Ac</span> = Ø§Ù…ØªØµØ§Øµ Ø§Ù„Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© %</p>
                            </div>
                        </div>
                    </details>
                    
                    <!-- Corrected Results Cards -->
                    <div id="correctedResultsSection" class="hidden">
                        <h4 class="text-md font-bold text-gray-800 mb-3 flex items-center gap-2">
                            <span class="text-green-600">âœ“</span> Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…ØµØ­Ø­Ø© â€” Corrected Results (D4718)
                        </h4>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="bg-gradient-to-r from-green-100 to-emerald-100 border-2 border-green-400 p-4 rounded-lg text-center">
                                <div class="text-sm font-bold text-gray-700 mb-1">
                                    <span class="glossary-term">OMC,corr</span> â€” Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ Ø§Ù„Ø£Ù…Ø«Ù„ Ø§Ù„Ù…ØµØ­Ø­
                                </div>
                                <div class="text-3xl font-bold text-green-700" id="omcCorrectedResult">â€”</div>
                                <div class="text-sm text-gray-600">%</div>
                            </div>
                            <div class="bg-gradient-to-r from-green-100 to-emerald-100 border-2 border-green-400 p-4 rounded-lg text-center">
                                <div class="text-sm font-bold text-gray-700 mb-1">
                                    <span class="glossary-term">MDD,corr</span> â€” Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© Ø§Ù„Ù‚ØµÙˆÙ‰ Ø§Ù„Ù…ØµØ­Ø­Ø©
                                </div>
                                <div class="text-3xl font-bold text-green-700" id="mddCorrectedResult">â€”</div>
                                <div class="text-sm text-gray-600" id="mddCorrectedUnit">g/cmÂ³</div>
                            </div>
                        </div>
                        
                        <!-- Comparison Table -->
                        <div class="mt-4 overflow-x-auto">
                            <table class="w-full border-collapse text-sm">
                                <thead>
                                    <tr class="bg-gray-200">
                                        <th class="p-2 border text-center">Ø§Ù„Ø¨ÙŠØ§Ù†</th>
                                        <th class="p-2 border text-center bg-orange-100">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© (Test)</th>
                                        <th class="p-2 border text-center bg-green-100">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…ØµØ­Ø­Ø© (Corrected)</th>
                                        <th class="p-2 border text-center">Ø§Ù„ÙØ±Ù‚</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="p-2 border font-semibold">OMC (%)</td>
                                        <td class="p-2 border text-center" id="omcOriginal">â€”</td>
                                        <td class="p-2 border text-center font-bold text-green-700" id="omcCorrectedTable">â€”</td>
                                        <td class="p-2 border text-center" id="omcDiff">â€”</td>
                                    </tr>
                                    <tr>
                                        <td class="p-2 border font-semibold">MDD</td>
                                        <td class="p-2 border text-center" id="mddOriginal">â€”</td>
                                        <td class="p-2 border text-center font-bold text-green-700" id="mddCorrectedTable">â€”</td>
                                        <td class="p-2 border text-center" id="mddDiff">â€”</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Warning Messages -->
                    <div id="oversizeWarning" class="hidden validation-msg validation-warning mt-4">
                        âš ï¸ ØªØ­Ø°ÙŠØ±: Pc > 30% â€” Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© D4718 Ù‚Ø¯ Ù„Ø§ ØªÙƒÙˆÙ† Ø¯Ù‚ÙŠÙ‚Ø©. ÙŠÙÙØ¶Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø·Ø±ÙŠÙ‚Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¯ÙŠÙ„Ø©.
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-wrap gap-4 justify-center mb-6">
                <button onclick="calculateProctor()" class="btn-orange text-white px-8 py-3 rounded-lg font-bold text-lg shadow-lg flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                    </svg>
                    Ø§Ø­Ø³Ø¨ â€” Calculate
                </button>
                <button onclick="resetProctor()" class="btn-secondary text-white px-8 py-3 rounded-lg font-bold text-lg shadow-lg flex items-center gap-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                    </svg>
                    Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† â€” Reset
                </button>
                <button onclick="loadProctorDemo()" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-8 py-3 rounded-lg font-bold text-lg shadow-lg flex items-center gap-2 hover:from-purple-600 hover:to-pink-600 transition-all">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                    </svg>
                    Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© â€” Demo Data
                </button>

            </div>

            <div id="proctorValidationMessages" class="mb-6"></div>

            <!-- Results Cards -->
            <div class="grid md:grid-cols-2 gap-6 mb-6">
                <div class="result-card">
                    <div class="text-lg font-bold text-gray-800 mb-2">
                        <span class="glossary-term">OMC</span> â€” Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ Ø§Ù„Ø£Ù…Ø«Ù„
                        <span class="block text-sm font-normal text-gray-600">Optimum Moisture Content</span>
                    </div>
                    <div class="result-card-value" id="omcResult">â€”</div>
                    <div class="text-sm text-gray-600">%</div>
                </div>
                <div class="result-card">
                    <div class="text-lg font-bold text-gray-800 mb-2">
                        <span class="glossary-term">MDD</span> â€” Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© Ø§Ù„Ù‚ØµÙˆÙ‰
                        <span class="block text-sm font-normal text-gray-600">Maximum Dry Density</span>
                    </div>
                    <div class="result-card-value" id="mddResult">â€”</div>
                    <div class="text-sm text-gray-600" id="mddUnit">g/cmÂ³</div>
                    <div class="text-xs text-gray-500 mt-2" id="mddAlternate"></div>
                </div>
            </div>

            <!-- Proctor Chart -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ“ˆ</span>
                    Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„Ø¯Ù…Ùƒ â€” Compaction Curve
                </h3>
                
                <div class="chart-container">
                    <canvas id="proctorChart" height="400"></canvas>
                </div>
                
                <div class="mt-4 flex items-center gap-4 justify-center flex-wrap">
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-4 rounded-full bg-orange-500"></div>
                        <span class="text-sm text-gray-600">Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„Ø¯Ù…Ùƒ â€” Compaction Curve</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-4 rounded-full bg-green-600"></div>
                        <span class="text-sm text-gray-600" id="correctedCurveLegend" style="display:none;">Ù…Ù†Ø­Ù†Ù‰ Ù…ØµØ­Ø­ â€” Corrected Curve (D4718)</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-4 h-1 bg-red-500"></div>
                        <span class="text-sm text-gray-600">Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„ØªØ´Ø¨Ø¹ 100% â€” Zero Air Voids (S=100%)</span>
                    </div>
                </div>
            </div>

        </div>

        <!-- ============================================= -->
        <!-- D4318 SECTION - Atterberg Limits -->
        <!-- ============================================= -->
        <div id="sectionD4318" class="hidden">
            <!-- Page Title -->
            <div class="section-card p-6 mb-6">
                <div class="flex items-center gap-4">
                    <div class="bg-purple-100 p-4 rounded-full">
                        <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">Ø­Ø¯ÙˆØ¯ Ø£ØªØ±Ø¨Ø±Ø¬ â€” Atterberg Limits</h2>
                        <p class="text-gray-600">ASTM D4318-17e1 | Ø­Ø¯ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© (LL) ÙˆØ­Ø¯ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© (PL) ÙˆØ¯Ù„ÙŠÙ„ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© (PI)</p>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">1</span>
                    Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± â€” Test Settings
                </h3>
                
                <div class="grid md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">Ø±Ù‚Ù… Ø§Ù„Ø¹ÙŠÙ†Ø© (Sample ID)</label>
                        <input type="text" id="d4318_sampleId" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2" placeholder="Ù…Ø«Ø§Ù„: AL-001">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (Test Date)</label>
                        <input type="date" id="d4318_testDate" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-1">Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© (Method)</label>
                        <select id="d4318_method" class="input-field w-full border-2 border-gray-300 rounded-lg px-3 py-2">
                            <option value="A" selected>Method A â€” Multipoint (Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù†Ù‚Ø§Ø·)</option>
                            <option value="B">Method B â€” One-Point (Ù†Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø©)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Variables Glossary for D4318 -->
            <details class="section-card p-6 mb-6">
                <summary class="text-lg font-bold text-gray-800 cursor-pointer flex items-center gap-2">
                    <span class="bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ“–</span>
                    Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„Ù…ØµØ·Ù„Ø­Ø§Øª â€” D4318 Variables Glossary
                </summary>
                <div class="mt-4 grid md:grid-cols-2 gap-4 text-sm">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-700 mb-2">Ù…ØªØºÙŠØ±Ø§Øª Ø­Ø¯ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© â€” Liquid Limit Variables:</h4>
                        <ul class="space-y-2">
                            <li><span class="glossary-term">N</span> â€” Ø¹Ø¯Ø¯ Ø§Ù„Ø¶Ø±Ø¨Ø§Øª (Number of Blows)</li>
                            <li><span class="glossary-term">LL</span> â€” Ø­Ø¯ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© (Liquid Limit) â€” Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ 25 Ø¶Ø±Ø¨Ø©</li>
                            <li><span class="glossary-term">Flow Curve</span> â€” Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© (Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† w Ùˆ log N)</li>
                            <li><span class="glossary-term">Flow Index</span> â€” Ù…ÙŠÙ„ Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© (Slope of Flow Curve)</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-700 mb-2">Ù…ØªØºÙŠØ±Ø§Øª Ø­Ø¯ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© â€” Plastic Limit Variables:</h4>
                        <ul class="space-y-2">
                            <li><span class="glossary-term">PL</span> â€” Ø­Ø¯ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© (Plastic Limit) â€” Ø£Ù‚Ù„ Ù…Ø­ØªÙˆÙ‰ Ù…Ø§Ø¦ÙŠ Ù„Ù„ØªØ´ÙƒÙŠÙ„</li>
                            <li><span class="glossary-term">PI</span> â€” Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© (Plasticity Index) = LL âˆ’ PL</li>
                            <li><span class="glossary-term">3.2 mm</span> â€” Ù‚Ø·Ø± Ø§Ù„Ø®ÙŠØ· Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ (Thread Diameter)</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-700 mb-2">Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ÙˆØ²Ù† â€” Mass Variables:</h4>
                        <ul class="space-y-2">
                            <li><span class="glossary-term">Tare</span> â€” ÙˆØ²Ù† Ø§Ù„Ø¹Ù„Ø¨Ø© Ø§Ù„ÙØ§Ø±ØºØ© (Container Mass)</li>
                            <li><span class="glossary-term">Wet+Tare</span> â€” ÙˆØ²Ù† Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø±Ø·Ø¨Ø© + Ø§Ù„Ø¹Ù„Ø¨Ø©</li>
                            <li><span class="glossary-term">Dry+Tare</span> â€” ÙˆØ²Ù† Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø¬Ø§ÙØ© + Ø§Ù„Ø¹Ù„Ø¨Ø©</li>
                            <li><span class="glossary-term">Water</span> â€” ÙˆØ²Ù† Ø§Ù„Ù…Ø§Ø¡ = (Wet+Tare) âˆ’ (Dry+Tare)</li>
                            <li><span class="glossary-term">Dry Soil</span> â€” ÙˆØ²Ù† Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø¬Ø§ÙØ© = (Dry+Tare) âˆ’ Tare</li>
                        </ul>
                    </div>
                    <div class="bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-bold text-gray-700 mb-2">Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© â€” Key Equations:</h4>
                        <ul class="space-y-2">
                            <li><span class="glossary-term">w%</span> = (Water / Dry Soil) Ã— 100</li>
                            <li><span class="glossary-term">LL</span> = w Ø¹Ù†Ø¯ N = 25 (Ù…Ù† Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„Ø³ÙŠÙˆÙ„Ø©)</li>
                            <li><span class="glossary-term">PL</span> = Ù…ØªÙˆØ³Ø· w Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø®ÙŠØ·</li>
                            <li><span class="glossary-term">PI</span> = LL âˆ’ PL</li>
                        </ul>
                    </div>
                </div>
            </details>

            <!-- Liquid Limit Table -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2 bg-blue-50 p-3 rounded-lg">
                    <span class="bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">2</span>
                    Ø­Ø¯ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© â€” Liquid Limit (Casagrande Method A â€” Multipoint)
                    <span class="text-sm font-normal text-gray-500 mr-2">Ø¬Ù‡Ø§Ø² ÙƒØ§Ø²Ø§Ø¬Ø±Ø§Ù†Ø¯ÙŠ</span>
                </h3>
                
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-gradient-to-r from-blue-700 to-blue-500 text-white">
                                <th class="p-3 text-center border border-blue-800 w-24">
                                    <span class="glossary-term bg-blue-200 text-blue-900">N</span><br>
                                    <span class="text-xs">Ø¹Ø¯Ø¯ Ø§Ù„Ø¶Ø±Ø¨Ø§Øª</span>
                                </th>
                                <th class="p-3 text-center border border-blue-800">
                                    <span class="glossary-term bg-blue-200 text-blue-900">Tare</span><br>
                                    <span class="text-xs">ÙˆØ²Ù† Ø§Ù„Ø¹Ù„Ø¨Ø© (g)</span>
                                </th>
                                <th class="p-3 text-center border border-blue-800">
                                    <span class="glossary-term bg-blue-200 text-blue-900">Wet+Tare</span><br>
                                    <span class="text-xs">Ø±Ø·Ø¨ + Ø¹Ù„Ø¨Ø© (g)</span>
                                </th>
                                <th class="p-3 text-center border border-blue-800">
                                    <span class="glossary-term bg-blue-200 text-blue-900">Dry+Tare</span><br>
                                    <span class="text-xs">Ø¬Ø§Ù + Ø¹Ù„Ø¨Ø© (g)</span>
                                </th>
                                <th class="p-3 text-center border border-blue-800 bg-yellow-500">
                                    <span class="glossary-term bg-yellow-200 text-yellow-900">Water</span><br>
                                    <span class="text-xs">ÙˆØ²Ù† Ø§Ù„Ù…Ø§Ø¡ (g)</span>
                                </th>
                                <th class="p-3 text-center border border-blue-800 bg-yellow-500">
                                    <span class="glossary-term bg-yellow-200 text-yellow-900">Dry Soil</span><br>
                                    <span class="text-xs">ØªØ±Ø¨Ø© Ø¬Ø§ÙØ© (g)</span>
                                </th>
                                <th class="p-3 text-center border border-blue-800 bg-green-500">
                                    <span class="glossary-term bg-green-200 text-green-900">w%</span><br>
                                    <span class="text-xs">Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="d4318_llBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- Plastic Limit Table -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2 bg-purple-50 p-3 rounded-lg">
                    <span class="bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">3</span>
                    Ø­Ø¯ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© â€” Plastic Limit (Rolling 3.2 mm Threads)
                    <span class="text-sm font-normal text-gray-500 mr-2">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù„Ù</span>
                </h3>
                
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-gradient-to-r from-purple-700 to-purple-500 text-white">
                                <th class="p-3 text-center border border-purple-800 w-24">
                                    Roll No.<br>
                                    <span class="text-xs">Ø±Ù‚Ù… Ø§Ù„Ù„ÙØ©</span>
                                </th>
                                <th class="p-3 text-center border border-purple-800">
                                    <span class="glossary-term bg-purple-200 text-purple-900">Tare</span><br>
                                    <span class="text-xs">ÙˆØ²Ù† Ø§Ù„Ø¹Ù„Ø¨Ø© (g)</span>
                                </th>
                                <th class="p-3 text-center border border-purple-800">
                                    <span class="glossary-term bg-purple-200 text-purple-900">Wet+Tare</span><br>
                                    <span class="text-xs">Ø±Ø·Ø¨ + Ø¹Ù„Ø¨Ø© (g)</span>
                                </th>
                                <th class="p-3 text-center border border-purple-800">
                                    <span class="glossary-term bg-purple-200 text-purple-900">Dry+Tare</span><br>
                                    <span class="text-xs">Ø¬Ø§Ù + Ø¹Ù„Ø¨Ø© (g)</span>
                                </th>
                                <th class="p-3 text-center border border-purple-800 bg-yellow-500">
                                    <span class="glossary-term bg-yellow-200 text-yellow-900">Water</span><br>
                                    <span class="text-xs">ÙˆØ²Ù† Ø§Ù„Ù…Ø§Ø¡ (g)</span>
                                </th>
                                <th class="p-3 text-center border border-purple-800 bg-yellow-500">
                                    <span class="glossary-term bg-yellow-200 text-yellow-900">Dry Soil</span><br>
                                    <span class="text-xs">ØªØ±Ø¨Ø© Ø¬Ø§ÙØ© (g)</span>
                                </th>
                                <th class="p-3 text-center border border-purple-800 bg-green-500">
                                    <span class="glossary-term bg-green-200 text-green-900">w%</span><br>
                                    <span class="text-xs">Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="d4318_plBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="flex flex-wrap gap-4 justify-center mb-6">
                <button onclick="calculateD4318()" class="bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white px-8 py-3 rounded-lg font-bold text-lg shadow-lg flex items-center gap-2 transition-all hover:transform hover:-translate-y-1">
                    ğŸ§® Ø§Ø­Ø³Ø¨ LL, PL, PI â€” Calculate
                </button>
                <button onclick="resetD4318()" class="btn-secondary text-white px-8 py-3 rounded-lg font-bold text-lg shadow-lg flex items-center gap-2">
                    ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† â€” Reset
                </button>
                <button onclick="loadD4318Example()" class="bg-gradient-to-r from-pink-500 to-rose-500 text-white px-8 py-3 rounded-lg font-bold text-lg shadow-lg flex items-center gap-2 hover:from-pink-600 hover:to-rose-600 transition-all">
                    ğŸ“ ØªØ­Ù…ÙŠÙ„ Ù…Ø«Ø§Ù„ â€” Load Example
                </button>

            </div>

            <div id="d4318_validationMessages" class="mb-6"></div>

            <!-- Results Cards -->
            <div id="d4318_results" class="hidden mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-emerald-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">âœ“</span>
                    Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© â€” Final Results
                </h3>
                
                <div class="grid md:grid-cols-3 gap-6">
                    <!-- LL Card -->
                    <div class="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-6 rounded-xl shadow-lg text-center">
                        <div class="text-lg font-bold mb-2">
                            <span class="glossary-term bg-blue-200 text-blue-900">LL</span>
                            <span class="block text-sm font-normal opacity-90">Ø­Ø¯ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© â€” Liquid Limit</span>
                        </div>
                        <div class="text-4xl font-bold" id="d4318_LL_val">â€”</div>
                        <div class="text-sm opacity-80">%</div>
                    </div>
                    
                    <!-- PL Card -->
                    <div class="bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-xl shadow-lg text-center">
                        <div class="text-lg font-bold mb-2">
                            <span class="glossary-term bg-purple-200 text-purple-900">PL</span>
                            <span class="block text-sm font-normal opacity-90">Ø­Ø¯ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© â€” Plastic Limit</span>
                        </div>
                        <div class="text-4xl font-bold" id="d4318_PL_val">â€”</div>
                        <div class="text-sm opacity-80">%</div>
                    </div>
                    
                    <!-- PI Card -->
                    <div class="bg-gradient-to-br from-orange-500 to-orange-600 text-white p-6 rounded-xl shadow-lg text-center">
                        <div class="text-lg font-bold mb-2">
                            <span class="glossary-term bg-orange-200 text-orange-900">PI</span>
                            <span class="block text-sm font-normal opacity-90">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© â€” Plasticity Index</span>
                        </div>
                        <div class="text-4xl font-bold" id="d4318_PI_val">â€”</div>
                        <div class="text-sm opacity-80">% (LL âˆ’ PL)</div>
                    </div>
                </div>
                
                <!-- Soil Classification hint -->
                <div class="mt-4 bg-gradient-to-r from-gray-100 to-gray-200 p-4 rounded-lg border border-gray-300">
                    <div class="flex items-center gap-2">
                        <span class="text-2xl">ğŸ“Š</span>
                        <div>
                            <span class="font-bold text-gray-800">ØªØµÙ†ÙŠÙ Ø§Ù„ØªØ±Ø¨Ø© (Soil Classification):</span>
                            <span id="d4318_classification" class="mr-2 font-semibold text-indigo-700">â€”</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Flow Curve Chart -->
            <div id="d4318_chartWrap" class="hidden section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ“ˆ</span>
                    Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© â€” Flow Curve (Casagrande Method)
                </h3>
                
                <div class="chart-container" style="height: 400px;">
                    <canvas id="d4318_chart"></canvas>
                </div>
                
                <div class="mt-4 bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <div class="flex items-center gap-4 flex-wrap justify-center">
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 rounded-full bg-blue-500"></div>
                            <span class="text-sm text-gray-600">Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª â€” Data Points</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-1 bg-blue-500"></div>
                            <span class="text-sm text-gray-600">Ø®Ø· Ø£ÙØ¶Ù„ ØªÙ…Ø«ÙŠÙ„ â€” Best-fit Line</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-4 h-4 rounded-full bg-red-500"></div>
                            <span class="text-sm text-gray-600">LL Ø¹Ù†Ø¯ N=25 Ø¶Ø±Ø¨Ø©</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Classification Tab Link -->
            <div class="section-card p-6 mb-6">
                <div class="flex flex-col items-center gap-4">
                    <div class="text-center">
                        <h3 class="text-lg font-bold text-gray-800 mb-2">ğŸ—ï¸ ØªØµÙ†ÙŠÙ Ø§Ù„ØªØ±Ø¨Ø© â€” Soil Classification</h3>
                        <p class="text-sm text-gray-600">USCS (ASTM D2487) + AASHTO (M 145 / D3282)</p>
                        <p class="text-xs text-gray-500 mt-1">ÙŠØªØ·Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† D6913 (Ø§Ù„ØªØ¯Ø±Ø¬) Ùˆ D4318 (Ø­Ø¯ÙˆØ¯ Ø£ØªØ±Ø¨Ø±Ø¬)</p>
                    </div>
                    <button onclick="switchTab('SoilClass')" class="bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white px-8 py-4 rounded-lg font-bold text-lg shadow-lg flex items-center gap-3 transition-all hover:transform hover:-translate-y-1">
                        <span class="text-2xl">ğŸ“Œ</span>
                        Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„ØªØ¨ÙˆÙŠØ¨ ØªØµÙ†ÙŠÙ Ø§Ù„ØªØ±Ø¨Ø© â€” Go to Classification Tab
                    </button>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- SOIL CLASSIFICATION SECTION (USCS + AASHTO) -->
        <!-- ============================================= -->
        <div id="sectionSoilClass" class="hidden">
            <!-- Page Title -->
            <div class="section-card p-6 mb-6">
                <div class="flex items-center gap-4">
                    <div class="bg-teal-100 p-4 rounded-full">
                        <svg class="w-8 h-8 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-800">ØªØµÙ†ÙŠÙ Ø§Ù„ØªØ±Ø¨Ø© â€” Soil Classification</h2>
                        <p class="text-gray-600">USCS (ASTM D2487) + AASHTO (Selectable: M 145 / ASTM D3282)</p>
                    </div>
                </div>
            </div>

            <!-- AASHTO Reference Selection -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-teal-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">1</span>
                    Ø§Ø®ØªÙŠØ§Ø± Ù…Ø±Ø¬Ø¹ Ø§Ù„ØªØµÙ†ÙŠÙ â€” Classification Reference Selection
                </h3>
                
                <div class="bg-gradient-to-r from-teal-50 to-cyan-50 p-4 rounded-lg mb-4">
                    <label class="block text-sm font-bold text-gray-800 mb-3">
                        Ù…Ø±Ø¬Ø¹ ØªØµÙ†ÙŠÙ AASHTO â€” AASHTO Classification Reference:
                    </label>
                    <div class="flex flex-wrap gap-4">
                        <label class="flex items-center gap-3 bg-white px-4 py-3 rounded-lg border-2 border-gray-200 cursor-pointer hover:border-teal-400 transition-all">
                            <input type="radio" name="aashtoRef" value="M145" checked class="w-5 h-5 text-teal-600">
                            <div>
                                <span class="font-semibold text-gray-800">AASHTO M 145</span>
                                <p class="text-xs text-gray-500">Ø§Ù„Ù…ÙˆØ§ØµÙØ© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ© Ù„ØªØµÙ†ÙŠÙ Ø§Ù„ØªØ±Ø¨Ø© ÙˆØ§Ù„Ø®Ù„Ø·Ø§Øª Ø§Ù„ØªØ±Ø§Ø¨ÙŠØ©</p>
                            </div>
                        </label>
                        <label class="flex items-center gap-3 bg-white px-4 py-3 rounded-lg border-2 border-gray-200 cursor-pointer hover:border-teal-400 transition-all">
                            <input type="radio" name="aashtoRef" value="D3282" class="w-5 h-5 text-teal-600">
                            <div>
                                <span class="font-semibold text-gray-800">ASTM D3282</span>
                                <p class="text-xs text-gray-500">Standard Practice for Classification of Soils (AASHTO System)</p>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <p class="text-sm text-blue-800">
                        <strong>â„¹ï¸ Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> ÙŠØªÙ… Ø­Ø³Ø§Ø¨ ØªØµÙ†ÙŠÙ USCS Ø¯Ø§Ø¦Ù…Ø§Ù‹ Ø·Ø¨Ù‚Ø§Ù‹ Ù„Ù€ ASTM D2487ØŒ Ø¨ÙŠÙ†Ù…Ø§ ÙŠØªÙ… Ø­Ø³Ø§Ø¨ ØªØµÙ†ÙŠÙ AASHTO Ø­Ø³Ø¨ Ø§Ù„Ù…Ø±Ø¬Ø¹ Ø§Ù„Ù…Ø®ØªØ§Ø± Ø£Ø¹Ù„Ø§Ù‡.
                    </p>
                </div>
            </div>

            <!-- Input Data Display Cards -->
            <div class="section-card p-6 mb-6">
                <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                    <span class="bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">2</span>
                    Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‚Ø±ÙˆØ¡Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ â€” Auto-Read Input Data
                </h3>
                
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <!-- Fines % -->
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl border-2 border-blue-200 text-center">
                        <div class="text-sm font-bold text-blue-800 mb-1">% Fines (No.200)</div>
                        <div class="text-xs text-gray-500 mb-2">Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù†Ø§Ø¹Ù…Ø©  â€” Ù…Ù† D6913</div>
                        <div class="text-3xl font-bold text-blue-700" id="sc_fines">â€”</div>
                    </div>
                    
                    <!-- LL -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-xl border-2 border-purple-200 text-center">
                        <div class="text-sm font-bold text-purple-800 mb-1">LL (Liquid Limit)</div>
                        <div class="text-xs text-gray-500 mb-2">Ø­Ø¯ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© â€” Ù…Ù† D4318</div>
                        <div class="text-3xl font-bold text-purple-700" id="sc_LL">â€”</div>
                    </div>
                    
                    <!-- PL -->
                    <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 p-4 rounded-xl border-2 border-indigo-200 text-center">
                        <div class="text-sm font-bold text-indigo-800 mb-1">PL (Plastic Limit)</div>
                        <div class="text-xs text-gray-500 mb-2">Ø­Ø¯ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© â€” Ù…Ù† D4318</div>
                        <div class="text-3xl font-bold text-indigo-700" id="sc_PL">â€”</div>
                    </div>
                    
                    <!-- PI -->
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-4 rounded-xl border-2 border-orange-200 text-center">
                        <div class="text-sm font-bold text-orange-800 mb-1">PI (Plasticity Index)</div>
                        <div class="text-xs text-gray-500 mb-2">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© = LL âˆ’ PL</div>
                        <div class="text-3xl font-bold text-orange-700" id="sc_PI">â€”</div>
                    </div>
                </div>

                <!-- Additional Data Row -->
                <div class="grid md:grid-cols-4 gap-4 mt-4">
                    <div class="bg-gray-50 p-3 rounded-lg border text-center">
                        <div class="text-xs text-gray-600">% Passing No.4</div>
                        <div class="text-lg font-bold text-gray-700" id="sc_passNo4">â€”</div>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg border text-center">
                        <div class="text-xs text-gray-600">% Passing No.10</div>
                        <div class="text-lg font-bold text-gray-700" id="sc_passNo10">â€”</div>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg border text-center">
                        <div class="text-xs text-gray-600">% Passing No.40</div>
                        <div class="text-lg font-bold text-gray-700" id="sc_passNo40">â€”</div>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg border text-center">
                        <div class="text-xs text-gray-600">Cu / Cc</div>
                        <div class="text-lg font-bold text-gray-700" id="sc_CuCc">â€”</div>
                    </div>
                </div>
            </div>

            <!-- Calculate Button -->
            <div class="flex flex-wrap gap-4 justify-center mb-6">
                <button onclick="calculateSoilClassification()" class="bg-gradient-to-r from-teal-600 to-cyan-600 hover:from-teal-700 hover:to-cyan-700 text-white px-8 py-4 rounded-lg font-bold text-lg shadow-lg flex items-center gap-3 transition-all hover:transform hover:-translate-y-1">
                    <span class="text-2xl">ğŸ§®</span>
                    Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ â€” Calculate Classification
                </button>
                <button onclick="resetSoilClassification()" class="btn-secondary text-white px-6 py-4 rounded-lg font-bold text-lg shadow-lg flex items-center gap-2">
                    ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† â€” Reset
                </button>
            </div>

            <div id="soilClassValidation" class="mb-6"></div>

            <!-- Results Section -->
            <div id="soilClassResults" class="hidden">
                <!-- USCS Classification Result -->
                <div class="section-card p-6 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ“‹</span>
                        ØªØµÙ†ÙŠÙ USCS â€” Unified Soil Classification System (ASTM D2487)
                    </h3>
                    
                    <div class="bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-6 rounded-xl shadow-lg text-center mb-4">
                        <div class="text-lg font-bold mb-2 opacity-90">Ø±Ù…Ø² USCS â€” USCS Symbol</div>
                        <div class="text-5xl font-bold mb-2" id="sc_uscs_symbol">â€”</div>
                        <div class="text-xl" id="sc_uscs_desc">â€”</div>
                        <div class="text-sm mt-2 opacity-80" id="sc_uscs_name_ar">â€”</div>
                    </div>

                    <div class="grid md:grid-cols-3 gap-4">
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 text-center">
                            <div class="text-sm text-gray-600 mb-1">Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø©</div>
                            <div class="font-bold text-blue-700" id="sc_uscs_type">â€”</div>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 text-center">
                            <div class="text-sm text-gray-600 mb-1">Ù…ÙˆÙ‚Ø¹ A-Line</div>
                            <div class="font-bold text-blue-700" id="sc_uscs_aline">â€”</div>
                        </div>
                        <div class="bg-blue-50 p-4 rounded-lg border border-blue-200 text-center">
                            <div class="text-sm text-gray-600 mb-1">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</div>
                            <div class="font-bold text-blue-700" id="sc_uscs_notes">â€”</div>
                        </div>
                    </div>
                </div>

                <!-- AASHTO Classification Result -->
                <div class="section-card p-6 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="bg-green-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ“‹</span>
                        ØªØµÙ†ÙŠÙ AASHTO â€” <span id="aashtoRefDisplay">AASHTO M 145</span>
                    </h3>
                    
                    <div class="bg-gradient-to-r from-green-500 to-emerald-600 text-white p-6 rounded-xl shadow-lg text-center mb-4">
                        <div class="text-lg font-bold mb-2 opacity-90">Ù…Ø¬Ù…ÙˆØ¹Ø© AASHTO â€” AASHTO Group</div>
                        <div class="text-5xl font-bold mb-2" id="sc_aashto_group">â€”</div>
                        <div class="text-xl" id="sc_aashto_desc">â€”</div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-green-50 p-4 rounded-lg border border-green-200 text-center">
                            <div class="text-sm text-gray-600 mb-1">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© â€” Group Index (GI)</div>
                            <div class="text-3xl font-bold text-green-700" id="sc_aashto_gi">â€”</div>
                            <div class="text-xs text-gray-500 mt-1">GI = (F-35)[0.2+0.005(LL-40)] + 0.01(F-15)(PI-10)</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg border border-green-200 text-center">
                            <div class="text-sm text-gray-600 mb-1">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØ±Ø¨Ø© â€” Soil Evaluation</div>
                            <div class="text-xl font-bold text-green-700" id="sc_aashto_eval">â€”</div>
                            <div class="text-xs text-gray-500 mt-1" id="sc_aashto_eval_desc">â€”</div>
                        </div>
                    </div>
                </div>

                <!-- AASHTO Groups Reference Table -->
                <details class="section-card p-6 mb-6">
                    <summary class="text-lg font-bold text-gray-800 cursor-pointer flex items-center gap-2">
                        <span class="text-xl">ğŸ“–</span>
                        Ø¬Ø¯ÙˆÙ„ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª AASHTO â€” AASHTO Classification Groups
                    </summary>
                    <div class="mt-4 overflow-x-auto">
                        <table class="w-full text-sm border-collapse">
                            <thead>
                                <tr class="bg-green-600 text-white">
                                    <th class="p-2 border" rowspan="2">Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø¹Ø§Ù…</th>
                                    <th class="p-2 border" colspan="7">Ù…ÙˆØ§Ø¯ Ø­Ø¨ÙŠØ¨ÙŠØ© (35% Ø£Ùˆ Ø£Ù‚Ù„ Ù…Ø§Ø± Ù…Ù† No.200)</th>
                                    <th class="p-2 border" colspan="4">Ù…ÙˆØ§Ø¯ Ø·Ù…ÙŠ-Ø·ÙŠÙ† (Ø£ÙƒØ«Ø± Ù…Ù† 35% Ù…Ø§Ø± Ù…Ù† No.200)</th>
                                </tr>
                                <tr class="bg-green-500 text-white">
                                    <th class="p-2 border">A-1-a</th>
                                    <th class="p-2 border">A-1-b</th>
                                    <th class="p-2 border">A-3</th>
                                    <th class="p-2 border">A-2-4</th>
                                    <th class="p-2 border">A-2-5</th>
                                    <th class="p-2 border">A-2-6</th>
                                    <th class="p-2 border">A-2-7</th>
                                    <th class="p-2 border">A-4</th>
                                    <th class="p-2 border">A-5</th>
                                    <th class="p-2 border">A-6</th>
                                    <th class="p-2 border">A-7</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="bg-gray-50">
                                    <td class="p-2 border font-semibold">% Ù…Ø§Ø± No.10</td>
                                    <td class="p-2 border text-center">â‰¤50</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                </tr>
                                <tr>
                                    <td class="p-2 border font-semibold">% Ù…Ø§Ø± No.40</td>
                                    <td class="p-2 border text-center">â‰¤30</td>
                                    <td class="p-2 border text-center">â‰¤50</td>
                                    <td class="p-2 border text-center">>50</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                </tr>
                                <tr class="bg-gray-50">
                                    <td class="p-2 border font-semibold">% Ù…Ø§Ø± No.200</td>
                                    <td class="p-2 border text-center">â‰¤15</td>
                                    <td class="p-2 border text-center">â‰¤25</td>
                                    <td class="p-2 border text-center">â‰¤10</td>
                                    <td class="p-2 border text-center">â‰¤35</td>
                                    <td class="p-2 border text-center">â‰¤35</td>
                                    <td class="p-2 border text-center">â‰¤35</td>
                                    <td class="p-2 border text-center">â‰¤35</td>
                                    <td class="p-2 border text-center">>35</td>
                                    <td class="p-2 border text-center">>35</td>
                                    <td class="p-2 border text-center">>35</td>
                                    <td class="p-2 border text-center">>35</td>
                                </tr>
                                <tr>
                                    <td class="p-2 border font-semibold">LL (Ø­Ø¯ Ø§Ù„Ø³ÙŠÙˆÙ„Ø©)</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">â€”</td>
                                    <td class="p-2 border text-center">NP</td>
                                    <td class="p-2 border text-center">â‰¤40</td>
                                    <td class="p-2 border text-center">>40</td>
                                    <td class="p-2 border text-center">â‰¤40</td>
                                    <td class="p-2 border text-center">>40</td>
                                    <td class="p-2 border text-center">â‰¤40</td>
                                    <td class="p-2 border text-center">>40</td>
                                    <td class="p-2 border text-center">â‰¤40</td>
                                    <td class="p-2 border text-center">>40</td>
                                </tr>
                                <tr class="bg-gray-50">
                                    <td class="p-2 border font-semibold">PI (Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©)</td>
                                    <td class="p-2 border text-center">â‰¤6</td>
                                    <td class="p-2 border text-center">â‰¤6</td>
                                    <td class="p-2 border text-center">NP</td>
                                    <td class="p-2 border text-center">â‰¤10</td>
                                    <td class="p-2 border text-center">â‰¤10</td>
                                    <td class="p-2 border text-center">>10</td>
                                    <td class="p-2 border text-center">>10</td>
                                    <td class="p-2 border text-center">â‰¤10</td>
                                    <td class="p-2 border text-center">â‰¤10</td>
                                    <td class="p-2 border text-center">>10</td>
                                    <td class="p-2 border text-center">>10</td>
                                </tr>
                                <tr class="bg-yellow-50">
                                    <td class="p-2 border font-semibold">Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ©</td>
                                    <td class="p-2 border text-center text-xs">Ø­Ø¬Ø± Ù…ÙƒØ³Ø±</td>
                                    <td class="p-2 border text-center text-xs">Ø­ØµÙ‰ ÙˆØ±Ù…Ù„</td>
                                    <td class="p-2 border text-center text-xs">Ø±Ù…Ù„ Ù†Ø§Ø¹Ù…</td>
                                    <td class="p-2 border text-center text-xs" colspan="4">Ø­ØµÙ‰ ÙˆØ±Ù…Ù„ Ø·Ù…ÙŠÙŠ/Ø·ÙŠÙ†ÙŠ</td>
                                    <td class="p-2 border text-center text-xs" colspan="2">ØªØ±Ø¨Ø© Ø·Ù…ÙŠÙŠØ©</td>
                                    <td class="p-2 border text-center text-xs" colspan="2">ØªØ±Ø¨Ø© Ø·ÙŠÙ†ÙŠØ©</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </details>

                <!-- Proctor Data Display -->
                <div id="sc_proctorData" class="hidden section-card p-6 mb-6">
                    <h3 class="text-lg font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <span class="bg-orange-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ”¨</span>
                        Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ù…Ùƒ â€” Compaction Data (D1557) â€” Ù„Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø·
                    </h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="bg-orange-50 p-4 rounded-lg border border-orange-200 text-center">
                            <div class="text-sm text-gray-600 mb-1">OMC â€” Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ Ø§Ù„Ø£Ù…Ø«Ù„</div>
                            <div class="text-2xl font-bold text-orange-700" id="sc_OMC">â€”</div>
                            <div class="text-sm text-gray-500">%</div>
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg border border-orange-200 text-center">
                            <div class="text-sm text-gray-600 mb-1">MDD â€” Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© Ø§Ù„Ù‚ØµÙˆÙ‰</div>
                            <div class="text-2xl font-bold text-orange-700" id="sc_MDD">â€”</div>
                            <div class="text-sm text-gray-500" id="sc_MDD_unit">g/cmÂ³</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ============================================= -->
        <!-- USCS CLASSIFICATION SECTION -->
        <div id="uscsSection" class="hidden section-card p-6 mb-6">
            <div class="flex items-center gap-4 mb-6">
                <div class="bg-teal-100 p-4 rounded-full">
                    <svg class="w-8 h-8 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                    </svg>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">ØªØµÙ†ÙŠÙ Ø§Ù„ØªØ±Ø¨Ø© â€” ASTM D2487 (USCS)</h2>
                    <p class="text-gray-600">Unified Soil Classification System | Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ù…ÙˆØ­Ø¯ Ù„Ù„ØªØ±Ø¨Ø©</p>
                </div>
            </div>

            <!-- Main Classification Result -->
            <div class="bg-gradient-to-r from-teal-500 to-cyan-500 text-white p-8 rounded-xl shadow-lg text-center mb-6">
                <div class="text-lg font-bold mb-2 opacity-90">Ø±Ù…Ø² Ø§Ù„ØªØµÙ†ÙŠÙ â€” Classification Symbol</div>
                <div class="text-6xl font-bold mb-4" id="uscs_symbol">â€”</div>
                <div class="text-xl" id="uscs_description">â€”</div>
                <div class="mt-4 text-sm opacity-80" id="uscs_name_ar">â€”</div>
            </div>

            <!-- Classification Details -->
            <div class="grid md:grid-cols-2 gap-6 mb-6">
                <!-- Soil Type Card -->
                <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-xl border-2 border-blue-200">
                    <h4 class="text-lg font-bold text-blue-800 mb-4 flex items-center gap-2">
                        <span class="bg-blue-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ”ï¸</span>
                        Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø© â€” Soil Type
                    </h4>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center p-3 bg-white rounded-lg">
                            <span class="font-semibold text-gray-700">Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ:</span>
                            <span class="font-bold text-blue-700" id="uscs_mainType">â€”</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-white rounded-lg">
                            <span class="font-semibold text-gray-700">Ù†Ø³Ø¨Ø© Ø§Ù„ØºØ±Ø§Ù…Ø§Øª (Fines):</span>
                            <span class="font-bold text-blue-700" id="uscs_finesPercent">â€”</span>
                        </div>
                        <div class="flex justify-between items-center p-3 bg-white rounded-lg">
                            <span class="font-semibold text-gray-700">Ù…ÙˆÙ‚Ø¹ A-Line:</span>
                            <span class="font-bold text-blue-700" id="uscs_aLinePosition">â€”</span>
                        </div>
                    </div>
                </div>

                <!-- Input Values Card -->
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-xl border-2 border-purple-200">
                    <h4 class="text-lg font-bold text-purple-800 mb-4 flex items-center gap-2">
                        <span class="bg-purple-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ“Š</span>
                        Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© â€” Input Values
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="grid grid-cols-2 gap-2">
                            <div class="p-2 bg-white rounded-lg">
                                <span class="text-gray-600">% Passing No.4:</span>
                                <span class="font-bold text-purple-700 block" id="uscs_passNo4">â€”</span>
                            </div>
                            <div class="p-2 bg-white rounded-lg">
                                <span class="text-gray-600">% Passing No.200:</span>
                                <span class="font-bold text-purple-700 block" id="uscs_passNo200">â€”</span>
                            </div>
                            <div class="p-2 bg-white rounded-lg">
                                <span class="text-gray-600">Cu:</span>
                                <span class="font-bold text-purple-700 block" id="uscs_Cu">â€”</span>
                            </div>
                            <div class="p-2 bg-white rounded-lg">
                                <span class="text-gray-600">Cc:</span>
                                <span class="font-bold text-purple-700 block" id="uscs_Cc">â€”</span>
                            </div>
                            <div class="p-2 bg-white rounded-lg">
                                <span class="text-gray-600">LL:</span>
                                <span class="font-bold text-purple-700 block" id="uscs_LL">â€”</span>
                            </div>
                            <div class="p-2 bg-white rounded-lg">
                                <span class="text-gray-600">PL:</span>
                                <span class="font-bold text-purple-700 block" id="uscs_PL">â€”</span>
                            </div>
                            <div class="p-2 bg-white rounded-lg col-span-2">
                                <span class="text-gray-600">PI:</span>
                                <span class="font-bold text-purple-700 block" id="uscs_PI">â€”</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Proctor Data (Optional Display) -->
            <div id="uscs_proctorData" class="hidden bg-gradient-to-br from-orange-50 to-amber-50 p-6 rounded-xl border-2 border-orange-200 mb-6">
                <h4 class="text-lg font-bold text-orange-800 mb-4 flex items-center gap-2">
                    <span class="bg-orange-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">ğŸ”¨</span>
                    Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ù…Ùƒ (Ù„Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø·) â€” Compaction Data (D1557)
                </h4>
                <div class="grid grid-cols-2 gap-4">
                    <div class="p-3 bg-white rounded-lg text-center">
                        <span class="text-gray-600 block text-sm">OMC</span>
                        <span class="font-bold text-orange-700 text-xl" id="uscs_OMC">â€”</span>
                        <span class="text-gray-500 text-sm">%</span>
                    </div>
                    <div class="p-3 bg-white rounded-lg text-center">
                        <span class="text-gray-600 block text-sm">MDD</span>
                        <span class="font-bold text-orange-700 text-xl" id="uscs_MDD">â€”</span>
                        <span class="text-gray-500 text-sm" id="uscs_MDD_unit">g/cmÂ³</span>
                    </div>
                </div>
            </div>

            <!-- Classification Logic Explanation -->
            <details class="bg-gray-50 p-4 rounded-xl border border-gray-200 mb-6">
                <summary class="font-bold text-gray-800 cursor-pointer flex items-center gap-2">
                    <span class="text-xl">ğŸ“–</span>
                    Ø´Ø±Ø­ Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØµÙ†ÙŠÙ â€” Classification Logic (ASTM D2487)
                </summary>
                <div class="mt-4 space-y-4 text-sm">
                    <div class="bg-white p-4 rounded-lg border">
                        <h5 class="font-bold text-blue-700 mb-2">1ï¸âƒ£ ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ:</h5>
                        <ul class="list-disc list-inside space-y-1 text-gray-700">
                            <li>Ø¥Ø°Ø§ ÙƒØ§Ù† <code class="bg-gray-100 px-1 rounded">%Passing No.200 < 50%</code> â†’ Ø§Ù„ØªØ±Ø¨Ø© <strong>Ø®Ø´Ù†Ø© (Coarse-grained)</strong></li>
                            <li>Ø¥Ø°Ø§ ÙƒØ§Ù† <code class="bg-gray-100 px-1 rounded">%Passing No.200 â‰¥ 50%</code> â†’ Ø§Ù„ØªØ±Ø¨Ø© <strong>Ù†Ø§Ø¹Ù…Ø© (Fine-grained)</strong></li>
                        </ul>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <h5 class="font-bold text-green-700 mb-2">2ï¸âƒ£ Ù„Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø®Ø´Ù†Ø© â€” ØªØ­Ø¯ÙŠØ¯ Ø­ØµÙ‰ Ø£Ù… Ø±Ù…Ù„:</h5>
                        <ul class="list-disc list-inside space-y-1 text-gray-700">
                            <li>Ø¥Ø°Ø§ ÙƒØ§Ù† <code class="bg-gray-100 px-1 rounded">%Passing No.4 < 50%</code> â†’ <strong>Ø­ØµÙ‰ (Gravel - G)</strong></li>
                            <li>Ø¥Ø°Ø§ ÙƒØ§Ù† <code class="bg-gray-100 px-1 rounded">%Passing No.4 â‰¥ 50%</code> â†’ <strong>Ø±Ù…Ù„ (Sand - S)</strong></li>
                        </ul>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <h5 class="font-bold text-orange-700 mb-2">3ï¸âƒ£ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªØ¯Ø±Ø¬ Ø§Ù„Ø¬ÙŠØ¯ (Well-graded):</h5>
                        <ul class="list-disc list-inside space-y-1 text-gray-700">
                            <li>Ù„Ù„Ø±Ù…Ø§Ù„: <code class="bg-gray-100 px-1 rounded">Cu â‰¥ 6</code> Ùˆ <code class="bg-gray-100 px-1 rounded">1 â‰¤ Cc â‰¤ 3</code></li>
                            <li>Ù„Ù„Ø­ØµÙ‰: <code class="bg-gray-100 px-1 rounded">Cu â‰¥ 4</code> Ùˆ <code class="bg-gray-100 px-1 rounded">1 â‰¤ Cc â‰¤ 3</code></li>
                        </ul>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <h5 class="font-bold text-purple-700 mb-2">4ï¸âƒ£ Ø®Ø· A-Line (Ù„Ù„ØªÙ…ÙŠÙŠØ² Ø¨ÙŠÙ† Ø§Ù„Ø·ÙŠÙ† ÙˆØ§Ù„Ø·Ù…ÙŠ):</h5>
                        <ul class="list-disc list-inside space-y-1 text-gray-700">
                            <li>Ù…Ø¹Ø§Ø¯Ù„Ø© A-Line: <code class="bg-gray-100 px-1 rounded">PI_A = 0.73 Ã— (LL - 20)</code></li>
                            <li>Ø¥Ø°Ø§ ÙƒØ§Ù† <code class="bg-gray-100 px-1 rounded">PI > PI_A</code> â†’ <strong>Ø·ÙŠÙ† (Clay - C)</strong></li>
                            <li>Ø¥Ø°Ø§ ÙƒØ§Ù† <code class="bg-gray-100 px-1 rounded">PI < PI_A</code> â†’ <strong>Ø·Ù…ÙŠ (Silt - M)</strong></li>
                        </ul>
                    </div>
                    <div class="bg-white p-4 rounded-lg border">
                        <h5 class="font-bold text-red-700 mb-2">5ï¸âƒ£ Ù†Ø³Ø¨Ø© Ø§Ù„ØºØ±Ø§Ù…Ø§Øª (Fines):</h5>
                        <ul class="list-disc list-inside space-y-1 text-gray-700">
                            <li><code class="bg-gray-100 px-1 rounded">Fines â‰¤ 5%</code> â†’ ØªØ±Ø¨Ø© Ù†Ø¸ÙŠÙØ© (GW, GP, SW, SP)</li>
                            <li><code class="bg-gray-100 px-1 rounded">5% < Fines < 12%</code> â†’ Ø±Ù…Ø² Ø«Ù†Ø§Ø¦ÙŠ (GW-GC, SW-SM, etc.)</li>
                            <li><code class="bg-gray-100 px-1 rounded">Fines â‰¥ 12%</code> â†’ ØªØ±Ø¨Ø© Ø¨ØºØ±Ø§Ù…Ø§Øª (GM, GC, SM, SC)</li>
                        </ul>
                    </div>
                </div>
            </details>

            <!-- USCS Symbols Reference Table -->
            <details class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                <summary class="font-bold text-gray-800 cursor-pointer flex items-center gap-2">
                    <span class="text-xl">ğŸ“‹</span>
                    Ø¬Ø¯ÙˆÙ„ Ø±Ù…ÙˆØ² USCS â€” Classification Symbols Reference
                </summary>
                <div class="mt-4 overflow-x-auto">
                    <table class="w-full text-sm border-collapse">
                        <thead>
                            <tr class="bg-teal-600 text-white">
                                <th class="p-2 border">Ø§Ù„Ø±Ù…Ø²</th>
                                <th class="p-2 border">Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</th>
                                <th class="p-2 border">Ø§Ù„Ø§Ø³Ù… Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠ</th>
                                <th class="p-2 border">Ø§Ù„ÙˆØµÙ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="bg-blue-50"><td class="p-2 border font-bold text-center">GW</td><td class="p-2 border">Well-graded Gravel</td><td class="p-2 border">Ø­ØµÙ‰ Ø¬ÙŠØ¯ Ø§Ù„ØªØ¯Ø±Ø¬</td><td class="p-2 border">Cuâ‰¥4, 1â‰¤Ccâ‰¤3, Finesâ‰¤5%</td></tr>
                            <tr class="bg-white"><td class="p-2 border font-bold text-center">GP</td><td class="p-2 border">Poorly-graded Gravel</td><td class="p-2 border">Ø­ØµÙ‰ Ø¶Ø¹ÙŠÙ Ø§Ù„ØªØ¯Ø±Ø¬</td><td class="p-2 border">Ù„Ø§ ÙŠØ­Ù‚Ù‚ Ù…Ø¹Ø§ÙŠÙŠØ± GW, Finesâ‰¤5%</td></tr>
                            <tr class="bg-blue-50"><td class="p-2 border font-bold text-center">GM</td><td class="p-2 border">Silty Gravel</td><td class="p-2 border">Ø­ØµÙ‰ Ø·Ù…ÙŠÙŠ</td><td class="p-2 border">Finesâ‰¥12%, ØªØ­Øª A-line</td></tr>
                            <tr class="bg-white"><td class="p-2 border font-bold text-center">GC</td><td class="p-2 border">Clayey Gravel</td><td class="p-2 border">Ø­ØµÙ‰ Ø·ÙŠÙ†ÙŠ</td><td class="p-2 border">Finesâ‰¥12%, ÙÙˆÙ‚ A-line</td></tr>
                            <tr class="bg-yellow-50"><td class="p-2 border font-bold text-center">SW</td><td class="p-2 border">Well-graded Sand</td><td class="p-2 border">Ø±Ù…Ù„ Ø¬ÙŠØ¯ Ø§Ù„ØªØ¯Ø±Ø¬</td><td class="p-2 border">Cuâ‰¥6, 1â‰¤Ccâ‰¤3, Finesâ‰¤5%</td></tr>
                            <tr class="bg-white"><td class="p-2 border font-bold text-center">SP</td><td class="p-2 border">Poorly-graded Sand</td><td class="p-2 border">Ø±Ù…Ù„ Ø¶Ø¹ÙŠÙ Ø§Ù„ØªØ¯Ø±Ø¬</td><td class="p-2 border">Ù„Ø§ ÙŠØ­Ù‚Ù‚ Ù…Ø¹Ø§ÙŠÙŠØ± SW, Finesâ‰¤5%</td></tr>
                            <tr class="bg-yellow-50"><td class="p-2 border font-bold text-center">SM</td><td class="p-2 border">Silty Sand</td><td class="p-2 border">Ø±Ù…Ù„ Ø·Ù…ÙŠÙŠ</td><td class="p-2 border">Finesâ‰¥12%, ØªØ­Øª A-line</td></tr>
                            <tr class="bg-white"><td class="p-2 border font-bold text-center">SC</td><td class="p-2 border">Clayey Sand</td><td class="p-2 border">Ø±Ù…Ù„ Ø·ÙŠÙ†ÙŠ</td><td class="p-2 border">Finesâ‰¥12%, ÙÙˆÙ‚ A-line</td></tr>
                            <tr class="bg-purple-50"><td class="p-2 border font-bold text-center">CL</td><td class="p-2 border">Low Plasticity Clay</td><td class="p-2 border">Ø·ÙŠÙ† Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©</td><td class="p-2 border">LL<50, ÙÙˆÙ‚ A-line</td></tr>
                            <tr class="bg-white"><td class="p-2 border font-bold text-center">CH</td><td class="p-2 border">High Plasticity Clay</td><td class="p-2 border">Ø·ÙŠÙ† Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©</td><td class="p-2 border">LLâ‰¥50, ÙÙˆÙ‚ A-line</td></tr>
                            <tr class="bg-purple-50"><td class="p-2 border font-bold text-center">ML</td><td class="p-2 border">Low Plasticity Silt</td><td class="p-2 border">Ø·Ù…ÙŠ Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©</td><td class="p-2 border">LL<50, ØªØ­Øª A-line</td></tr>
                            <tr class="bg-white"><td class="p-2 border font-bold text-center">MH</td><td class="p-2 border">High Plasticity Silt</td><td class="p-2 border">Ø·Ù…ÙŠ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©</td><td class="p-2 border">LLâ‰¥50, ØªØ­Øª A-line</td></tr>
                            <tr class="bg-green-50"><td class="p-2 border font-bold text-center">CL-ML</td><td class="p-2 border">Silty Clay</td><td class="p-2 border">Ø·ÙŠÙ† Ø·Ù…ÙŠÙŠ</td><td class="p-2 border">Ù…Ù†Ø·Ù‚Ø© Ø§Ù†ØªÙ‚Ø§Ù„ÙŠØ© Ù‚Ø±Ø¨ A-line</td></tr>
                        </tbody>
                    </table>
                </div>
            </details>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6">
        <div class="container mx-auto px-4 text-center">
            <p class="text-gray-300 font-semibold">ğŸ”¬ Ù…Ù†ØµØ© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ù…Ù„ÙŠØ© Ù„Ù„ØªØ±Ø¨Ø©</p>
            <p class="text-gray-400 text-sm">Soil Laboratory Testing Platform</p>
            <p class="text-gray-400 text-sm mt-2">ASTM D6913, D4318, D2487, D3282 & D1557 | AASHTO M 145</p>
            <p class="text-gray-500 text-sm mt-1">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙˆÙÙ‚Ù‹Ø§ Ù„Ù„Ù…ÙˆØ§ØµÙØ§Øª Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ© Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠØ© | Unified Soil Classification System (USCS)</p>
            <div class="mt-4 pt-4 border-t border-gray-700">
                <p class="text-gray-400 text-sm">ØªÙ… ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ù†ØµØ©: <span class="text-blue-500 font-semibold">Ù…. Ù…Ø­Ù…Ø¯ Ø§Ù„Ù‚ØµØ¨ÙŠ</span></p>
            </div>
        </div>
    </footer>

    <script>
        // =============================================
        // TAB SWITCHING
        // =============================================
        let currentTab = 'D6913';

        function switchTab(tab) {
            currentTab = tab;
            
            // Update tab buttons
            document.getElementById('tabD6913').className = tab === 'D6913' ? 
                'tab-active tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap' :
                'tab-inactive tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap';
            document.getElementById('tabD4318').className = tab === 'D4318' ? 
                'tab-active tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap' :
                'tab-inactive tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap';
            document.getElementById('tabSoilClass').className = tab === 'SoilClass' ? 
                'tab-active tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap' :
                'tab-inactive tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap';
            document.getElementById('tabD1557').className = tab === 'D1557' ? 
                'tab-active tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap' :
                'tab-inactive tab-clickable px-4 py-2 rounded-lg font-semibold whitespace-nowrap';
            
            // Show/hide sections
            document.getElementById('sectionD6913').classList.toggle('hidden', tab !== 'D6913');
            document.getElementById('sectionD4318').classList.toggle('hidden', tab !== 'D4318');
            document.getElementById('sectionSoilClass').classList.toggle('hidden', tab !== 'SoilClass');
            document.getElementById('sectionD1557').classList.toggle('hidden', tab !== 'D1557');
            
            // When switching to SoilClass, auto-read data
            if (tab === 'SoilClass') {
                autoReadDataForClassification();
            }
        }

        // =============================================
        // D6913 SIEVE DATA DEFINITIONS
        // =============================================
        const ALL_SIEVES = [
            { name: '3 in', opening: 75 },
            { name: '2 in', opening: 50 },
            { name: '1.5 in', opening: 37.5 },
            { name: '1 in', opening: 25 },
            { name: '3/4 in', opening: 19 },
            { name: '3/8 in', opening: 9.5 },
            { name: 'No.4', opening: 4.75 },
            { name: 'No.10', opening: 2.0 },
            { name: 'No.20', opening: 0.85 },
            { name: 'No.40', opening: 0.425 },
            { name: 'No.60', opening: 0.25 },
            { name: 'No.100', opening: 0.15 },
            { name: 'No.140', opening: 0.106 },
            { name: 'No.200', opening: 0.075 },
            { name: 'Pan', opening: 0 }
        ];

        // D6913 State
        let currentMethod = 'single';
        let currentSeparator = 4.75;
        let gradationChart = null;
        let results = { singleSet: [], coarser: [], finer: [], final: [], CSCF: 0, SMd: 0 };

        // D1557 State
        let proctorChart = null;
        let proctorResults = { points: [], OMC: 0, MDD: 0 };

        // =============================================
        // INITIALIZATION
        // =============================================
        document.addEventListener('DOMContentLoaded', () => {
            // D6913 Init
            initializeTables();
            initializeGradationChart();
            document.getElementById('testDate').valueAsDate = new Date();
            updateSeparatorDisplay();
            
            // D1557 Init
            document.getElementById('proctor_testDate').valueAsDate = new Date();
            initializeProctorChart();
            
            // D4318 Init
            document.getElementById('d4318_testDate').valueAsDate = new Date();
            initD4318Tables();
        });

        // =============================================
        // D6913 FUNCTIONS
        // =============================================
        function getCoarseSieves() {
            return ALL_SIEVES.filter(s => s.opening >= currentSeparator);
        }

        function getFineSieves() {
            return ALL_SIEVES.filter(s => s.opening <= currentSeparator);
        }

        function getSeparatorSieve() {
            return ALL_SIEVES.find(s => s.opening === currentSeparator);
        }

        function getSeparatorName() {
            const sep = getSeparatorSieve();
            return sep ? `${sep.name} (${sep.opening} mm)` : 'Unknown';
        }

        function initializeTables() {
            initializeSingleSetTable();
            initializeCompositeTables();
            updateFinalTable();
        }

        function initializeSingleSetTable() {
            const singleBody = document.getElementById('singleSetTableBody');
            singleBody.innerHTML = ALL_SIEVES.map((sieve, idx) => `
                <tr class="${idx % 2 === 0 ? 'bg-gray-50' : 'bg-white'}">
                    <td class="p-2 text-center border border-gray-300 font-semibold">${sieve.name}</td>
                    <td class="p-2 text-center border border-gray-300 text-gray-600">${sieve.opening}</td>
                    <td class="p-2 text-center border border-gray-300">
                        <input type="number" step="0.01" min="0" id="single_cmrn_${idx}" class="input-field w-full border border-gray-300 rounded px-2 py-1" placeholder="0.00">
                    </td>
                    <td class="p-2 text-center border border-gray-300 result-cell font-bold" id="single_ppn_${idx}">â€”</td>
                </tr>
            `).join('');
        }

        function initializeCompositeTables() {
            const coarseSieves = getCoarseSieves();
            const fineSieves = getFineSieves();

            document.getElementById('coarserTableTitle').innerHTML = `
                <span class="bg-blue-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">3</span>
                Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø®Ø´Ù† (CP) â€” Coarser Portion (3 in â†’ ${getSeparatorSieve().name})
            `;
            document.getElementById('finerTableTitle').innerHTML = `
                <span class="bg-teal-600 text-white w-8 h-8 rounded-full flex items-center justify-center text-sm">4</span>
                Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù†Ø§Ø¹Ù… (SubS) â€” Finer Subspecimen (${getSeparatorSieve().name} â†’ No.200)
            `;

            const coarserBody = document.getElementById('coarserTableBody');
            coarserBody.innerHTML = coarseSieves.map((sieve, idx) => {
                const isSeparator = sieve.opening === currentSeparator;
                return `
                <tr class="${idx % 2 === 0 ? 'bg-gray-50' : 'bg-white'} ${isSeparator ? 'separator-highlight' : ''}">
                    <td class="p-2 text-center border border-gray-300 font-semibold">
                        ${isSeparator ? '<span class="separator-badge">Ù…Ù†Ø®Ù„ Ø§Ù„ÙØµÙ„</span>' : ''}${sieve.name}
                    </td>
                    <td class="p-2 text-center border border-gray-300 text-gray-600">${sieve.opening}</td>
                    <td class="p-2 text-center border border-gray-300">
                        <input type="number" step="0.01" min="0" id="coarse_cmrn_${idx}" class="input-field w-full border border-gray-300 rounded px-2 py-1" placeholder="0.00">
                    </td>
                    <td class="p-2 text-center border border-gray-300 result-cell font-bold" id="coarse_ppn_${idx}">â€”</td>
                </tr>
            `}).join('');

            const finerBody = document.getElementById('finerTableBody');
            finerBody.innerHTML = fineSieves.map((sieve, idx) => {
                const isSeparator = sieve.opening === currentSeparator;
                return `
                <tr class="${idx % 2 === 0 ? 'bg-gray-50' : 'bg-white'} ${isSeparator ? 'separator-highlight' : ''}">
                    <td class="p-2 text-center border border-gray-300 font-semibold">
                        ${isSeparator ? '<span class="separator-badge">Ù…Ù†Ø®Ù„ Ø§Ù„ÙØµÙ„</span>' : ''}${sieve.name}
                    </td>
                    <td class="p-2 text-center border border-gray-300 text-gray-600">${sieve.opening}</td>
                    <td class="p-2 text-center border border-gray-300">
                        <input type="number" step="0.01" min="0" id="fine_cmrn_${idx}" class="input-field w-full border border-gray-300 rounded px-2 py-1" placeholder="0.00">
                    </td>
                    <td class="p-2 text-center border border-gray-300 bg-yellow-50 font-semibold" id="fine_fppn_${idx}">â€”</td>
                    <td class="p-2 text-center border border-gray-300 result-cell font-bold" id="fine_ppn_${idx}">â€”</td>
                </tr>
            `}).join('');

            updateLabelsForSeparator();
        }

        function updateLabelsForSeparator() {
            const sepName = getSeparatorSieve().name;
            document.getElementById('cpMdLabel').textContent = `Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø¬Ø§Ù Ù„Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø®Ø´Ù† (Ø§Ù„Ù…Ø­Ø¬ÙˆØ² Ø¹Ù„Ù‰ ${sepName})`;
            document.getElementById('fpMmLabel').textContent = `Ø§Ù„ÙˆØ²Ù† Ø§Ù„Ø±Ø·Ø¨ Ù„Ù„Ø¬Ø²Ø¡ Ø§Ù„Ù†Ø§Ø¹Ù… (Ø§Ù„Ù…Ø§Ø± Ù…Ù† ${sepName})`;
            document.getElementById('cscfDescription').textContent = `= % Passing Ø¹Ù†Ø¯ ${sepName} Ù…Ù† Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø®Ø´Ù† (Ø¨Ø¯Ù‚Ø© 0.1%)`;
        }

        function updateFinalTable() {
            const finalBody = document.getElementById('finalTableBody');
            const displaySieves = ALL_SIEVES.filter(s => s.name !== 'Pan');
            finalBody.innerHTML = displaySieves.map((sieve, idx) => {
                const isSeparator = sieve.opening === currentSeparator && currentMethod === 'composite';
                return `
                <tr class="${idx % 2 === 0 ? 'bg-gray-50' : 'bg-white'} ${isSeparator ? 'separator-highlight' : ''}">
                    <td class="p-2 text-center border border-gray-300 font-semibold">
                        ${isSeparator ? '<span class="separator-badge">ÙØµÙ„</span>' : ''}${sieve.name}
                    </td>
                    <td class="p-2 text-center border border-gray-300 text-gray-600">${sieve.opening}</td>
                    <td class="p-2 text-center border border-gray-300 bg-green-50 font-bold text-green-700" id="final_ppn_${idx}">â€”</td>
                    <td class="p-2 text-center border border-gray-300" id="final_cumret_${idx}">â€”</td>
                    <td class="p-2 text-center border border-gray-300" id="final_ret_${idx}">â€”</td>
                </tr>
            `}).join('');
        }

        function initializeGradationChart() {
            const ctx = document.getElementById('gradationChart').getContext('2d');
            gradationChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„ØªØ¯Ø±Ø¬ â€” Gradation Curve',
                        data: [],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.3,
                        pointRadius: 6,
                        pointBackgroundColor: '#3b82f6',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'logarithmic',
                            position: 'bottom',
                            title: { display: true, text: 'ÙØªØ­Ø© Ø§Ù„Ù…Ù†Ø®Ù„ (mm) â€” Sieve Opening', font: { size: 14, weight: 'bold' } },
                            min: 0.05,
                            max: 100,
                            ticks: { callback: v => [0.075, 0.1, 0.25, 0.5, 1, 2, 4.75, 10, 19, 25, 50, 75].includes(v) ? v : '' },
                            grid: { color: 'rgba(0,0,0,0.1)' }
                        },
                        y: {
                            title: { display: true, text: 'Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ø§Ù„Ù…Ø§Ø±Ø© (%) â€” Percent Passing', font: { size: 14, weight: 'bold' } },
                            min: 0, max: 100,
                            ticks: { stepSize: 10 },
                            grid: { color: 'rgba(0,0,0,0.1)' }
                        }
                    },
                    plugins: { legend: { display: true, position: 'top' } }
                }
            });
        }

        function onSeparatorChange() {
            const newSeparator = parseFloat(document.getElementById('separatorSieve').value);
            if (newSeparator !== currentSeparator) {
                clearCompositeData();
                currentSeparator = newSeparator;
                initializeCompositeTables();
                updateFinalTable();
                updateSeparatorDisplay();
                results = { coarser: [], finer: [], final: [], CSCF: 0, SMd: 0 };
                gradationChart.data.datasets[0].data = [];
                gradationChart.update();
            }
        }

        function clearCompositeData() {
            document.querySelectorAll('[id^="coarse_cmrn_"], [id^="fine_cmrn_"]').forEach(i => i.value = '');
            ['comp_CPMd', 'comp_FPMm', 'comp_wfp', 'comp_SubSMd', 'comp_FPMd', 'comp_SMd'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.value = '';
            });
            document.getElementById('cscfDisplay').textContent = 'â€”';
            document.querySelectorAll('[id^="coarse_ppn_"], [id^="fine_fppn_"], [id^="fine_ppn_"]').forEach(c => c.textContent = 'â€”');
            document.getElementById('separatorWarning').classList.add('hidden');
        }

        function updateSeparatorDisplay() {
            document.getElementById('selectedSeparatorDisplay').textContent = getSeparatorName();
        }

        function toggleMethod() {
            currentMethod = document.querySelector('input[name="method"]:checked').value;
            document.getElementById('singleSetSection').classList.toggle('hidden', currentMethod !== 'single');
            document.getElementById('compositeSection').classList.toggle('hidden', currentMethod !== 'composite');
            document.getElementById('separatorSelection').classList.toggle('hidden', currentMethod !== 'composite');
            updateFinalTable();
        }

        function updateUnitLabels() {
            const unit = document.getElementById('massUnit').value;
            document.querySelectorAll('.unit-label').forEach(el => el.textContent = unit);
        }

        function convertToGrams(value) {
            const unit = document.getElementById('massUnit').value;
            return unit === 'kg' ? value * 1000 : value;
        }

        function validateInputs() {
            const messages = [];
            let isValid = true;
            document.querySelectorAll('.input-error, .input-warning').forEach(el => el.classList.remove('input-error', 'input-warning'));

            if (currentMethod === 'single') {
                const sMd = parseFloat(document.getElementById('single_SMd').value) || 0;
                if (sMd <= 0) {
                    messages.push({ type: 'error', text: 'ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ ÙƒØªÙ„Ø© Ø§Ù„Ø¹ÙŠÙ†Ø© Ø§Ù„Ø¬Ø§ÙØ© S,Md Ø¨Ù‚ÙŠÙ…Ø© Ù…ÙˆØ¬Ø¨Ø©' });
                    document.getElementById('single_SMd').classList.add('input-error');
                    isValid = false;
                }
            } else {
                const cpMd = parseFloat(document.getElementById('comp_CPMd').value) || 0;
                const fpMm = parseFloat(document.getElementById('comp_FPMm').value) || 0;
                const subsMd = parseFloat(document.getElementById('comp_SubSMd').value) || 0;
                if (cpMd <= 0) { messages.push({ type: 'error', text: 'ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ CP,Md Ø¨Ù‚ÙŠÙ…Ø© Ù…ÙˆØ¬Ø¨Ø©' }); isValid = false; }
                if (fpMm <= 0) { messages.push({ type: 'error', text: 'ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ FP,Mm Ø¨Ù‚ÙŠÙ…Ø© Ù…ÙˆØ¬Ø¨Ø©' }); isValid = false; }
                if (subsMd <= 0) { messages.push({ type: 'error', text: 'ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ SubS,Md Ø¨Ù‚ÙŠÙ…Ø© Ù…ÙˆØ¬Ø¨Ø©' }); isValid = false; }
            }

            document.getElementById('validationMessages').innerHTML = messages.map(m => 
                `<div class="validation-msg ${m.type === 'error' ? 'validation-error' : 'validation-warning'}">
                    ${m.type === 'error' ? 'âŒ' : 'âš ï¸'} ${m.text}</div>`
            ).join('');

            return isValid;
        }

        function calculate() {
            if (!validateInputs()) return;
            currentMethod === 'single' ? calculateSingleSet() : calculateComposite();
            updateGradationChart();
            calculateDValues();
            generateJSON();
            document.getElementById('validationMessages').innerHTML += 
                '<div class="validation-msg validation-success">âœ… ØªÙ… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­</div>';
        }

        function calculateSingleSet() {
            const sMd = convertToGrams(parseFloat(document.getElementById('single_SMd').value) || 0);
            results.SMd = sMd;
            results.singleSet = [];
            results.final = [];
            let prevPPN = 100;

            ALL_SIEVES.forEach((sieve, idx) => {
                const cmrn = convertToGrams(parseFloat(document.getElementById(`single_cmrn_${idx}`).value) || 0);
                let ppn = Math.max(0, Math.min(100, 100 * (1 - cmrn / sMd)));
                const ppnRounded = Math.round(ppn);
                document.getElementById(`single_ppn_${idx}`).textContent = sieve.name === 'Pan' ? 'â€”' : `${ppnRounded}%`;
                results.singleSet.push({ sieve: sieve.name, opening: sieve.opening, cmrn, ppn, ppnRounded });
                if (sieve.name !== 'Pan') {
                    results.final.push({ sieve: sieve.name, opening: sieve.opening, ppn: ppnRounded, cumRetained: 100 - ppnRounded, retained: Math.max(0, prevPPN - ppnRounded) });
                    prevPPN = ppnRounded;
                }
            });
            updateFinalTableValues();
        }

        function calculateComposite() {
            const cpMd = convertToGrams(parseFloat(document.getElementById('comp_CPMd').value) || 0);
            const fpMm = convertToGrams(parseFloat(document.getElementById('comp_FPMm').value) || 0);
            const wfp = parseFloat(document.getElementById('comp_wfp').value) || 0;
            const subsMd = convertToGrams(parseFloat(document.getElementById('comp_SubSMd').value) || 0);
            const fpMd = fpMm / (1 + wfp / 100);
            const sMd = cpMd + fpMd;

            document.getElementById('comp_FPMd').value = fpMd.toFixed(2);
            document.getElementById('comp_SMd').value = sMd.toFixed(2);
            results.SMd = sMd;
            results.coarser = [];
            results.finer = [];
            results.final = [];

            const coarseSieves = getCoarseSieves();
            const fineSieves = getFineSieves();
            let cscf = 0;

            coarseSieves.forEach((sieve, idx) => {
                const cmrn = convertToGrams(parseFloat(document.getElementById(`coarse_cmrn_${idx}`).value) || 0);
                let ppn = Math.max(0, Math.min(100, 100 * (1 - cmrn / sMd)));
                const ppnRounded = Math.round(ppn);
                document.getElementById(`coarse_ppn_${idx}`).textContent = `${ppnRounded}%`;
                results.coarser.push({ sieve: sieve.name, opening: sieve.opening, cmrn, ppn, ppnRounded });
                if (sieve.opening === currentSeparator) cscf = ppn;
            });

            results.CSCF = cscf;
            document.getElementById('cscfDisplay').textContent = `${cscf.toFixed(1)}%`;

            fineSieves.forEach((sieve, idx) => {
                const fcmrn = convertToGrams(parseFloat(document.getElementById(`fine_cmrn_${idx}`).value) || 0);
                let fppn = Math.max(0, Math.min(1, 1 - (fcmrn / subsMd)));
                let ppn = Math.max(0, Math.min(100, cscf * fppn));
                const fppnPercent = fppn * 100;
                const ppnRounded = Math.round(ppn);
                document.getElementById(`fine_fppn_${idx}`).textContent = sieve.name === 'Pan' ? 'â€”' : `${fppnPercent.toFixed(1)}%`;
                document.getElementById(`fine_ppn_${idx}`).textContent = sieve.name === 'Pan' ? 'â€”' : `${ppnRounded}%`;
                results.finer.push({ sieve: sieve.name, opening: sieve.opening, fcmrn, fppn: fppnPercent, ppn, ppnRounded });
            });

            let prevPPN = 100;
            results.coarser.forEach(item => {
                results.final.push({ sieve: item.sieve, opening: item.opening, ppn: item.ppnRounded, cumRetained: 100 - item.ppnRounded, retained: Math.max(0, prevPPN - item.ppnRounded), source: 'coarse' });
                prevPPN = item.ppnRounded;
            });
            results.finer.slice(1).forEach(item => {
                if (item.sieve !== 'Pan') {
                    results.final.push({ sieve: item.sieve, opening: item.opening, ppn: item.ppnRounded, cumRetained: 100 - item.ppnRounded, retained: Math.max(0, prevPPN - item.ppnRounded), source: 'fine' });
                    prevPPN = item.ppnRounded;
                }
            });
            updateFinalTableValues();
        }

        function updateFinalTableValues() {
            const displaySieves = ALL_SIEVES.filter(s => s.name !== 'Pan');
            displaySieves.forEach((sieve, idx) => {
                const finalItem = results.final.find(f => f.opening === sieve.opening);
                if (finalItem) {
                    document.getElementById(`final_ppn_${idx}`).textContent = `${finalItem.ppn}%`;
                    document.getElementById(`final_cumret_${idx}`).textContent = `${finalItem.cumRetained}%`;
                    document.getElementById(`final_ret_${idx}`).textContent = `${finalItem.retained}%`;
                } else {
                    document.getElementById(`final_ppn_${idx}`).textContent = 'â€”';
                    document.getElementById(`final_cumret_${idx}`).textContent = 'â€”';
                    document.getElementById(`final_ret_${idx}`).textContent = 'â€”';
                }
            });
        }

        function updateGradationChart() {
            const data = results.final.filter(item => item.opening > 0).map(item => ({ x: item.opening, y: item.ppn })).sort((a, b) => b.x - a.x);
            gradationChart.data.datasets[0].data = data;
            gradationChart.update();
        }

        function calculateDValues() {
            const data = results.final.filter(item => item.opening > 0).sort((a, b) => a.opening - b.opening);
            if (data.length < 2) return;

            const d10 = interpolateD(data, 10);
            const d30 = interpolateD(data, 30);
            const d60 = interpolateD(data, 60);

            document.getElementById('d10Value').textContent = d10 ? d10.toFixed(3) : 'â€”';
            document.getElementById('d30Value').textContent = d30 ? d30.toFixed(3) : 'â€”';
            document.getElementById('d60Value').textContent = d60 ? d60.toFixed(3) : 'â€”';

            if (d10 && d60) {
                document.getElementById('cuValue').textContent = (d60 / d10).toFixed(2);
                if (d30) document.getElementById('ccValue').textContent = ((d30 * d30) / (d10 * d60)).toFixed(2);
            }
        }

        function interpolateD(data, targetPercent) {
            for (let i = 0; i < data.length - 1; i++) {
                const p1 = data[i], p2 = data[i + 1];
                if ((p1.ppn <= targetPercent && p2.ppn >= targetPercent) || (p1.ppn >= targetPercent && p2.ppn <= targetPercent)) {
                    const logD1 = Math.log10(p1.opening), logD2 = Math.log10(p2.opening);
                    const ratio = (targetPercent - p1.ppn) / (p2.ppn - p1.ppn);
                    return Math.pow(10, logD1 + ratio * (logD2 - logD1));
                }
            }
            return null;
        }

        function generateJSON() {
            const output = {
                testInfo: { standard: "ASTM D6913/D6913M-17", method: currentMethod === 'single' ? 'Single-Set' : 'Composite', separatorSieve: currentMethod === 'composite' ? getSeparatorName() : null, sampleId: document.getElementById('sampleId').value, testDate: document.getElementById('testDate').value },
                results: { gradation: results.final, dValues: { D10: document.getElementById('d10Value').textContent, D30: document.getElementById('d30Value').textContent, D60: document.getElementById('d60Value').textContent }, coefficients: { Cu: document.getElementById('cuValue').textContent, Cc: document.getElementById('ccValue').textContent } }
            };
            console.log('D6913 Results:', output);
        }

        function resetAll() {
            document.querySelectorAll('#sectionD6913 input[type="number"], #sectionD6913 input[type="text"]').forEach(i => { if (i.id !== 'testDate') i.value = ''; i.classList.remove('input-error', 'input-warning'); });
            document.querySelectorAll('[id^="single_ppn_"], [id^="coarse_ppn_"], [id^="fine_fppn_"], [id^="fine_ppn_"], [id^="final_ppn_"], [id^="final_cumret_"], [id^="final_ret_"]').forEach(c => c.textContent = 'â€”');
            document.getElementById('cscfDisplay').textContent = 'â€”';
            ['d10Value', 'd30Value', 'd60Value', 'cuValue', 'ccValue'].forEach(id => document.getElementById(id).textContent = 'â€”');
            gradationChart.data.datasets[0].data = [];
            gradationChart.update();
            document.getElementById('validationMessages').innerHTML = '';
            results = { singleSet: [], coarser: [], finer: [], final: [], CSCF: 0, SMd: 0 };
        }

        function loadDemoData() {
            resetAll();
            if (currentMethod === 'single') {
                document.getElementById('sampleId').value = 'DEMO-SS-001';
                document.getElementById('single_SMd').value = '500';
                [0, 0, 12, 35, 58, 95, 142, 198, 265, 312, 358, 402, 435, 462, 485].forEach((val, idx) => {
                    const input = document.getElementById(`single_cmrn_${idx}`);
                    if (input) input.value = val;
                });
            } else {
                document.getElementById('sampleId').value = 'DEMO-COMP-001';
                document.getElementById('comp_CPMd').value = '850';
                document.getElementById('comp_FPMm').value = '680';
                document.getElementById('comp_wfp').value = '8.5';
                document.getElementById('comp_SubSMd').value = '150';
                [0, 25, 68, 125, 198, 345, 520].forEach((val, idx) => { const i = document.getElementById(`coarse_cmrn_${idx}`); if (i) i.value = val; });
                [2, 18, 42, 68, 92, 112, 128, 140, 148].forEach((val, idx) => { const i = document.getElementById(`fine_cmrn_${idx}`); if (i) i.value = val; });
            }
            document.getElementById('notes').value = 'Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©';
            setTimeout(() => calculate(), 100);
        }

        // =============================================
        // D1557 PROCTOR FUNCTIONS
        // =============================================
        function initializeProctorChart() {
            const ctx = document.getElementById('proctorChart').getContext('2d');
            proctorChart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„Ø¯Ù…Ùƒ â€” Compaction Curve',
                            data: [],
                            borderColor: '#f97316',
                            backgroundColor: 'rgba(249, 115, 22, 0.2)',
                            borderWidth: 3,
                            pointRadius: 8,
                            pointBackgroundColor: '#f97316',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            showLine: true,
                            tension: 0.4
                        },
                        {
                            label: 'Ù…Ù†Ø­Ù†Ù‰ Ù…ØµØ­Ø­ â€” Corrected Curve (D4718)',
                            data: [],
                            borderColor: '#16a34a',
                            backgroundColor: 'rgba(22, 163, 74, 0.2)',
                            borderWidth: 3,
                            pointRadius: 8,
                            pointBackgroundColor: '#16a34a',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            showLine: true,
                            tension: 0.4,
                            hidden: true
                        },
                        {
                            label: 'Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„ØªØ´Ø¨Ø¹ 100% â€” Zero Air Voids',
                            data: [],
                            borderColor: '#ef4444',
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointRadius: 0,
                            showLine: true,
                            fill: false
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: { display: true, text: 'Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ (%) â€” Water Content', font: { size: 14, weight: 'bold' } },
                            grid: { color: 'rgba(0,0,0,0.1)' }
                        },
                        y: {
                            title: { display: true, text: 'Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© (g/cmÂ³) â€” Dry Density', font: { size: 14, weight: 'bold' } },
                            grid: { color: 'rgba(0,0,0,0.1)' }
                        }
                    },
                    plugins: { legend: { display: true, position: 'top' } }
                }
            });
        }

        function getProctorUnitSystem() {
            return document.querySelector('input[name="unitSystem"]:checked').value;
        }

        // =============================================
        // D4718 OVERSIZE CORRECTION FUNCTIONS
        // =============================================
        function toggleOversizeCorrection() {
            const enabled = document.getElementById('enableOversizeCorrection').checked;
            document.getElementById('oversizeCorrectionInputs').classList.toggle('hidden', !enabled);
            
            if (!enabled) {
                // Hide corrected results and curve
                document.getElementById('correctedResultsSection').classList.add('hidden');
                document.getElementById('correctedCurveLegend').style.display = 'none';
                proctorChart.data.datasets[1].hidden = true;
                proctorChart.data.datasets[1].data = [];
                proctorChart.update();
            } else if (proctorResults.points.length > 0) {
                // Recalculate with correction
                calculateProctor();
            }
        }

        function checkOversizeLimit() {
            const pc = parseFloat(document.getElementById('PCpercent').value) || 0;
            const warningEl = document.getElementById('pcLimitWarning');
            const oversizeWarning = document.getElementById('oversizeWarning');
            
            if (pc > 40) {
                warningEl.textContent = 'âŒ Pc ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† â‰¤ 40%';
                document.getElementById('PCpercent').value = 40;
            } else if (pc > 30) {
                warningEl.textContent = 'âš ï¸ Pc > 30% â€” Ø¯Ù‚Ø© Ù…Ø­Ø¯ÙˆØ¯Ø©';
                oversizeWarning.classList.remove('hidden');
            } else if (pc > 5) {
                warningEl.textContent = '';
                oversizeWarning.classList.add('hidden');
            } else {
                warningEl.textContent = 'â„¹ï¸ Pc â‰¤ 5% â€” Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ø®ØªÙŠØ§Ø±ÙŠ';
                oversizeWarning.classList.add('hidden');
            }
        }

        function calculateOversizeCorrection(testMDD_gcm3, testOMC, unitSystem) {
            const pc = parseFloat(document.getElementById('PCpercent').value) || 0;
            const Gm = parseFloat(document.getElementById('Gm_input').value) || 2.65;
            const Ac = parseFloat(document.getElementById('Ac_input').value) || 1.5;
            const rhoW = parseFloat(document.getElementById('rhoW_input').value) || 1.0;
            
            if (pc <= 0) {
                return null;
            }
            
            // Calculate corrected values per D4718
            // Ïc = Gm Ã— Ïw (density of oversize particles in g/cmÂ³)
            const rho_c = Gm * rhoW;
            
            // Corrected dry density (Eq from D4718):
            // 1/Ïd,corr = (Pc/100)/Ïc + (1-Pc/100)/Ïd,test
            const pcFraction = pc / 100;
            const rho_d_corr_gcm3 = 1 / ((pcFraction / rho_c) + ((1 - pcFraction) / testMDD_gcm3));
            
            // Corrected water content:
            // w_corr = w_test Ã— (1 - Pc/100) + Ac Ã— (Pc/100)
            const w_corr = testOMC * (1 - pcFraction) + Ac * pcFraction;
            
            // Convert corrected MDD to display unit
            let mdd_corr_display;
            if (unitSystem === 'g_cm3') {
                mdd_corr_display = rho_d_corr_gcm3;
            } else if (unitSystem === 'kg_m3') {
                mdd_corr_display = rho_d_corr_gcm3 * 1000;
            } else { // kN/mÂ³
                mdd_corr_display = rho_d_corr_gcm3 * 9.8066;
            }
            
            return {
                mdd_corr_gcm3: rho_d_corr_gcm3,
                mdd_corr_display: mdd_corr_display,
                omc_corr: w_corr,
                pc: pc,
                Gm: Gm,
                Ac: Ac
            };
        }

        function calculateCorrectedCurvePoints(originalPoints, unitSystem) {
            const pc = parseFloat(document.getElementById('PCpercent').value) || 0;
            const Gm = parseFloat(document.getElementById('Gm_input').value) || 2.65;
            const Ac = parseFloat(document.getElementById('Ac_input').value) || 1.5;
            const rhoW = parseFloat(document.getElementById('rhoW_input').value) || 1.0;
            
            if (pc <= 0) return [];
            
            const rho_c = Gm * rhoW;
            const pcFraction = pc / 100;
            
            const correctedPoints = [];
            
            originalPoints.forEach(pt => {
                // Corrected water content
                const w_corr = pt.w * (1 - pcFraction) + Ac * pcFraction;
                
                // Corrected dry density
                const rho_d_corr_gcm3 = 1 / ((pcFraction / rho_c) + ((1 - pcFraction) / pt.rho_d_gcm3));
                
                // Convert to display units
                let displayDry;
                if (unitSystem === 'g_cm3') {
                    displayDry = rho_d_corr_gcm3;
                } else if (unitSystem === 'kg_m3') {
                    displayDry = rho_d_corr_gcm3 * 1000;
                } else {
                    displayDry = rho_d_corr_gcm3 * 9.8066;
                }
                
                correctedPoints.push({ x: w_corr, y: displayDry });
            });
            
            return correctedPoints.sort((a, b) => a.x - b.x);
        }

        function updateCorrectedResults(correction, unitSystem) {
            if (!correction) {
                document.getElementById('correctedResultsSection').classList.add('hidden');
                document.getElementById('correctedCurveLegend').style.display = 'none';
                return;
            }
            
            document.getElementById('correctedResultsSection').classList.remove('hidden');
            document.getElementById('correctedCurveLegend').style.display = 'block';
            
            const decimals = unitSystem === 'kg_m3' ? 1 : 3;
            const unitText = unitSystem === 'g_cm3' ? 'g/cmÂ³' : unitSystem === 'kg_m3' ? 'kg/mÂ³' : 'kN/mÂ³';
            
            // Update corrected result cards
            document.getElementById('omcCorrectedResult').textContent = correction.omc_corr.toFixed(1);
            document.getElementById('mddCorrectedResult').textContent = correction.mdd_corr_display.toFixed(decimals);
            document.getElementById('mddCorrectedUnit').textContent = unitText;
            
            // Update comparison table
            const originalOMC = proctorResults.OMC;
            const originalMDD = proctorResults.MDD;
            
            document.getElementById('omcOriginal').textContent = originalOMC.toFixed(1) + '%';
            document.getElementById('omcCorrectedTable').textContent = correction.omc_corr.toFixed(1) + '%';
            document.getElementById('omcDiff').textContent = (correction.omc_corr - originalOMC).toFixed(2) + '%';
            
            document.getElementById('mddOriginal').textContent = originalMDD.toFixed(decimals) + ' ' + unitText;
            document.getElementById('mddCorrectedTable').textContent = correction.mdd_corr_display.toFixed(decimals) + ' ' + unitText;
            document.getElementById('mddDiff').textContent = (correction.mdd_corr_display - originalMDD).toFixed(decimals) + ' ' + unitText;
        }

        function onProctorUnitChange() {
            const unit = getProctorUnitSystem();
            let moistLabel, moistUnit, dryLabel, dryUnit, chartYLabel, mddUnitText;

            if (unit === 'g_cm3') {
                moistLabel = 'Ïm'; moistUnit = 'Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø±Ø·Ø¨Ø© (g/cmÂ³)';
                dryLabel = 'Ïd'; dryUnit = 'Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© (g/cmÂ³)';
                chartYLabel = 'Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© (g/cmÂ³) â€” Dry Density';
                mddUnitText = 'g/cmÂ³';
            } else if (unit === 'kg_m3') {
                moistLabel = 'Ïm'; moistUnit = 'Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø±Ø·Ø¨Ø© (kg/mÂ³)';
                dryLabel = 'Ïd'; dryUnit = 'Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© (kg/mÂ³)';
                chartYLabel = 'Ø§Ù„ÙƒØ«Ø§ÙØ© Ø§Ù„Ø¬Ø§ÙØ© (kg/mÂ³) â€” Dry Density';
                mddUnitText = 'kg/mÂ³';
            } else {
                moistLabel = 'Î³m'; moistUnit = 'ÙˆØ²Ù† Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø±Ø·Ø¨ (kN/mÂ³)';
                dryLabel = 'Î³d'; dryUnit = 'ÙˆØ²Ù† Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¬Ø§Ù (kN/mÂ³)';
                chartYLabel = 'ÙˆØ²Ù† Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø¬Ø§Ù (kN/mÂ³) â€” Dry Unit Weight';
                mddUnitText = 'kN/mÂ³';
            }

            document.getElementById('moistDensityLabel').textContent = moistLabel;
            document.getElementById('moistDensityUnit').textContent = moistUnit;
            document.getElementById('dryDensityLabel').textContent = dryLabel;
            document.getElementById('dryDensityUnit').textContent = dryUnit;
            document.getElementById('mddUnit').textContent = mddUnitText;

            proctorChart.options.scales.y.title.text = chartYLabel;
            proctorChart.update();

            // Recalculate if data exists
            if (proctorResults.points.length > 0) calculateProctor();
        }

        function validateProctorInputs() {
            const messages = [];
            let isValid = true;

            const moldMass = parseFloat(document.getElementById('moldMass_g').value) || 0;
            const moldVol = parseFloat(document.getElementById('moldVol_value').value) || 0;

            if (moldMass <= 0) { messages.push({ type: 'error', text: 'ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ²Ù† Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø¨Ù‚ÙŠÙ…Ø© Ù…ÙˆØ¬Ø¨Ø©' }); isValid = false; }
            if (moldVol <= 0) { messages.push({ type: 'error', text: 'ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø­Ø¬Ù… Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø¨Ù‚ÙŠÙ…Ø© Ù…ÙˆØ¬Ø¨Ø©' }); isValid = false; }

            // Check each point
            for (let i = 1; i <= 5; i++) {
                const wetTare = parseFloat(document.getElementById(`wcWetTare_${i}`).value) || 0;
                const dryTare = parseFloat(document.getElementById(`wcDryTare_${i}`).value) || 0;
                const tare = parseFloat(document.getElementById(`wcTare_${i}`).value) || 0;
                const moldWet = parseFloat(document.getElementById(`moldWet_${i}_g`).value) || 0;

                if (wetTare > 0 && dryTare > 0 && tare > 0) {
                    if (dryTare <= tare) { messages.push({ type: 'error', text: `Ø§Ù„Ù†Ù‚Ø·Ø© ${i}: Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø¬Ø§ÙØ© + Ø§Ù„Ø¹Ù„Ø¨Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† > Ø§Ù„Ø¹Ù„Ø¨Ø©` }); isValid = false; }
                    if (wetTare < dryTare) { messages.push({ type: 'error', text: `Ø§Ù„Ù†Ù‚Ø·Ø© ${i}: Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø±Ø·Ø¨Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† â‰¥ Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø¬Ø§ÙØ©` }); isValid = false; }
                }
                if (moldWet > 0 && moldWet <= moldMass) { messages.push({ type: 'error', text: `Ø§Ù„Ù†Ù‚Ø·Ø© ${i}: Ø§Ù„Ù‚Ø§Ù„Ø¨ + Ø§Ù„ØªØ±Ø¨Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† > ÙƒØªÙ„Ø© Ø§Ù„Ù‚Ø§Ù„Ø¨` }); isValid = false; }
            }

            document.getElementById('proctorValidationMessages').innerHTML = messages.map(m =>
                `<div class="validation-msg ${m.type === 'error' ? 'validation-error' : 'validation-warning'}">
                    ${m.type === 'error' ? 'âŒ' : 'âš ï¸'} ${m.text}</div>`
            ).join('');

            return isValid;
        }

        function calculateProctor() {
            if (!validateProctorInputs()) return;

            const moldMass = parseFloat(document.getElementById('moldMass_g').value) || 0;
            let moldVol = parseFloat(document.getElementById('moldVol_value').value) || 0;
            const volUnit = document.getElementById('moldVol_unit').value;
            const Gs = parseFloat(document.getElementById('Gs_input').value) || 2.65;
            const unitSystem = getProctorUnitSystem();
            const gamma_w = 9.789; // kN/mÂ³ at 20Â°C

            // Convert volume to cmÂ³ for calculations
            let V_cm3 = volUnit === 'm3' ? moldVol * 1e6 : moldVol;

            proctorResults.points = [];
            const chartData = [];
            let maxDryDensity = 0;
            let omcAtMax = 0;

            for (let i = 1; i <= 5; i++) {
                const wetTare = parseFloat(document.getElementById(`wcWetTare_${i}`).value) || 0;
                const dryTare = parseFloat(document.getElementById(`wcDryTare_${i}`).value) || 0;
                const tare = parseFloat(document.getElementById(`wcTare_${i}`).value) || 0;
                const moldWet = parseFloat(document.getElementById(`moldWet_${i}_g`).value) || 0;

                // Skip incomplete points
                if (wetTare === 0 || dryTare === 0 || tare === 0 || moldWet === 0) {
                    document.getElementById(`wcWater_${i}`).textContent = 'â€”';
                    document.getElementById(`wcDrySoil_${i}`).textContent = 'â€”';
                    document.getElementById(`w_${i}`).textContent = 'â€”';
                    document.getElementById(`out_moist_${i}`).textContent = 'â€”';
                    document.getElementById(`out_dry_${i}`).textContent = 'â€”';
                    continue;
                }

                // Water content calculations
                const waterMass = wetTare - dryTare;
                const drySoilMass = dryTare - tare;
                const w = (waterMass / drySoilMass) * 100;

                document.getElementById(`wcWater_${i}`).textContent = waterMass.toFixed(2);
                document.getElementById(`wcDrySoil_${i}`).textContent = drySoilMass.toFixed(2);
                document.getElementById(`w_${i}`).textContent = w.toFixed(1) + '%';

                // Density calculations (Eq 4 & 5)
                // Ïm in g/cmÂ³ = (Mt - Mmd) / V (with V in cmÂ³)
                const rho_m_gcm3 = (moldWet - moldMass) / V_cm3;
                const rho_d_gcm3 = rho_m_gcm3 / (1 + w / 100);

                // Convert to display units
                let displayMoist, displayDry;
                if (unitSystem === 'g_cm3') {
                    displayMoist = rho_m_gcm3;
                    displayDry = rho_d_gcm3;
                } else if (unitSystem === 'kg_m3') {
                    displayMoist = rho_m_gcm3 * 1000;
                    displayDry = rho_d_gcm3 * 1000;
                } else { // kN/mÂ³ (Eq 7)
                    displayMoist = 9.8066 * rho_m_gcm3;
                    displayDry = 9.8066 * rho_d_gcm3;
                }

                document.getElementById(`out_moist_${i}`).textContent = displayMoist.toFixed(unitSystem === 'kg_m3' ? 1 : 3);
                document.getElementById(`out_dry_${i}`).textContent = displayDry.toFixed(unitSystem === 'kg_m3' ? 1 : 3);

                proctorResults.points.push({ point: i, w, rho_m_gcm3, rho_d_gcm3, displayDry });
                chartData.push({ x: w, y: displayDry });

                if (displayDry > maxDryDensity) {
                    maxDryDensity = displayDry;
                    omcAtMax = w;
                }
            }

            proctorResults.OMC = omcAtMax;
            proctorResults.MDD = maxDryDensity;

            // Display results
            document.getElementById('omcResult').textContent = omcAtMax.toFixed(1);
            document.getElementById('mddResult').textContent = maxDryDensity.toFixed(unitSystem === 'kg_m3' ? 1 : 3);

            // Show alternate units for MDD
            let altText = '';
            if (unitSystem === 'g_cm3') {
                altText = `â‰ˆ ${(maxDryDensity * 1000).toFixed(0)} kg/mÂ³ | â‰ˆ ${(maxDryDensity * 9.8066).toFixed(2)} kN/mÂ³`;
            } else if (unitSystem === 'kg_m3') {
                altText = `â‰ˆ ${(maxDryDensity / 1000).toFixed(3)} g/cmÂ³ | â‰ˆ ${(maxDryDensity * 0.0098066).toFixed(2)} kN/mÂ³`;
            } else {
                altText = `â‰ˆ ${(maxDryDensity / 9.8066).toFixed(3)} g/cmÂ³ | â‰ˆ ${(maxDryDensity / 0.0098066).toFixed(0)} kg/mÂ³`;
            }
            document.getElementById('mddAlternate').textContent = altText;

            // Update chart
            proctorChart.data.datasets[0].data = chartData.sort((a, b) => a.x - b.x);

            // =============================================
            // OVERSIZE CORRECTION (D4718)
            // =============================================
            const oversizeEnabled = document.getElementById('enableOversizeCorrection').checked;
            
            if (oversizeEnabled && proctorResults.points.length > 0) {
                // Find the point with maximum dry density for correction calculation
                const maxPoint = proctorResults.points.reduce((max, pt) => 
                    pt.rho_d_gcm3 > max.rho_d_gcm3 ? pt : max, proctorResults.points[0]);
                
                // Calculate corrected OMC and MDD
                const correction = calculateOversizeCorrection(maxPoint.rho_d_gcm3, maxPoint.w, unitSystem);
                
                if (correction) {
                    // Calculate corrected curve points
                    const correctedPoints = calculateCorrectedCurvePoints(proctorResults.points, unitSystem);
                    
                    // Update chart with corrected curve
                    proctorChart.data.datasets[1].data = correctedPoints;
                    proctorChart.data.datasets[1].hidden = false;
                    
                    // Update corrected results display
                    updateCorrectedResults(correction, unitSystem);
                    
                    // Store corrected results
                    proctorResults.corrected = correction;
                    proctorResults.correctedPoints = correctedPoints;
                }
                
                checkOversizeLimit();
            } else {
                // Hide corrected curve
                proctorChart.data.datasets[1].data = [];
                proctorChart.data.datasets[1].hidden = true;
                document.getElementById('correctedResultsSection').classList.add('hidden');
                document.getElementById('correctedCurveLegend').style.display = 'none';
            }

            // Generate Zero Air Voids curve (Eq 8)
            const zavData = [];
            const allYValues = [...chartData.map(d => d.y)];
            if (proctorResults.correctedPoints) {
                allYValues.push(...proctorResults.correctedPoints.map(d => d.y));
            }
            const minY = Math.min(...allYValues) * 0.95;
            const maxY = Math.max(...allYValues) * 1.05;
            
            for (let yVal = maxY; yVal >= minY; yVal -= (maxY - minY) / 20) {
                let gamma_d, wsat;
                if (unitSystem === 'kN_m3') {
                    gamma_d = yVal;
                } else if (unitSystem === 'g_cm3') {
                    gamma_d = yVal * 9.8066;
                } else {
                    gamma_d = yVal * 0.0098066;
                }
                wsat = ((gamma_w * Gs / gamma_d) - 1) * 100;
                if (wsat > 0 && wsat < 50) {
                    zavData.push({ x: wsat, y: yVal });
                }
            }
            proctorChart.data.datasets[2].data = zavData;

            // Check if curve is right of ZAV (error condition)
            let hasError = false;
            chartData.forEach(pt => {
                const zavAtW = zavData.find(z => Math.abs(z.x - pt.x) < 0.5);
                if (zavAtW && pt.y > zavAtW.y) hasError = true;
            });

            if (hasError) {
                document.getElementById('proctorValidationMessages').innerHTML += 
                    '<div class="validation-msg validation-warning">âš ï¸ ØªØ­Ø°ÙŠØ±: Ø¨Ø¹Ø¶ Ø§Ù„Ù†Ù‚Ø§Ø· ØªÙ‚Ø¹ ÙŠÙ…ÙŠÙ† Ù…Ù†Ø­Ù†Ù‰ Ø§Ù„ØªØ´Ø¨Ø¹ 100% â€” ØªØ­Ù‚Ù‚ Ù…Ù† Ù‚ÙŠÙ…Ø© Gs Ø£Ùˆ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª</div>';
            }

            proctorChart.update();

            // Generate JSON
            generateProctorJSON();

            document.getElementById('proctorValidationMessages').innerHTML += 
                '<div class="validation-msg validation-success">âœ… ØªÙ… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­</div>';
        }

        function generateProctorJSON() {
            const unit = getProctorUnitSystem();
            const decimals = unit === 'kg_m3' ? 1 : 3;
            const unitText = unit === 'g_cm3' ? 'g/cmÂ³' : unit === 'kg_m3' ? 'kg/mÂ³' : 'kN/mÂ³';
            const oversizeEnabled = document.getElementById('enableOversizeCorrection').checked;
            const pc = parseFloat(document.getElementById('PCpercent').value) || 0;
            
            const output = {
                testInfo: {
                    standard: "ASTM D1557-12(2021)",
                    method: document.getElementById('proctor_method').value,
                    sampleId: document.getElementById('proctor_sampleId').value,
                    testDate: document.getElementById('proctor_testDate').value,
                    unitSystem: unit
                },
                moldData: {
                    mass_g: parseFloat(document.getElementById('moldMass_g').value) || 0,
                    volume: parseFloat(document.getElementById('moldVol_value').value) || 0,
                    volumeUnit: document.getElementById('moldVol_unit').value,
                    Gs: parseFloat(document.getElementById('Gs_input').value) || 2.65
                },
                points: proctorResults.points,
                testResults: {
                    OMC_percent: parseFloat(proctorResults.OMC.toFixed(1)),
                    MDD: parseFloat(proctorResults.MDD.toFixed(decimals)),
                    MDD_unit: unitText
                },
                oversizeCorrection: {
                    enabled: oversizeEnabled,
                    PC_percent: pc,
                    Gm: parseFloat(document.getElementById('Gm_input').value) || 2.65,
                    Ac_percent: parseFloat(document.getElementById('Ac_input').value) || 1.5,
                    rhoW_gcm3: parseFloat(document.getElementById('rhoW_input').value) || 1.0
                }
            };
            
            // Add corrected results if oversize correction is enabled
            if (oversizeEnabled && proctorResults.corrected) {
                output.correctedResults = {
                    standard: "ASTM D4718/D4718M",
                    OMC_corrected_percent: parseFloat(proctorResults.corrected.omc_corr.toFixed(1)),
                    MDD_corrected: parseFloat(proctorResults.corrected.mdd_corr_display.toFixed(decimals)),
                    MDD_corrected_unit: unitText,
                    correctedPoints: proctorResults.correctedPoints
                };
            }
            
            console.log('D1557 Proctor Results:', output);
        }

        function resetProctor() {
            // Clear inputs
            ['proctor_sampleId', 'proctor_notes', 'moldMass_g', 'moldVol_value'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.value = '';
            });
            document.getElementById('Gs_input').value = '2.65';
            
            // Reset oversize correction inputs
            document.getElementById('PCpercent').value = '0';
            document.getElementById('Gm_input').value = '2.65';
            document.getElementById('Ac_input').value = '1.5';
            document.getElementById('rhoW_input').value = '1.000';
            document.getElementById('enableOversizeCorrection').checked = false;
            document.getElementById('oversizeCorrectionInputs').classList.add('hidden');
            document.getElementById('correctedResultsSection').classList.add('hidden');
            document.getElementById('correctedCurveLegend').style.display = 'none';
            document.getElementById('pcLimitWarning').textContent = '';

            for (let i = 1; i <= 5; i++) {
                ['wcWetTare', 'wcDryTare', 'wcTare', 'moldWet'].forEach(prefix => {
                    const el = document.getElementById(`${prefix}_${i}${prefix === 'moldWet' ? '_g' : ''}`);
                    if (el) el.value = '';
                });
                ['wcWater', 'wcDrySoil', 'w', 'out_moist', 'out_dry'].forEach(prefix => {
                    const el = document.getElementById(`${prefix}_${i}`);
                    if (el) el.textContent = 'â€”';
                });
            }

            // Clear results
            document.getElementById('omcResult').textContent = 'â€”';
            document.getElementById('mddResult').textContent = 'â€”';
            document.getElementById('mddAlternate').textContent = '';
            
            // Clear corrected results
            document.getElementById('omcCorrectedResult').textContent = 'â€”';
            document.getElementById('mddCorrectedResult').textContent = 'â€”';
            document.getElementById('omcOriginal').textContent = 'â€”';
            document.getElementById('omcCorrectedTable').textContent = 'â€”';
            document.getElementById('omcDiff').textContent = 'â€”';
            document.getElementById('mddOriginal').textContent = 'â€”';
            document.getElementById('mddCorrectedTable').textContent = 'â€”';
            document.getElementById('mddDiff').textContent = 'â€”';

            // Clear chart
            proctorChart.data.datasets[0].data = [];
            proctorChart.data.datasets[1].data = [];
            proctorChart.data.datasets[1].hidden = true;
            proctorChart.data.datasets[2].data = [];
            proctorChart.update();

            // Clear messages
            document.getElementById('proctorValidationMessages').innerHTML = '';
            document.getElementById('oversizeWarning').classList.add('hidden');

            proctorResults = { points: [], OMC: 0, MDD: 0, corrected: null, correctedPoints: null };
        }

        function loadProctorDemo() {
            resetProctor();
            document.getElementById('proctor_sampleId').value = 'DEMO-P-001';
            document.getElementById('moldMass_g').value = '4250';
            document.getElementById('moldVol_value').value = '943.3';
            document.getElementById('Gs_input').value = '2.68';

            // Demo data for 5 points
            const demoData = [
                { wetTare: 185.2, dryTare: 175.8, tare: 45.2, moldWet: 6125 },
                { wetTare: 192.5, dryTare: 180.1, tare: 44.8, moldWet: 6285 },
                { wetTare: 198.7, dryTare: 182.3, tare: 45.5, moldWet: 6380 },
                { wetTare: 205.3, dryTare: 183.8, tare: 44.9, moldWet: 6325 },
                { wetTare: 212.8, dryTare: 185.2, tare: 45.1, moldWet: 6210 }
            ];

            demoData.forEach((d, i) => {
                document.getElementById(`wcWetTare_${i+1}`).value = d.wetTare;
                document.getElementById(`wcDryTare_${i+1}`).value = d.dryTare;
                document.getElementById(`wcTare_${i+1}`).value = d.tare;
                document.getElementById(`moldWet_${i+1}_g`).value = d.moldWet;
            });

            // Enable oversize correction with demo values
            document.getElementById('enableOversizeCorrection').checked = true;
            document.getElementById('oversizeCorrectionInputs').classList.remove('hidden');
            document.getElementById('PCpercent').value = '15';
            document.getElementById('Gm_input').value = '2.70';
            document.getElementById('Ac_input').value = '2.0';
            document.getElementById('rhoW_input').value = '1.000';

            document.getElementById('proctor_notes').value = 'Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù…Ø¹ ØªØµØ­ÙŠØ­ Oversize (15%)';
            setTimeout(() => calculateProctor(), 100);
        }

        // Demo without oversize correction
        function loadProctorDemoNoCorrection() {
            resetProctor();
            document.getElementById('proctor_sampleId').value = 'DEMO-P-002';
            document.getElementById('moldMass_g').value = '4250';
            document.getElementById('moldVol_value').value = '943.3';
            document.getElementById('Gs_input').value = '2.68';

            const demoData = [
                { wetTare: 185.2, dryTare: 175.8, tare: 45.2, moldWet: 6125 },
                { wetTare: 192.5, dryTare: 180.1, tare: 44.8, moldWet: 6285 },
                { wetTare: 198.7, dryTare: 182.3, tare: 45.5, moldWet: 6380 },
                { wetTare: 205.3, dryTare: 183.8, tare: 44.9, moldWet: 6325 },
                { wetTare: 212.8, dryTare: 185.2, tare: 45.1, moldWet: 6210 }
            ];

            demoData.forEach((d, i) => {
                document.getElementById(`wcWetTare_${i+1}`).value = d.wetTare;
                document.getElementById(`wcDryTare_${i+1}`).value = d.dryTare;
                document.getElementById(`wcTare_${i+1}`).value = d.tare;
                document.getElementById(`moldWet_${i+1}_g`).value = d.moldWet;
            });

            document.getElementById('proctor_notes').value = 'Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¨Ø¯ÙˆÙ† ØªØµØ­ÙŠØ­';
            setTimeout(() => calculateProctor(), 100);
        }

        // =============================================
        // D4318 ATTERBERG LIMITS FUNCTIONS
        // =============================================
        let d4318Chart = null;
        const LL_ROW_COUNT = 4;
        const PL_ROW_COUNT = 2;

        function initD4318Tables() {
            // Initialize Liquid Limit table
            const llBody = document.getElementById('d4318_llBody');
            llBody.innerHTML = '';
            for (let i = 1; i <= LL_ROW_COUNT; i++) {
                llBody.innerHTML += `
                    <tr class="${i % 2 === 0 ? 'bg-white' : 'bg-gray-50'}">
                        <td class="p-2 border border-gray-300">
                            <input type="number" id="ll_N_${i}" min="15" max="35" step="1" 
                                class="input-field w-full border border-gray-300 rounded px-2 py-1" 
                                placeholder="15-35" onchange="updateLLRow(${i})">
                        </td>
                        <td class="p-2 border border-gray-300">
                            <input type="number" id="ll_tare_${i}" step="0.01" min="0" 
                                class="input-field w-full border border-gray-300 rounded px-2 py-1" 
                                placeholder="0.00" onchange="updateLLRow(${i})">
                        </td>
                        <td class="p-2 border border-gray-300">
                            <input type="number" id="ll_wetTare_${i}" step="0.01" min="0" 
                                class="input-field w-full border border-gray-300 rounded px-2 py-1" 
                                placeholder="0.00" onchange="updateLLRow(${i})">
                        </td>
                        <td class="p-2 border border-gray-300">
                            <input type="number" id="ll_dryTare_${i}" step="0.01" min="0" 
                                class="input-field w-full border border-gray-300 rounded px-2 py-1" 
                                placeholder="0.00" onchange="updateLLRow(${i})">
                        </td>
                        <td class="p-2 border border-gray-300 bg-yellow-50 text-center font-semibold" id="ll_water_${i}">â€”</td>
                        <td class="p-2 border border-gray-300 bg-yellow-50 text-center font-semibold" id="ll_drySoil_${i}">â€”</td>
                        <td class="p-2 border border-gray-300 bg-green-50 text-center font-bold text-green-700" id="ll_w_${i}">â€”</td>
                    </tr>
                `;
            }

            // Initialize Plastic Limit table
            const plBody = document.getElementById('d4318_plBody');
            plBody.innerHTML = '';
            for (let i = 1; i <= PL_ROW_COUNT; i++) {
                plBody.innerHTML += `
                    <tr class="${i % 2 === 0 ? 'bg-white' : 'bg-gray-50'}">
                        <td class="p-2 border border-gray-300 text-center font-semibold">Roll ${i}</td>
                        <td class="p-2 border border-gray-300">
                            <input type="number" id="pl_tare_${i}" step="0.01" min="0" 
                                class="input-field w-full border border-gray-300 rounded px-2 py-1" 
                                placeholder="0.00" onchange="updatePLRow(${i})">
                        </td>
                        <td class="p-2 border border-gray-300">
                            <input type="number" id="pl_wetTare_${i}" step="0.01" min="0" 
                                class="input-field w-full border border-gray-300 rounded px-2 py-1" 
                                placeholder="0.00" onchange="updatePLRow(${i})">
                        </td>
                        <td class="p-2 border border-gray-300">
                            <input type="number" id="pl_dryTare_${i}" step="0.01" min="0" 
                                class="input-field w-full border border-gray-300 rounded px-2 py-1" 
                                placeholder="0.00" onchange="updatePLRow(${i})">
                        </td>
                        <td class="p-2 border border-gray-300 bg-yellow-50 text-center font-semibold" id="pl_water_${i}">â€”</td>
                        <td class="p-2 border border-gray-300 bg-yellow-50 text-center font-semibold" id="pl_drySoil_${i}">â€”</td>
                        <td class="p-2 border border-gray-300 bg-green-50 text-center font-bold text-green-700" id="pl_w_${i}">â€”</td>
                    </tr>
                `;
            }
        }

        function updateLLRow(i) {
            const tare = parseFloat(document.getElementById(`ll_tare_${i}`).value) || 0;
            const wetTare = parseFloat(document.getElementById(`ll_wetTare_${i}`).value) || 0;
            const dryTare = parseFloat(document.getElementById(`ll_dryTare_${i}`).value) || 0;

            const water = wetTare - dryTare;
            const drySoil = dryTare - tare;

            document.getElementById(`ll_water_${i}`).textContent = water > 0 ? water.toFixed(2) : 'â€”';
            document.getElementById(`ll_drySoil_${i}`).textContent = drySoil > 0 ? drySoil.toFixed(2) : 'â€”';

            if (drySoil > 0) {
                const w = (water / drySoil) * 100;
                document.getElementById(`ll_w_${i}`).textContent = w.toFixed(1) + '%';
            } else {
                document.getElementById(`ll_w_${i}`).textContent = 'â€”';
            }
        }

        function updatePLRow(i) {
            const tare = parseFloat(document.getElementById(`pl_tare_${i}`).value) || 0;
            const wetTare = parseFloat(document.getElementById(`pl_wetTare_${i}`).value) || 0;
            const dryTare = parseFloat(document.getElementById(`pl_dryTare_${i}`).value) || 0;

            const water = wetTare - dryTare;
            const drySoil = dryTare - tare;

            document.getElementById(`pl_water_${i}`).textContent = water > 0 ? water.toFixed(2) : 'â€”';
            document.getElementById(`pl_drySoil_${i}`).textContent = drySoil > 0 ? drySoil.toFixed(2) : 'â€”';

            if (drySoil > 0) {
                const w = (water / drySoil) * 100;
                document.getElementById(`pl_w_${i}`).textContent = w.toFixed(1) + '%';
            } else {
                document.getElementById(`pl_w_${i}`).textContent = 'â€”';
            }
        }

        function calculateD4318() {
            const messages = [];
            
            // Collect LL points
            const llPoints = [];
            for (let i = 1; i <= LL_ROW_COUNT; i++) {
                const N = parseFloat(document.getElementById(`ll_N_${i}`).value) || 0;
                const tare = parseFloat(document.getElementById(`ll_tare_${i}`).value) || 0;
                const wetTare = parseFloat(document.getElementById(`ll_wetTare_${i}`).value) || 0;
                const dryTare = parseFloat(document.getElementById(`ll_dryTare_${i}`).value) || 0;

                if (N > 0 && tare > 0 && wetTare > 0 && dryTare > 0) {
                    const water = wetTare - dryTare;
                    const drySoil = dryTare - tare;
                    if (drySoil > 0) {
                        const w = (water / drySoil) * 100;
                        llPoints.push({ N, w, logN: Math.log10(N) });
                    }
                }
            }

            // Check minimum points for LL
            if (llPoints.length < 3) {
                messages.push({ type: 'error', text: `Ø¹Ø¯Ø¯ Ù†Ù‚Ø§Ø· Ø­Ø¯ Ø§Ù„Ø³ÙŠÙˆÙ„Ø© ØºÙŠØ± ÙƒØ§ÙÙ: ${llPoints.length}/3 â€” ÙŠØ¬Ø¨ 3 Ù†Ù‚Ø§Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„` });
                document.getElementById('d4318_validationMessages').innerHTML = messages.map(m => 
                    `<div class="validation-msg validation-error">âŒ ${m.text}</div>`
                ).join('');
                return;
            }

            // Calculate LL using linear regression on log10(N) vs w
            // Method A: LL = w at N = 25
            const n = llPoints.length;
            const sumX = llPoints.reduce((s, p) => s + p.logN, 0);
            const sumY = llPoints.reduce((s, p) => s + p.w, 0);
            const sumXY = llPoints.reduce((s, p) => s + p.logN * p.w, 0);
            const sumX2 = llPoints.reduce((s, p) => s + p.logN * p.logN, 0);

            const xMean = sumX / n;
            const yMean = sumY / n;

            // Slope (m) and intercept (b) for y = mx + b
            const slope = (sumXY - n * xMean * yMean) / (sumX2 - n * xMean * xMean);
            const intercept = yMean - slope * xMean;

            // LL at N = 25
            const log25 = Math.log10(25);
            const LL = slope * log25 + intercept;

            // Collect PL points
            const plValues = [];
            for (let i = 1; i <= PL_ROW_COUNT; i++) {
                const tare = parseFloat(document.getElementById(`pl_tare_${i}`).value) || 0;
                const wetTare = parseFloat(document.getElementById(`pl_wetTare_${i}`).value) || 0;
                const dryTare = parseFloat(document.getElementById(`pl_dryTare_${i}`).value) || 0;

                if (tare > 0 && wetTare > 0 && dryTare > 0) {
                    const water = wetTare - dryTare;
                    const drySoil = dryTare - tare;
                    if (drySoil > 0) {
                        const w = (water / drySoil) * 100;
                        plValues.push(w);
                    }
                }
            }

            if (plValues.length === 0) {
                messages.push({ type: 'error', text: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ§Ù„Ø­Ø© Ù„Ø­Ø¯ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©' });
                document.getElementById('d4318_validationMessages').innerHTML = messages.map(m => 
                    `<div class="validation-msg validation-error">âŒ ${m.text}</div>`
                ).join('');
                return;
            }

            // PL = average of all plastic limit tests
            const PL = plValues.reduce((s, v) => s + v, 0) / plValues.length;

            // PI = LL - PL
            const PI = LL - PL;

            // Display results
            document.getElementById('d4318_LL_val').textContent = LL.toFixed(1);
            document.getElementById('d4318_PL_val').textContent = PL.toFixed(1);
            document.getElementById('d4318_PI_val').textContent = PI.toFixed(1);

            // Soil classification hint
            let classification = '';
            if (PI < 4 || (PI < 0.73 * (LL - 20))) {
                classification = 'ØªØ±Ø¨Ø© ØºÙŠØ± Ù„Ø¯Ù†Ø© Ø£Ùˆ Ø·Ù…ÙŠÙŠØ© (ML/OL) â€” Non-plastic or Silt';
            } else if (LL < 50) {
                classification = 'Ø·ÙŠÙ† Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© (CL) â€” Low Plasticity Clay';
            } else {
                classification = 'Ø·ÙŠÙ† Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© (CH) â€” High Plasticity Clay';
            }
            document.getElementById('d4318_classification').textContent = classification;

            // Show results section
            document.getElementById('d4318_results').classList.remove('hidden');
            document.getElementById('d4318_chartWrap').classList.remove('hidden');

            // Draw chart
            drawD4318Chart(llPoints, LL, slope, intercept);

            // Generate JSON
            generateD4318JSON(llPoints, plValues, LL, PL, PI, slope);

            // Success message
            document.getElementById('d4318_validationMessages').innerHTML = 
                '<div class="validation-msg validation-success">âœ… ØªÙ… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø¬Ø§Ø­ â€” Calculation completed successfully</div>';
        }

        function drawD4318Chart(points, LL, slope, intercept) {
            const ctx = document.getElementById('d4318_chart').getContext('2d');
            
            // Destroy existing chart if any
            if (d4318Chart) {
                d4318Chart.destroy();
            }

            // Prepare data points
            const dataPoints = points.map(p => ({ x: p.N, y: p.w }));

            // Generate best-fit line data
            const minN = Math.min(...points.map(p => p.N), 15);
            const maxN = Math.max(...points.map(p => p.N), 35);
            const lineData = [];
            for (let n = minN; n <= maxN; n += 1) {
                const w = slope * Math.log10(n) + intercept;
                lineData.push({ x: n, y: w });
            }

            // LL point at N=25
            const llPoint = [{ x: 25, y: LL }];

            d4318Chart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: 'Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª â€” Data Points',
                            data: dataPoints,
                            backgroundColor: '#3b82f6',
                            borderColor: '#1d4ed8',
                            pointRadius: 8,
                            pointBorderWidth: 2
                        },
                        {
                            label: 'Ø®Ø· Ø£ÙØ¶Ù„ ØªÙ…Ø«ÙŠÙ„ â€” Best-fit Line',
                            data: lineData,
                            type: 'line',
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 2,
                            pointRadius: 0,
                            fill: false,
                            tension: 0
                        },
                        {
                            label: 'LL @ N=25',
                            data: llPoint,
                            backgroundColor: '#ef4444',
                            borderColor: '#dc2626',
                            pointRadius: 12,
                            pointBorderWidth: 3,
                            pointStyle: 'star'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'logarithmic',
                            position: 'bottom',
                            title: { 
                                display: true, 
                                text: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø¶Ø±Ø¨Ø§Øª (N) â€” Number of Blows', 
                                font: { size: 14, weight: 'bold' } 
                            },
                            min: 10,
                            max: 50,
                            ticks: {
                                callback: function(value) {
                                    if ([10, 15, 20, 25, 30, 35, 40, 50].includes(value)) return value;
                                    return '';
                                }
                            },
                            grid: { color: 'rgba(0,0,0,0.1)' }
                        },
                        y: {
                            title: { 
                                display: true, 
                                text: 'Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø§Ø¦ÙŠ (%) â€” Moisture Content', 
                                font: { size: 14, weight: 'bold' } 
                            },
                            grid: { color: 'rgba(0,0,0,0.1)' }
                        }
                    },
                    plugins: {
                        legend: { display: true, position: 'top' },
                        annotation: {
                            annotations: {
                                line25: {
                                    type: 'line',
                                    xMin: 25,
                                    xMax: 25,
                                    borderColor: 'rgba(239, 68, 68, 0.5)',
                                    borderWidth: 2,
                                    borderDash: [5, 5],
                                    label: {
                                        display: true,
                                        content: 'N = 25',
                                        position: 'start'
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }

        function generateD4318JSON(llPoints, plValues, LL, PL, PI, flowIndex) {
            const output = {
                testInfo: {
                    standard: "ASTM D4318-17e1",
                    method: document.getElementById('d4318_method').value === 'A' ? 'Method A - Multipoint' : 'Method B - One-Point',
                    sampleId: document.getElementById('d4318_sampleId').value,
                    testDate: document.getElementById('d4318_testDate').value
                },
                liquidLimit: {
                    points: llPoints.map(p => ({ N: p.N, w_percent: parseFloat(p.w.toFixed(1)) })),
                    flowIndex: parseFloat(flowIndex.toFixed(3)),
                    LL_percent: parseFloat(LL.toFixed(1))
                },
                plasticLimit: {
                    values_percent: plValues.map(v => parseFloat(v.toFixed(1))),
                    PL_percent: parseFloat(PL.toFixed(1))
                },
                results: {
                    LL: parseFloat(LL.toFixed(1)),
                    PL: parseFloat(PL.toFixed(1)),
                    PI: parseFloat(PI.toFixed(1)),
                    classification: document.getElementById('d4318_classification').textContent
                }
            };
            console.log('D4318 Atterberg Limits Results:', output);
        }

        function resetD4318() {
            // Clear all LL inputs
            for (let i = 1; i <= LL_ROW_COUNT; i++) {
                ['ll_N', 'll_tare', 'll_wetTare', 'll_dryTare'].forEach(prefix => {
                    const el = document.getElementById(`${prefix}_${i}`);
                    if (el) el.value = '';
                });
                ['ll_water', 'll_drySoil', 'll_w'].forEach(prefix => {
                    const el = document.getElementById(`${prefix}_${i}`);
                    if (el) el.textContent = 'â€”';
                });
            }

            // Clear all PL inputs
            for (let i = 1; i <= PL_ROW_COUNT; i++) {
                ['pl_tare', 'pl_wetTare', 'pl_dryTare'].forEach(prefix => {
                    const el = document.getElementById(`${prefix}_${i}`);
                    if (el) el.value = '';
                });
                ['pl_water', 'pl_drySoil', 'pl_w'].forEach(prefix => {
                    const el = document.getElementById(`${prefix}_${i}`);
                    if (el) el.textContent = 'â€”';
                });
            }

            // Clear sample info
            document.getElementById('d4318_sampleId').value = '';

            // Clear results
            document.getElementById('d4318_LL_val').textContent = 'â€”';
            document.getElementById('d4318_PL_val').textContent = 'â€”';
            document.getElementById('d4318_PI_val').textContent = 'â€”';
            document.getElementById('d4318_classification').textContent = 'â€”';

            // Hide results and chart
            document.getElementById('d4318_results').classList.add('hidden');
            document.getElementById('d4318_chartWrap').classList.add('hidden');

            // Destroy chart if exists
            if (d4318Chart) {
                d4318Chart.destroy();
                d4318Chart = null;
            }

            // Clear messages
            document.getElementById('d4318_validationMessages').innerHTML = '';
        }

        function loadD4318Example() {
            resetD4318();
            
            document.getElementById('d4318_sampleId').value = 'DEMO-AL-001';

            // Liquid Limit example data (typical values for clay)
            const llData = [
                { N: 35, tare: 10.52, wetTare: 28.45, dryTare: 22.18 },
                { N: 28, tare: 10.38, wetTare: 27.92, dryTare: 21.35 },
                { N: 22, tare: 10.45, wetTare: 28.12, dryTare: 21.02 },
                { N: 17, tare: 10.61, wetTare: 29.35, dryTare: 21.58 }
            ];

            llData.forEach((d, i) => {
                document.getElementById(`ll_N_${i+1}`).value = d.N;
                document.getElementById(`ll_tare_${i+1}`).value = d.tare;
                document.getElementById(`ll_wetTare_${i+1}`).value = d.wetTare;
                document.getElementById(`ll_dryTare_${i+1}`).value = d.dryTare;
                updateLLRow(i + 1);
            });

            // Plastic Limit example data
            const plData = [
                { tare: 8.25, wetTare: 12.85, dryTare: 11.92 },
                { tare: 8.18, wetTare: 13.02, dryTare: 12.05 }
            ];

            plData.forEach((d, i) => {
                document.getElementById(`pl_tare_${i+1}`).value = d.tare;
                document.getElementById(`pl_wetTare_${i+1}`).value = d.wetTare;
                document.getElementById(`pl_dryTare_${i+1}`).value = d.dryTare;
                updatePLRow(i + 1);
            });

            // Calculate after loading
            setTimeout(() => calculateD4318(), 100);
        }

        // =============================================
        // USCS CLASSIFICATION FUNCTIONS (ASTM D2487)
        // =============================================

        /**
         * Ù‚Ø±Ø§Ø¡Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¯Ø±Ø¬ Ù…Ù† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
         * Read gradation data from DOM
         */
        function getGradationDataFromDOM() {
            // Try to get from results.final if available
            let percentPassingNo4 = null;
            let percentPassingNo200 = null;
            
            // Find No.4 (4.75 mm) and No.200 (0.075 mm) from final results
            if (results && results.final && results.final.length > 0) {
                const no4Item = results.final.find(item => item.opening === 4.75);
                const no200Item = results.final.find(item => item.opening === 0.075);
                
                if (no4Item) percentPassingNo4 = no4Item.ppn;
                if (no200Item) percentPassingNo200 = no200Item.ppn;
            }
            
            // Get Cu and Cc from displayed values
            const cuText = document.getElementById('cuValue').textContent;
            const ccText = document.getElementById('ccValue').textContent;
            
            const Cu = cuText !== 'â€”' ? parseFloat(cuText) : null;
            const Cc = ccText !== 'â€”' ? parseFloat(ccText) : null;
            
            // Get D values
            const d10Text = document.getElementById('d10Value').textContent;
            const d30Text = document.getElementById('d30Value').textContent;
            const d60Text = document.getElementById('d60Value').textContent;
            
            return {
                percentPassingNo4: percentPassingNo4,
                percentPassingNo200: percentPassingNo200,
                Cu: Cu,
                Cc: Cc,
                D10: d10Text !== 'â€”' ? parseFloat(d10Text) : null,
                D30: d30Text !== 'â€”' ? parseFloat(d30Text) : null,
                D60: d60Text !== 'â€”' ? parseFloat(d60Text) : null
            };
        }

        /**
         * Ù‚Ø±Ø§Ø¡Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø¯ÙˆØ¯ Ø£ØªØ±Ø¨Ø±Ø¬ Ù…Ù† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
         * Read Atterberg limits data from DOM
         */
        function getAtterbergDataFromDOM() {
            const llText = document.getElementById('d4318_LL_val').textContent;
            const plText = document.getElementById('d4318_PL_val').textContent;
            const piText = document.getElementById('d4318_PI_val').textContent;
            
            return {
                LL: llText !== 'â€”' ? parseFloat(llText) : null,
                PL: plText !== 'â€”' ? parseFloat(plText) : null,
                PI: piText !== 'â€”' ? parseFloat(piText) : null
            };
        }

        /**
         * Ù‚Ø±Ø§Ø¡Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ù…Ùƒ Ù…Ù† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
         * Read Proctor data from DOM (optional)
         */
        function getProctorDataFromDOM() {
            const omcText = document.getElementById('omcResult').textContent;
            const mddText = document.getElementById('mddResult').textContent;
            const mddUnit = document.getElementById('mddUnit').textContent;
            
            return {
                OMC: omcText !== 'â€”' ? parseFloat(omcText) : null,
                MDD: mddText !== 'â€”' ? parseFloat(mddText) : null,
                MDD_unit: mddUnit
            };
        }

        /**
         * ØªØ­Ø¯ÙŠØ¯ Ù‡Ù„ Ø§Ù„ØªØ±Ø¨Ø© Ø®Ø´Ù†Ø© Ø£Ù… Ù†Ø§Ø¹Ù…Ø©
         * Determine if soil is coarse-grained or fine-grained
         */
        function isCoarseGrained(percentPassingNo200) {
            return percentPassingNo200 < 50;
        }

        /**
         * ØªØ­Ø¯ÙŠØ¯ Ù‡Ù„ Ø§Ù„ØªØ±Ø¨Ø© Ø­ØµÙ‰ Ø£Ù… Ø±Ù…Ù„
         * Determine if coarse soil is gravel or sand
         */
        function isGravel(percentPassingNo4) {
            return percentPassingNo4 < 50;
        }

        /**
         * ØªÙ‚ÙŠÙŠÙ… Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù†Ù‚Ø·Ø© Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù€ A-line
         * Evaluate position relative to A-line
         * A-line: PI = 0.73 Ã— (LL - 20)
         */
        function getALinePosition(LL, PI) {
            const PI_A = 0.73 * (LL - 20);
            const diff = PI - PI_A;
            
            if (Math.abs(diff) <= 2) {
                return { position: 'on', PI_A: PI_A, diff: diff };
            } else if (diff > 0) {
                return { position: 'above', PI_A: PI_A, diff: diff };
            } else {
                return { position: 'below', PI_A: PI_A, diff: diff };
            }
        }

        /**
         * ØªØ­Ø¯ÙŠØ¯ Ù‡Ù„ Ø§Ù„ØªØ¯Ø±Ø¬ Ø¬ÙŠØ¯ Ø£Ù… Ø¶Ø¹ÙŠÙ
         * Determine if gradation is well-graded or poorly-graded
         */
        function isWellGraded(Cu, Cc, isGravelType) {
            if (Cu === null || Cc === null) return null;
            
            const cuThreshold = isGravelType ? 4 : 6;
            const ccInRange = Cc >= 1 && Cc <= 3;
            
            return Cu >= cuThreshold && ccInRange;
        }

        /**
         * ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù†Ø§Ø¹Ù…Ø© (Ø·Ù…ÙŠ Ø£Ù… Ø·ÙŠÙ†)
         * Determine fines type (silt or clay)
         */
        function getFinesType(LL, PI) {
            if (LL === null || PI === null) return 'unknown';
            
            const aLinePos = getALinePosition(LL, PI);
            
            if (aLinePos.position === 'above') {
                return 'clay'; // C
            } else if (aLinePos.position === 'below') {
                return 'silt'; // M
            } else {
                return 'borderline'; // CL-ML type
            }
        }

        /**
         * Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„ØªØµÙ†ÙŠÙ Ø§Ù„ØªØ±Ø¨Ø© Ø·Ø¨Ù‚Ø§Ù‹ Ù„Ù€ ASTM D2487
         * Main function to classify soil per ASTM D2487
         */
        function classifyUSCS() {
            // 1) Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            const gradation = getGradationDataFromDOM();
            const atterberg = getAtterbergDataFromDOM();
            const proctor = getProctorDataFromDOM();
            
            // 2) Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªÙˆÙØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            const errors = [];
            
            if (gradation.percentPassingNo4 === null) {
                errors.push('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ % Ø§Ù„Ù…Ø§Ø± Ù…Ù† Ù…Ù†Ø®Ù„ No.4 â€” ÙŠØ±Ø¬Ù‰ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ¯Ø±Ø¬ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ D6913 Ø£ÙˆÙ„Ø§Ù‹');
            }
            if (gradation.percentPassingNo200 === null) {
                errors.push('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ % Ø§Ù„Ù…Ø§Ø± Ù…Ù† Ù…Ù†Ø®Ù„ No.200 â€” ÙŠØ±Ø¬Ù‰ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ¯Ø±Ø¬ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ D6913 Ø£ÙˆÙ„Ø§Ù‹');
            }
            
            if (errors.length > 0) {
                alert('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:\n\n' + errors.join('\n'));
                return;
            }
            
            // 3) Ø¨Ø¯Ø¡ Ø§Ù„ØªØµÙ†ÙŠÙ
            let symbol = '';
            let description = '';
            let nameAr = '';
            let mainType = '';
            let aLinePosition = 'â€”';
            
            const fines = gradation.percentPassingNo200;
            const passNo4 = gradation.percentPassingNo4;
            const Cu = gradation.Cu;
            const Cc = gradation.Cc;
            const LL = atterberg.LL;
            const PI = atterberg.PI;
            const PL = atterberg.PL;
            
            // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
            if (isCoarseGrained(fines)) {
                // ========================================
                // Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ø®Ø´Ù†Ø© (Coarse-grained) - Ø£Ù‚Ù„ Ù…Ù† 50% Ù…Ø§Ø± Ù…Ù† 200
                // ========================================
                mainType = 'ØªØ±Ø¨Ø© Ø®Ø´Ù†Ø© (Coarse-grained)';
                
                const isGravelType = isGravel(passNo4);
                const prefix = isGravelType ? 'G' : 'S';
                const soilName = isGravelType ? 'Ø­ØµÙ‰' : 'Ø±Ù…Ù„';
                const soilNameEn = isGravelType ? 'Gravel' : 'Sand';
                
                // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªØ¯Ø±Ø¬
                const wellGraded = isWellGraded(Cu, Cc, isGravelType);
                
                if (fines <= 5) {
                    // ========================================
                    // ØªØ±Ø¨Ø© Ù†Ø¸ÙŠÙØ© (Clean) - Fines â‰¤ 5%
                    // ========================================
                    if (wellGraded === true) {
                        symbol = prefix + 'W';
                        description = `Well-graded ${soilNameEn}`;
                        nameAr = `${soilName} Ø¬ÙŠØ¯ Ø§Ù„ØªØ¯Ø±Ø¬`;
                    } else if (wellGraded === false) {
                        symbol = prefix + 'P';
                        description = `Poorly-graded ${soilNameEn}`;
                        nameAr = `${soilName} Ø¶Ø¹ÙŠÙ Ø§Ù„ØªØ¯Ø±Ø¬`;
                    } else {
                        // Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Cu/Cc ÙƒØ§ÙÙŠØ©
                        symbol = prefix + 'P';
                        description = `Poorly-graded ${soilNameEn} (Cu/Cc not available)`;
                        nameAr = `${soilName} Ø¶Ø¹ÙŠÙ Ø§Ù„ØªØ¯Ø±Ø¬ (Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Cu/Cc)`;
                    }
                    
                } else if (fines >= 12) {
                    // ========================================
                    // ØªØ±Ø¨Ø© Ø¨Ù…ÙˆØ§Ø¯ Ù†Ø§Ø¹Ù…Ø© ÙƒØ«ÙŠØ±Ø© - Fines â‰¥ 12%
                    // ========================================
                    if (LL !== null && PI !== null) {
                        const finesType = getFinesType(LL, PI);
                        const aLine = getALinePosition(LL, PI);
                        
                        if (finesType === 'clay' || aLine.position === 'above') {
                            symbol = prefix + 'C';
                            description = `Clayey ${soilNameEn}`;
                            nameAr = `${soilName} Ø·ÙŠÙ†ÙŠ`;
                            aLinePosition = 'ÙÙˆÙ‚ Ø®Ø· A (Above A-line)';
                        } else if (finesType === 'silt' || aLine.position === 'below') {
                            symbol = prefix + 'M';
                            description = `Silty ${soilNameEn}`;
                            nameAr = `${soilName} Ø·Ù…ÙŠÙŠ`;
                            aLinePosition = 'ØªØ­Øª Ø®Ø· A (Below A-line)';
                        } else {
                            symbol = prefix + 'M';
                            description = `Silty ${soilNameEn} (borderline)`;
                            nameAr = `${soilName} Ø·Ù…ÙŠÙŠ (Ù…Ù†Ø·Ù‚Ø© Ø­Ø¯ÙŠØ©)`;
                            aLinePosition = 'Ø¹Ù„Ù‰ Ø®Ø· A (On A-line)';
                        }
                    } else {
                        // Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Atterberg
                        symbol = prefix + 'M/' + prefix + 'C';
                        description = `${soilNameEn} with fines (Atterberg limits needed)`;
                        nameAr = `${soilName} Ø¨Ù†Ø§Ø¹Ù… (ÙŠÙ„Ø²Ù… Ø­Ø¯ÙˆØ¯ Ø£ØªØ±Ø¨Ø±Ø¬)`;
                    }
                    
                } else {
                    // ========================================
                    // Ù…Ù†Ø·Ù‚Ø© Ø§Ù†ØªÙ‚Ø§Ù„ÙŠØ© - 5% < Fines < 12%
                    // ========================================
                    let gradeSuffix = '';
                    let finesSuffix = '';
                    
                    // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªØ¯Ø±Ø¬
                    if (wellGraded === true) {
                        gradeSuffix = 'W';
                    } else {
                        gradeSuffix = 'P';
                    }
                    
                    // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ù†Ø§Ø¹Ù…
                    if (LL !== null && PI !== null) {
                        const finesType = getFinesType(LL, PI);
                        const aLine = getALinePosition(LL, PI);
                        
                        if (finesType === 'clay' || aLine.position === 'above') {
                            finesSuffix = 'C';
                            aLinePosition = 'ÙÙˆÙ‚ Ø®Ø· A (Above A-line)';
                        } else {
                            finesSuffix = 'M';
                            aLinePosition = 'ØªØ­Øª Ø®Ø· A (Below A-line)';
                        }
                    } else {
                        finesSuffix = 'M'; // Ø§ÙØªØ±Ø§Ø¶ÙŠ
                    }
                    
                    symbol = prefix + gradeSuffix + '-' + prefix + finesSuffix;
                    
                    const gradeText = gradeSuffix === 'W' ? 'Well-graded' : 'Poorly-graded';
                    const finesText = finesSuffix === 'C' ? 'clayey' : 'silty';
                    const gradeTextAr = gradeSuffix === 'W' ? 'Ø¬ÙŠØ¯ Ø§Ù„ØªØ¯Ø±Ø¬' : 'Ø¶Ø¹ÙŠÙ Ø§Ù„ØªØ¯Ø±Ø¬';
                    const finesTextAr = finesSuffix === 'C' ? 'Ø·ÙŠÙ†ÙŠ' : 'Ø·Ù…ÙŠÙŠ';
                    
                    description = `${gradeText} ${soilNameEn} with ${finesText} fines`;
                    nameAr = `${soilName} ${gradeTextAr} Ù…Ø¹ Ù†Ø§Ø¹Ù… ${finesTextAr === 'Ø·ÙŠÙ†ÙŠ' ? 'Ø·ÙŠÙ†ÙŠØ©' : 'Ø·Ù…ÙŠÙŠØ©'}`;
                }
                
            } else {
                // ========================================
                // Ø§Ù„ØªØ±Ø¨Ø© Ø§Ù„Ù†Ø§Ø¹Ù…Ø© (Fine-grained) - 50% Ø£Ùˆ Ø£ÙƒØ«Ø± Ù…Ø§Ø± Ù…Ù† 200
                // ========================================
                mainType = 'ØªØ±Ø¨Ø© Ù†Ø§Ø¹Ù…Ø© (Fine-grained)';
                
                if (LL === null || PI === null) {
                    alert('âŒ Ø®Ø·Ø£: Ø§Ù„ØªØ±Ø¨Ø© Ù†Ø§Ø¹Ù…Ø© ÙˆØªØªØ·Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø¯ÙˆØ¯ Ø£ØªØ±Ø¨Ø±Ø¬ (LL, PI)\nÙŠØ±Ø¬Ù‰ Ø­Ø³Ø§Ø¨ Ø­Ø¯ÙˆØ¯ Ø£ØªØ±Ø¨Ø±Ø¬ ÙÙŠ ØªØ¨ÙˆÙŠØ¨ D4318 Ø£ÙˆÙ„Ø§Ù‹');
                    return;
                }
                
                const aLine = getALinePosition(LL, PI);
                const plasticity = LL < 50 ? 'L' : 'H';
                const plasticityText = LL < 50 ? 'Low plasticity' : 'High plasticity';
                const plasticityTextAr = LL < 50 ? 'Ù…Ù†Ø®ÙØ¶ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©' : 'Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©';
                
                // ØªØ­Ø¯ÙŠØ¯ Ù‡Ù„ Ø·ÙŠÙ† Ø£Ù… Ø·Ù…ÙŠ
                if (aLine.position === 'above') {
                    // ÙÙˆÙ‚ Ø®Ø· A â†’ Ø·ÙŠÙ† (Clay)
                    symbol = 'C' + plasticity;
                    description = `${plasticityText} Clay`;
                    nameAr = `Ø·ÙŠÙ† ${plasticityTextAr}`;
                    aLinePosition = 'ÙÙˆÙ‚ Ø®Ø· A (Above A-line)';
                    
                } else if (aLine.position === 'below') {
                    // ØªØ­Øª Ø®Ø· A â†’ Ø·Ù…ÙŠ (Silt)
                    symbol = 'M' + plasticity;
                    description = `${plasticityText} Silt`;
                    nameAr = `Ø·Ù…ÙŠ ${plasticityTextAr}`;
                    aLinePosition = 'ØªØ­Øª Ø®Ø· A (Below A-line)';
                    
                } else {
                    // Ø¹Ù„Ù‰ Ø®Ø· A (Ù…Ù†Ø·Ù‚Ø© Ø§Ù†ØªÙ‚Ø§Ù„ÙŠØ©)
                    if (LL < 50) {
                        symbol = 'CL-ML';
                        description = 'Silty Clay (borderline)';
                        nameAr = 'Ø·ÙŠÙ† Ø·Ù…ÙŠÙŠ (Ù…Ù†Ø·Ù‚Ø© Ø­Ø¯ÙŠØ©)';
                    } else {
                        symbol = 'CH'; // Ø¹Ø§Ø¯Ø© ÙŠÙØµÙ†Ù ÙƒØ·ÙŠÙ† Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©
                        description = 'High plasticity Clay (near A-line)';
                        nameAr = 'Ø·ÙŠÙ† Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù„Ø¯ÙˆÙ†Ø© (Ù‚Ø±Ø¨ Ø®Ø· A)';
                    }
                    aLinePosition = 'Ø¹Ù„Ù‰ Ø®Ø· A (On A-line)';
                }
            }
            
            // 4) Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            document.getElementById('uscsSection').classList.remove('hidden');
            document.getElementById('uscs_symbol').textContent = symbol;
            document.getElementById('uscs_description').textContent = description;
            document.getElementById('uscs_name_ar').textContent = nameAr;
            
            document.getElementById('uscs_mainType').textContent = mainType;
            document.getElementById('uscs_finesPercent').textContent = fines.toFixed(1) + '%';
            document.getElementById('uscs_aLinePosition').textContent = aLinePosition;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
            document.getElementById('uscs_passNo4').textContent = passNo4 !== null ? passNo4.toFixed(1) + '%' : 'â€”';
            document.getElementById('uscs_passNo200').textContent = fines.toFixed(1) + '%';
            document.getElementById('uscs_Cu').textContent = Cu !== null ? Cu.toFixed(2) : 'â€”';
            document.getElementById('uscs_Cc').textContent = Cc !== null ? Cc.toFixed(2) : 'â€”';
            document.getElementById('uscs_LL').textContent = LL !== null ? LL.toFixed(1) + '%' : 'â€”';
            document.getElementById('uscs_PL').textContent = PL !== null ? PL.toFixed(1) + '%' : 'â€”';
            document.getElementById('uscs_PI').textContent = PI !== null ? PI.toFixed(1) + '%' : 'â€”';
            
            // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ù…Ùƒ Ø¥Ù† ÙˆÙØ¬Ø¯Øª
            if (proctor.OMC !== null && proctor.MDD !== null) {
                document.getElementById('uscs_proctorData').classList.remove('hidden');
                document.getElementById('uscs_OMC').textContent = proctor.OMC.toFixed(1);
                document.getElementById('uscs_MDD').textContent = proctor.MDD.toFixed(3);
                document.getElementById('uscs_MDD_unit').textContent = proctor.MDD_unit;
            } else {
                document.getElementById('uscs_proctorData').classList.add('hidden');
            }
            
            // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ù‚Ø³Ù… Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            document.getElementById('uscsSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø®Ø±Ø¬Ø§Øª JSON Ù„Ù„ØªØµÙ†ÙŠÙ
            const uscsOutput = {
                classification: {
                    symbol: symbol,
                    description: description,
                    nameArabic: nameAr,
                    mainType: mainType
                },
                inputData: {
                    gradation: {
                        percentPassingNo4: passNo4,
                        percentPassingNo200: fines,
                        Cu: Cu,
                        Cc: Cc
                    },
                    atterberg: {
                        LL: LL,
                        PL: PL,
                        PI: PI
                    },
                    proctor: proctor.OMC !== null ? {
                        OMC: proctor.OMC,
                        MDD: proctor.MDD,
                        MDD_unit: proctor.MDD_unit
                    } : null
                },
                aLineAnalysis: LL !== null && PI !== null ? {
                    PI_A: (0.73 * (LL - 20)).toFixed(2),
                    position: aLinePosition
                } : null,
                standard: 'ASTM D2487'
            };
            
            console.log('USCS Classification Result:', uscsOutput);
        }

        // =============================================
        // SOIL CLASSIFICATION TAB FUNCTIONS (USCS + AASHTO)
        // =============================================

        /**
         * Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ÙØªØ­ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªØµÙ†ÙŠÙ
         * Auto-read data when switching to classification tab
         */
        function autoReadDataForClassification() {
            const gradation = getGradationDataFromDOM();
            const atterberg = getAtterbergDataFromDOM();
            const proctor = getProctorDataFromDOM();

            // Update display cards
            document.getElementById('sc_fines').textContent = gradation.percentPassingNo200 !== null ? 
                gradation.percentPassingNo200.toFixed(1) + '%' : 'â€”';
            document.getElementById('sc_LL').textContent = atterberg.LL !== null ? 
                atterberg.LL.toFixed(1) + '%' : 'â€”';
            document.getElementById('sc_PL').textContent = atterberg.PL !== null ? 
                atterberg.PL.toFixed(1) + '%' : 'â€”';
            document.getElementById('sc_PI').textContent = atterberg.PI !== null ? 
                atterberg.PI.toFixed(1) + '%' : 'â€”';
            document.getElementById('sc_passNo4').textContent = gradation.percentPassingNo4 !== null ? 
                gradation.percentPassingNo4.toFixed(1) + '%' : 'â€”';
            
            // Get additional sieve data
            let passNo10 = null, passNo40 = null;
            if (results && results.final && results.final.length > 0) {
                const no10Item = results.final.find(item => item.opening === 2.0);
                const no40Item = results.final.find(item => item.opening === 0.425);
                if (no10Item) passNo10 = no10Item.ppn;
                if (no40Item) passNo40 = no40Item.ppn;
            }
            document.getElementById('sc_passNo10').textContent = passNo10 !== null ? passNo10.toFixed(1) + '%' : 'â€”';
            document.getElementById('sc_passNo40').textContent = passNo40 !== null ? passNo40.toFixed(1) + '%' : 'â€”';
            
            document.getElementById('sc_CuCc').textContent = 
                (gradation.Cu !== null && gradation.Cc !== null) ? 
                `${gradation.Cu.toFixed(2)} / ${gradation.Cc.toFixed(2)}` : 'â€”';
        }

        /**
         * Ø­Ø³Ø§Ø¨ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© (Group Index) Ø·Ø¨Ù‚Ø§Ù‹ Ù„Ù€ AASHTO
         * Calculate Group Index per AASHTO M 145 / D3282
         * GI = (F-35)[0.2 + 0.005(LL-40)] + 0.01(F-15)(PI-10)
         */
        function calculateGroupIndex(F, LL, PI) {
            // F = % passing No.200
            // Partial GI for A-2-6 and A-2-7: GI = 0.01(F-15)(PI-10)
            
            let term1 = (F - 35) * (0.2 + 0.005 * (LL - 40));
            let term2 = 0.01 * (F - 15) * (PI - 10);
            
            // Clamp negative values to 0
            if (term1 < 0) term1 = 0;
            if (term2 < 0) term2 = 0;
            
            let GI = term1 + term2;
            
            // GI should be rounded to nearest whole number and minimum 0
            GI = Math.max(0, Math.round(GI));
            
            return GI;
        }

        /**
         * ØªØµÙ†ÙŠÙ Ø§Ù„ØªØ±Ø¨Ø© Ø·Ø¨Ù‚Ø§Ù‹ Ù„Ù†Ø¸Ø§Ù… AASHTO
         * Classify soil per AASHTO M 145 / ASTM D3282
         */
        function classifyAASHTO(passNo10, passNo40, passNo200, LL, PI) {
            const F = passNo200; // Fines percentage
            
            // ========================================
            // Ù…ÙˆØ§Ø¯ Ø­Ø¨ÙŠØ¨ÙŠØ© â€” Granular Materials (â‰¤35% passing No.200)
            // ========================================
            if (F <= 35) {
                // A-1 Group
                if (F <= 15 && passNo40 !== null && passNo40 <= 30 && PI <= 6) {
                    if (passNo10 !== null && passNo10 <= 50) {
                        return { group: 'A-1-a', subgroup: 'A-1', desc: 'Stone fragments, gravel, and sand', descAr: 'Ø´Ø¸Ø§ÙŠØ§ Ø­Ø¬Ø±ÙŠØ© ÙˆØ­ØµÙ‰ ÙˆØ±Ù…Ù„', gi: 0 };
                    }
                }
                if (F <= 25 && passNo40 !== null && passNo40 <= 50 && PI <= 6) {
                    return { group: 'A-1-b', subgroup: 'A-1', desc: 'Stone fragments, gravel, and sand', descAr: 'Ø´Ø¸Ø§ÙŠØ§ Ø­Ø¬Ø±ÙŠØ© ÙˆØ­ØµÙ‰ ÙˆØ±Ù…Ù„', gi: 0 };
                }
                
                // A-3 Group (Fine sand)
                if (F <= 10 && passNo40 !== null && passNo40 > 50 && (PI === null || PI === 0 || isNaN(PI))) {
                    return { group: 'A-3', subgroup: 'A-3', desc: 'Fine sand', descAr: 'Ø±Ù…Ù„ Ù†Ø§Ø¹Ù…', gi: 0 };
                }
                
                // A-2 Group
                if (F <= 35) {
                    let gi = calculateGroupIndex(F, LL || 0, PI || 0);
                    // For A-2-6 and A-2-7, use partial GI
                    let partialGI = Math.max(0, Math.round(0.01 * (F - 15) * ((PI || 0) - 10)));
                    
                    if (LL !== null && PI !== null) {
                        if (LL <= 40 && PI <= 10) {
                            return { group: 'A-2-4', subgroup: 'A-2', desc: 'Silty or clayey gravel and sand', descAr: 'Ø­ØµÙ‰ ÙˆØ±Ù…Ù„ Ø·Ù…ÙŠÙŠ Ø£Ùˆ Ø·ÙŠÙ†ÙŠ', gi: 0 };
                        } else if (LL > 40 && PI <= 10) {
                            return { group: 'A-2-5', subgroup: 'A-2', desc: 'Silty or clayey gravel and sand', descAr: 'Ø­ØµÙ‰ ÙˆØ±Ù…Ù„ Ø·Ù…ÙŠÙŠ Ø£Ùˆ Ø·ÙŠÙ†ÙŠ', gi: 0 };
                        } else if (LL <= 40 && PI > 10) {
                            return { group: 'A-2-6', subgroup: 'A-2', desc: 'Silty or clayey gravel and sand', descAr: 'Ø­ØµÙ‰ ÙˆØ±Ù…Ù„ Ø·Ù…ÙŠÙŠ Ø£Ùˆ Ø·ÙŠÙ†ÙŠ', gi: partialGI };
                        } else if (LL > 40 && PI > 10) {
                            return { group: 'A-2-7', subgroup: 'A-2', desc: 'Silty or clayey gravel and sand', descAr: 'Ø­ØµÙ‰ ÙˆØ±Ù…Ù„ Ø·Ù…ÙŠÙŠ Ø£Ùˆ Ø·ÙŠÙ†ÙŠ', gi: partialGI };
                        }
                    }
                    // Default A-2-4 if no LL/PI
                    return { group: 'A-2-4', subgroup: 'A-2', desc: 'Silty or clayey gravel and sand', descAr: 'Ø­ØµÙ‰ ÙˆØ±Ù…Ù„ Ø·Ù…ÙŠÙŠ Ø£Ùˆ Ø·ÙŠÙ†ÙŠ', gi: 0 };
                }
            }
            
            // ========================================
            // Ù…ÙˆØ§Ø¯ Ø·Ù…ÙŠ-Ø·ÙŠÙ† â€” Silt-Clay Materials (>35% passing No.200)
            // ========================================
            if (F > 35) {
                let gi = calculateGroupIndex(F, LL || 0, PI || 0);
                
                if (LL !== null && PI !== null) {
                    if (LL <= 40 && PI <= 10) {
                        return { group: 'A-4', subgroup: 'A-4', desc: 'Silty soils', descAr: 'ØªØ±Ø¨Ø© Ø·Ù…ÙŠÙŠØ©', gi: gi };
                    } else if (LL > 40 && PI <= 10) {
                        return { group: 'A-5', subgroup: 'A-5', desc: 'Silty soils', descAr: 'ØªØ±Ø¨Ø© Ø·Ù…ÙŠÙŠØ©', gi: gi };
                    } else if (LL <= 40 && PI > 10) {
                        return { group: 'A-6', subgroup: 'A-6', desc: 'Clayey soils', descAr: 'ØªØ±Ø¨Ø© Ø·ÙŠÙ†ÙŠØ©', gi: gi };
                    } else if (LL > 40 && PI > 10) {
                        // A-7: distinguish A-7-5 vs A-7-6
                        if (PI <= (LL - 30)) {
                            return { group: 'A-7-5', subgroup: 'A-7', desc: 'Clayey soils (elastic)', descAr: 'ØªØ±Ø¨Ø© Ø·ÙŠÙ†ÙŠØ© Ù…Ø±Ù†Ø©', gi: gi };
                        } else {
                            return { group: 'A-7-6', subgroup: 'A-7', desc: 'Clayey soils (high volume change)', descAr: 'ØªØ±Ø¨Ø© Ø·ÙŠÙ†ÙŠØ© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø§Ù†ØªÙØ§Ø´', gi: gi };
                        }
                    }
                }
                // Default A-4 if no LL/PI
                return { group: 'A-4', subgroup: 'A-4', desc: 'Silty soils', descAr: 'ØªØ±Ø¨Ø© Ø·Ù…ÙŠÙŠØ©', gi: gi };
            }
            
            return { group: 'Unknown', subgroup: 'Unknown', desc: 'Cannot classify', descAr: 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØµÙ†ÙŠÙ', gi: 0 };
        }

        /**
         * ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªØ±Ø¨Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©
         * Evaluate soil based on Group Index
         */
        function evaluateSoilByGI(gi, aashtoGroup) {
            if (aashtoGroup.startsWith('A-1') || aashtoGroup === 'A-3') {
                return { eval: 'Excellent to Good', evalAr: 'Ù…Ù…ØªØ§Ø² Ø¥Ù„Ù‰ Ø¬ÙŠØ¯', desc: 'Ù…ÙˆØ§Ø¯ Ù…Ù…ØªØ§Ø²Ø© Ù„Ù„Ø£Ø³Ø§Ø³Ø§Øª ÙˆØ§Ù„Ù‚ÙˆØ§Ø¹Ø¯' };
            }
            if (aashtoGroup.startsWith('A-2')) {
                if (gi <= 4) {
                    return { eval: 'Good', evalAr: 'Ø¬ÙŠØ¯', desc: 'Ù…ÙˆØ§Ø¯ Ø¬ÙŠØ¯Ø© Ù„Ù„Ø£Ø³Ø§Ø³Ø§Øª' };
                } else {
                    return { eval: 'Fair', evalAr: 'Ù…Ù‚Ø¨ÙˆÙ„', desc: 'Ù…ÙˆØ§Ø¯ Ù…Ù‚Ø¨ÙˆÙ„Ø© Ù„Ù„Ø£Ø³Ø§Ø³Ø§Øª' };
                }
            }
            
            // For A-4 to A-7
            if (gi === 0) {
                return { eval: 'Fair to Poor', evalAr: 'Ù…Ù‚Ø¨ÙˆÙ„ Ø¥Ù„Ù‰ Ø¶Ø¹ÙŠÙ', desc: 'GI = 0: Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰' };
            } else if (gi <= 4) {
                return { eval: 'Fair', evalAr: 'Ù…Ù‚Ø¨ÙˆÙ„', desc: 'ØªØ±Ø¨Ø© Ù…Ù‚Ø¨ÙˆÙ„Ø© Ù„Ù„Ø±Ø¯Ù…' };
            } else if (gi <= 9) {
                return { eval: 'Poor', evalAr: 'Ø¶Ø¹ÙŠÙ', desc: 'ØªØ±Ø¨Ø© Ø¶Ø¹ÙŠÙØ© Ù„Ù„Ø£Ø³Ø§Ø³Ø§Øª' };
            } else if (gi <= 20) {
                return { eval: 'Very Poor', evalAr: 'Ø¶Ø¹ÙŠÙ Ø¬Ø¯Ø§Ù‹', desc: 'ØªØ±Ø¨Ø© ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ù„Ø£Ø³Ø§Ø³Ø§Øª' };
            } else {
                return { eval: 'Unsuitable', evalAr: 'ØºÙŠØ± Ù…Ù†Ø§Ø³Ø¨Ø©', desc: 'ØªØ±Ø¨Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø© Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¥Ù†Ø´Ø§Ø¦ÙŠ' };
            }
        }

        /**
         * Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ
         * Main function to calculate soil classification
         */
        function calculateSoilClassification() {
            const gradation = getGradationDataFromDOM();
            const atterberg = getAtterbergDataFromDOM();
            const proctor = getProctorDataFromDOM();
            const aashtoRef = document.querySelector('input[name="aashtoRef"]:checked').value;
            
            const messages = [];
            
            // Validate required data
            if (gradation.percentPassingNo200 === null) {
                messages.push('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ¯Ø±Ø¬ â€” Ø§Ø­Ø³Ø¨ D6913 Ø£ÙˆÙ„Ø§Ù‹ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ % Passing No.200');
            }
            if (gradation.percentPassingNo4 === null) {
                messages.push('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ % Passing No.4 â€” Ø§Ø­Ø³Ø¨ D6913 Ø£ÙˆÙ„Ø§Ù‹');
            }
            
            if (messages.length > 0) {
                document.getElementById('soilClassValidation').innerHTML = messages.map(m => 
                    `<div class="validation-msg validation-warning">${m}</div>`
                ).join('');
                document.getElementById('soilClassResults').classList.add('hidden');
                return;
            }
            
            // Get additional sieve data for AASHTO
            let passNo10 = null, passNo40 = null;
            if (results && results.final && results.final.length > 0) {
                const no10Item = results.final.find(item => item.opening === 2.0);
                const no40Item = results.final.find(item => item.opening === 0.425);
                if (no10Item) passNo10 = no10Item.ppn;
                if (no40Item) passNo40 = no40Item.ppn;
            }
            
            const fines = gradation.percentPassingNo200;
            const passNo4 = gradation.percentPassingNo4;
            const Cu = gradation.Cu;
            const Cc = gradation.Cc;
            const LL = atterberg.LL;
            const PL = atterberg.PL;
            let PI = atterberg.PI;
            
            // Calculate PI if not available but LL and PL are
            if (PI === null && LL !== null && PL !== null) {
                PI = LL - PL;
            }
            
            // ========================================
            // USCS Classification (ASTM D2487)
            // ========================================
            let uscsSymbol = '', uscsDesc = '', uscsNameAr = '', uscsType = '', uscsALine = '', uscsNotes = '';
            
            if (isCoarseGrained(fines)) {
                uscsType = 'ØªØ±Ø¨Ø© Ø®Ø´Ù†Ø© (Coarse-grained)';
                const isGravelType = isGravel(passNo4);
                const prefix = isGravelType ? 'G' : 'S';
                const soilName = isGravelType ? 'Ø­ØµÙ‰' : 'Ø±Ù…Ù„';
                const soilNameEn = isGravelType ? 'Gravel' : 'Sand';
                const wellGraded = isWellGraded(Cu, Cc, isGravelType);
                
                if (fines <= 5) {
                    if (wellGraded === true) {
                        uscsSymbol = prefix + 'W';
                        uscsDesc = `Well-graded ${soilNameEn}`;
                        uscsNameAr = `${soilName} Ø¬ÙŠØ¯ Ø§Ù„ØªØ¯Ø±Ø¬`;
                    } else {
                        uscsSymbol = prefix + 'P';
                        uscsDesc = `Poorly-graded ${soilNameEn}`;
                        uscsNameAr = `${soilName} Ø¶Ø¹ÙŠÙ Ø§Ù„ØªØ¯Ø±Ø¬`;
                    }
                    uscsNotes = 'Clean (Fines â‰¤ 5%)';
                } else if (fines >= 12) {
                    if (LL !== null && PI !== null) {
                        const aLine = getALinePosition(LL, PI);
                        if (aLine.position === 'above') {
                            uscsSymbol = prefix + 'C';
                            uscsDesc = `Clayey ${soilNameEn}`;
                            uscsNameAr = `${soilName} Ø·ÙŠÙ†ÙŠ`;
                            uscsALine = 'ÙÙˆÙ‚ A-Line';
                        } else {
                            uscsSymbol = prefix + 'M';
                            uscsDesc = `Silty ${soilNameEn}`;
                            uscsNameAr = `${soilName} Ø·Ù…ÙŠÙŠ`;
                            uscsALine = 'ØªØ­Øª A-Line';
                        }
                    } else {
                        uscsSymbol = prefix + 'M/' + prefix + 'C';
                        uscsDesc = `${soilNameEn} with fines`;
                        uscsNameAr = `${soilName} Ø¨ØºØ±Ø§Ù…Ø§Øª`;
                        uscsNotes = 'ÙŠÙ„Ø²Ù… Ø­Ø¯ÙˆØ¯ Ø£ØªØ±Ø¨Ø±Ø¬ Ù„Ù„ØªØ­Ø¯ÙŠØ¯';
                    }
                } else {
                    // 5% < Fines < 12%: Dual symbol
                    const gradeSuffix = wellGraded === true ? 'W' : 'P';
                    let finesSuffix = 'M';
                    if (LL !== null && PI !== null) {
                        const aLine = getALinePosition(LL, PI);
                        finesSuffix = aLine.position === 'above' ? 'C' : 'M';
                        uscsALine = aLine.position === 'above' ? 'ÙÙˆÙ‚ A-Line' : 'ØªØ­Øª A-Line';
                    }
                    uscsSymbol = `${prefix}${gradeSuffix}-${prefix}${finesSuffix}`;
                    uscsDesc = `${gradeSuffix === 'W' ? 'Well' : 'Poorly'}-graded ${soilNameEn} with ${finesSuffix === 'C' ? 'clay' : 'silt'}`;
                    uscsNameAr = `${soilName} ${gradeSuffix === 'W' ? 'Ø¬ÙŠØ¯' : 'Ø¶Ø¹ÙŠÙ'} Ø§Ù„ØªØ¯Ø±Ø¬ Ù…Ø¹ ${finesSuffix === 'C' ? 'Ø·ÙŠÙ†' : 'Ø·Ù…ÙŠ'}`;
                    uscsNotes = 'Borderline (5% < Fines < 12%)';
                }
            } else {
                uscsType = 'ØªØ±Ø¨Ø© Ù†Ø§Ø¹Ù…Ø© (Fine-grained)';
                if (LL !== null && PI !== null) {
                    const aLine = getALinePosition(LL, PI);
                    const plasticity = LL < 50 ? 'L' : 'H';
                    
                    if (aLine.position === 'above') {
                        uscsSymbol = 'C' + plasticity;
                        uscsDesc = `${LL < 50 ? 'Low' : 'High'} plasticity Clay`;
                        uscsNameAr = `Ø·ÙŠÙ† ${LL < 50 ? 'Ù…Ù†Ø®ÙØ¶' : 'Ø¹Ø§Ù„ÙŠ'} Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©`;
                        uscsALine = 'ÙÙˆÙ‚ A-Line';
                    } else if (aLine.position === 'below') {
                        uscsSymbol = 'M' + plasticity;
                        uscsDesc = `${LL < 50 ? 'Low' : 'High'} plasticity Silt`;
                        uscsNameAr = `Ø·Ù…ÙŠ ${LL < 50 ? 'Ù…Ù†Ø®ÙØ¶' : 'Ø¹Ø§Ù„ÙŠ'} Ø§Ù„Ù„Ø¯ÙˆÙ†Ø©`;
                        uscsALine = 'ØªØ­Øª A-Line';
                    } else {
                        uscsSymbol = 'CL-ML';
                        uscsDesc = 'Silty Clay (borderline)';
                        uscsNameAr = 'Ø·ÙŠÙ† Ø·Ù…ÙŠÙŠ (Ø­Ø¯ÙŠ)';
                        uscsALine = 'Ø¹Ù„Ù‰ A-Line';
                        uscsNotes = 'Borderline zone';
                    }
                } else {
                    uscsSymbol = 'ML/CL';
                    uscsDesc = 'Fine-grained soil';
                    uscsNameAr = 'ØªØ±Ø¨Ø© Ù†Ø§Ø¹Ù…Ø©';
                    uscsNotes = 'ÙŠÙ„Ø²Ù… Ø­Ø¯ÙˆØ¯ Ø£ØªØ±Ø¨Ø±Ø¬ Ù„Ù„ØªØ­Ø¯ÙŠØ¯';
                }
            }
            
            // ========================================
            // AASHTO Classification
            // ========================================
            const aashtoResult = classifyAASHTO(passNo10, passNo40, fines, LL, PI);
            const soilEval = evaluateSoilByGI(aashtoResult.gi, aashtoResult.group);
            
            // ========================================
            // Display Results
            // ========================================
            document.getElementById('soilClassResults').classList.remove('hidden');
            
            // USCS Results
            document.getElementById('sc_uscs_symbol').textContent = uscsSymbol;
            document.getElementById('sc_uscs_desc').textContent = uscsDesc;
            document.getElementById('sc_uscs_name_ar').textContent = uscsNameAr;
            document.getElementById('sc_uscs_type').textContent = uscsType;
            document.getElementById('sc_uscs_aline').textContent = uscsALine || 'â€”';
            document.getElementById('sc_uscs_notes').textContent = uscsNotes || 'â€”';
            
            // AASHTO Results
            document.getElementById('aashtoRefDisplay').textContent = aashtoRef === 'M145' ? 'AASHTO M 145' : 'ASTM D3282';
            document.getElementById('sc_aashto_group').textContent = aashtoResult.group;
            document.getElementById('sc_aashto_desc').textContent = `${aashtoResult.desc} â€” ${aashtoResult.descAr}`;
            document.getElementById('sc_aashto_gi').textContent = aashtoResult.gi;
            document.getElementById('sc_aashto_eval').textContent = `${soilEval.evalAr} (${soilEval.eval})`;
            document.getElementById('sc_aashto_eval_desc').textContent = soilEval.desc;
            
            // Proctor Data (if available)
            if (proctor.OMC !== null && proctor.MDD !== null) {
                document.getElementById('sc_proctorData').classList.remove('hidden');
                document.getElementById('sc_OMC').textContent = proctor.OMC.toFixed(1);
                document.getElementById('sc_MDD').textContent = proctor.MDD.toFixed(3);
                document.getElementById('sc_MDD_unit').textContent = proctor.MDD_unit;
            } else {
                document.getElementById('sc_proctorData').classList.add('hidden');
            }
            
            // Validation message
            document.getElementById('soilClassValidation').innerHTML = 
                '<div class="validation-msg validation-success">âœ… ØªÙ… Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ Ø¨Ù†Ø¬Ø§Ø­ â€” Classification completed successfully</div>';
            
            // Console output
            console.log('Soil Classification Results:', {
                USCS: { symbol: uscsSymbol, description: uscsDesc, type: uscsType, standard: 'ASTM D2487' },
                AASHTO: { group: aashtoResult.group, GI: aashtoResult.gi, evaluation: soilEval.eval, standard: aashtoRef === 'M145' ? 'AASHTO M 145' : 'ASTM D3282' },
                inputData: { fines, passNo4, passNo10, passNo40, LL, PL, PI, Cu, Cc }
            });
        }

        /**
         * Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªØµÙ†ÙŠÙ
         * Reset Soil Classification tab
         */
        function resetSoilClassification() {
            // Reset display cards
            ['sc_fines', 'sc_LL', 'sc_PL', 'sc_PI', 'sc_passNo4', 'sc_passNo10', 'sc_passNo40', 'sc_CuCc'].forEach(id => {
                document.getElementById(id).textContent = 'â€”';
            });
            
            // Reset results
            ['sc_uscs_symbol', 'sc_uscs_desc', 'sc_uscs_name_ar', 'sc_uscs_type', 'sc_uscs_aline', 'sc_uscs_notes',
             'sc_aashto_group', 'sc_aashto_desc', 'sc_aashto_gi', 'sc_aashto_eval', 'sc_aashto_eval_desc'].forEach(id => {
                document.getElementById(id).textContent = 'â€”';
            });
            
            // Hide results
            document.getElementById('soilClassResults').classList.add('hidden');
            document.getElementById('sc_proctorData').classList.add('hidden');
            document.getElementById('soilClassValidation').innerHTML = '';
        }

    </script>
</body>
</html>
